var ChemDoodle=function(){var a={iChemLabs:{},informatics:{},io:{},lib:{},structures:{}};return a.structures.d2={},a.structures.d3={},a.getVersion=function(){return"6.0.1"},a}();!function(a,b,c){function d(a){var b=a.length,c=db.type(a);return db.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===c||"function"!==c&&(0===b||"number"==typeof b&&b>0&&b-1 in a)}function e(a,b,d,e){if(db.acceptData(a)){var f=db.expando,g=a.nodeType,h=g?db.cache:a,i=g?a[f]:a[f]&&f;if(i&&h[i]&&(e||h[i].data)||d!==c||"string"!=typeof b)return i||(i=g?a[f]=X.pop()||db.guid++:f),h[i]||(h[i]=g?{}:{toJSON:db.noop}),("object"==typeof b||"function"==typeof b)&&(e?h[i]=db.extend(h[i],b):h[i].data=db.extend(h[i].data,b)),a=h[i],e||(a.data||(a.data={}),a=a.data),d!==c&&(a[db.camelCase(b)]=d),"string"==typeof b?(d=a[b],null==d&&(d=a[db.camelCase(b)])):d=a,d}}function f(a,b,c){if(db.acceptData(a)){var d,e,f=a.nodeType,g=f?db.cache:a,i=f?a[db.expando]:db.expando;if(g[i]){if(b&&(d=c?g[i]:g[i].data)){db.isArray(b)?b=b.concat(db.map(b,db.camelCase)):b in d?b=[b]:(b=db.camelCase(b),b=b in d?[b]:b.split(" "));for(e=b.length;e--;)delete d[b[e]];if(c?!h(d):!db.isEmptyObject(d))return}if(!c&&(delete g[i].data,!h(g[i])))return;f?db.cleanData([a],!0):db.support.deleteExpando||g!=g.window?delete g[i]:g[i]=null}}}function g(a,b,d){if(d===c&&1===a.nodeType)if(d="data-"+b.replace(Yc,"-$1").toLowerCase(),d=a.getAttribute(d),"string"==typeof d){try{d="true"===d?!0:"false"===d?!1:"null"===d?null:+d+""===d?+d:Xc.test(d)?db.parseJSON(d):d}catch(e){}db.data(a,b,d)}else d=c;return d}function h(a){for(var b in a)if(("data"!==b||!db.isEmptyObject(a[b]))&&"toJSON"!==b)return!1;return!0}function i(){return!0}function j(){return!1}function k(){try{return S.activeElement}catch(a){}}function l(a,b){do a=a[b];while(a&&1!==a.nodeType);return a}function m(a,b,c){if(db.isFunction(b))return db.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return db.grep(a,function(a){return a===b!==c});if("string"==typeof b){if(ld.test(b))return db.filter(b,a,c);b=db.filter(b,a)}return db.grep(a,function(a){return 0<=db.inArray(a,b)!==c})}function n(a){var b=pd.split("|");if(a=a.createDocumentFragment(),a.createElement)for(;b.length;)a.createElement(b.pop());return a}function o(a,b){return db.nodeName(a,"table")&&db.nodeName(1===b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function p(a){return a.type=(null!==db.find.attr(a,"type"))+"/"+a.type,a}function q(a){var b=Bd.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function r(a,b){for(var c,d=0;null!=(c=a[d]);d++)db._data(c,"globalEval",!b||db._data(b[d],"globalEval"))}function s(a,b){var c,d,e,f,g;if(1===b.nodeType&&db.hasData(a)){if(d=db._data(a),f=db._data(b,d),g=d.events,g)for(c in delete f.handle,f.events={},g)for(d=0,e=g[c].length;e>d;d++)db.event.add(b,c,g[c][d]);f.data&&(f.data=db.extend({},f.data))}}function t(a,b){var d,e,f=0,g=typeof a.getElementsByTagName!==Q?a.getElementsByTagName(b||"*"):typeof a.querySelectorAll!==Q?a.querySelectorAll(b||"*"):c;if(!g)for(g=[],d=a.childNodes||a;null!=(e=d[f]);f++)!b||db.nodeName(e,b)?g.push(e):db.merge(g,t(e,b));return b===c||b&&db.nodeName(a,b)?db.merge([a],g):g}function u(a){yd.test(a.type)&&(a.defaultChecked=a.checked)}function v(a,b){if(b in a)return b;for(var c=b.charAt(0).toUpperCase()+b.slice(1),d=b,e=Ud.length;e--;)if(b=Ud[e]+c,b in a)return b;return d}function w(a,b){return a=b||a,"none"===db.css(a,"display")||!db.contains(a.ownerDocument,a)}function x(a,b){for(var c,d,e,f=[],g=0,h=a.length;h>g;g++)d=a[g],d.style&&(f[g]=db._data(d,"olddisplay"),c=d.style.display,b?(!f[g]&&"none"===c&&(d.style.display=""),""===d.style.display&&w(d)&&(f[g]=db._data(d,"olddisplay",B(d.nodeName)))):!f[g]&&(e=w(d),c&&"none"!==c||!e)&&db._data(d,"olddisplay",e?c:db.css(d,"display")));for(g=0;h>g;g++)d=a[g],!d.style||b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none");return a}function y(a,b,c){return(a=Nd.exec(b))?Math.max(0,a[1]-(c||0))+(a[2]||"px"):b}function z(a,b,c,d,e){b=c===(d?"border":"content")?4:"width"===b?1:0;for(var f=0;4>b;b+=2)"margin"===c&&(f+=db.css(a,c+Td[b],!0,e)),d?("content"===c&&(f-=db.css(a,"padding"+Td[b],!0,e)),"margin"!==c&&(f-=db.css(a,"border"+Td[b]+"Width",!0,e))):(f+=db.css(a,"padding"+Td[b],!0,e),"padding"!==c&&(f+=db.css(a,"border"+Td[b]+"Width",!0,e)));return f}function A(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=Gd(a),g=db.support.boxSizing&&"border-box"===db.css(a,"boxSizing",!1,f);if(0>=e||null==e){if(e=Hd(a,b,f),(0>e||null==e)&&(e=a.style[b]),Od.test(e))return e;d=g&&(db.support.boxSizingReliable||e===a.style[b]),e=parseFloat(e)||0}return e+z(a,b,c||(g?"border":"content"),d,f)+"px"}function B(a){var b=S,c=Qd[a];return c||(c=C(a,b),"none"!==c&&c||(Fd=(Fd||db("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(b.documentElement),b=(Fd[0].contentWindow||Fd[0].contentDocument).document,b.write("<!doctype html><html><body>"),b.close(),c=C(a,b),Fd.detach()),Qd[a]=c),c}function C(a,b){var c=db(b.createElement(a)).appendTo(b.body),d=db.css(c[0],"display");return c.remove(),d}function D(a,b,c,d){var e;if(db.isArray(b))db.each(b,function(b,e){c||Wd.test(a)?d(a,e):D(a+"["+("object"==typeof e?b:"")+"]",e,c,d)});else if(c||"object"!==db.type(b))d(a,b);else for(e in b)D(a+"["+e+"]",b[e],c,d)}function E(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(fb)||[];if(db.isFunction(c))for(;d=f[e++];)"+"===d[0]?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function F(a,b,c,d){function e(h){var i;return f[h]=!0,db.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||g||f[j]?g?!(i=j):void 0:(b.dataTypes.unshift(j),e(j),!1)}),i}var f={},g=a===ke;return e(b.dataTypes[0])||!f["*"]&&e("*")}function G(a,b){var d,e,f=db.ajaxSettings.flatOptions||{};for(e in b)b[e]!==c&&((f[e]?a:d||(d={}))[e]=b[e]);return d&&db.extend(!0,a,d),a}function H(){try{return new a.XMLHttpRequest}catch(b){}}function I(){return setTimeout(function(){te=c}),te=db.now()}function J(a,b,c){for(var d,e=(ze[b]||[]).concat(ze["*"]),f=0,g=e.length;g>f;f++)if(d=e[f].call(c,b,a))return d}function K(a,b,c){var d,e,k,l,m,n,f=0,g=ye.length,h=db.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=te||I(),b=Math.max(0,j.startTime+j.duration-b),c=1-(b/j.duration||0),d=0,f=j.tweens.length;f>d;d++)j.tweens[d].run(c);return h.notifyWith(a,[j,c,b]),1>c&&f?b:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:db.extend({},b),opts:db.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:te||I(),duration:c.duration,tweens:[],createTween:function(b,c){var d=db.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;d>c;c++)j.tweens[c].run(1);return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this}});b=j.props,c=j.opts.specialEasing;for(d in b)if(k=db.camelCase(d),l=c[k],m=b[d],db.isArray(m)&&(l=m[1],m=b[d]=m[0]),d!==k&&(b[k]=m,delete b[d]),(n=db.cssHooks[k])&&"expand"in n)for(d in m=n.expand(m),delete b[k],m)d in b||(b[d]=m[d],c[d]=l);else c[k]=l;for(;g>f;f++)if(d=ye[f].call(j,a,b,j.opts))return d;return db.map(b,J,j),db.isFunction(j.opts.start)&&j.opts.start.call(a,j),db.fx.timer(db.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}function L(a,b,c,d,e){return new L.prototype.init(a,b,c,d,e)}function M(a,b){var c,d={height:a},e=0;for(b=b?1:0;4>e;e+=2-b)c=Td[e],d["margin"+c]=d["padding"+c]=a;return b&&(d.opacity=d.width=a),d}function N(a){return db.isWindow(a)?a:9===a.nodeType?a.defaultView||a.parentWindow:!1}var O,P,Kb,Lb,Mb,Nb,Ob,Pb,Qb,Rb,Sb,Tb,Ub,Vb,Wb,Xb,Yb,Zb,$b,sb,tb,ub,vb,wb,xb,yb,zb,Ab,Bb,Cb,Db,Eb,Fb,Gb,Hb,Ib,Jb,_b,ac,bc,cc,dc,ec,fc,gc,hc,ic,jc,kc,lc,mc,nc,oc,pc,qc,rc,sc,tc,uc,vc,wc,xc,yc,zc,Ac,Bc,Cc,Dc,Ec,Fc,Gc,Hc,Jc,Kc,Mc,Nc,Oc,Pc,Qc,Rc,Sc,Tc,Uc,Lc,Vc,Xc,Yc,Zc,$c,_c,ad,bd,cd,dd,ed,fd,gd,hd,id,jd,kd,ld,md,nd,od,pd,qd,rd,sd,td,ud,vd,wd,xd,yd,zd,Ad,Bd,Cd,Dd,Ed,Fd,Gd,Hd,Id,Jd,Kd,Ld,Md,Nd,Od,Pd,Qd,Rd,Sd,Td,Ud,Vd,Wd,Xd,Yd,Zd,$d,_d,ae,be,ce,de,ee,fe,ge,he,ie,je,ke,le,ne,oe,pe,qe,re,se,te,ue,ve,we,xe,ye,ze,Q=typeof c,R=a.location,S=a.document,T=S.documentElement,U=a.jQuery,V=a.$,W={},X=[],Y=X.concat,Z=X.push,$=X.slice,_=X.indexOf,ab=W.toString,bb=W.hasOwnProperty,cb="1.10.2".trim,db=function(a,b){return new db.fn.init(a,b,P)},eb=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,fb=/\S+/g,gb=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,hb=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,ib=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,jb=/^[\],:{}\s]*$/,kb=/(?:^|:|,)(?:\s*\[)+/g,lb=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,mb=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,nb=/^-ms-/,ob=/-([\da-z])/gi,pb=function(a,b){return b.toUpperCase()},qb=function(a){(S.addEventListener||"load"===a.type||"complete"===S.readyState)&&(rb(),db.ready())},rb=function(){S.addEventListener?(S.removeEventListener("DOMContentLoaded",qb,!1),a.removeEventListener("load",qb,!1)):(S.detachEvent("onreadystatechange",qb),a.detachEvent("onload",qb))};db.fn=db.prototype={jquery:"1.10.2",constructor:db,init:function(a,b,d){var e;if(!a)return this;if("string"==typeof a){if((e="<"===a.charAt(0)&&">"===a.charAt(a.length-1)&&3<=a.length?[null,a,null]:hb.exec(a))&&(e[1]||!b)){if(e[1]){if(b=b instanceof db?b[0]:b,db.merge(this,db.parseHTML(e[1],b&&b.nodeType?b.ownerDocument||b:S,!0)),ib.test(e[1])&&db.isPlainObject(b))for(e in b)db.isFunction(this[e])?this[e](b[e]):this.attr(e,b[e])}else{if((b=S.getElementById(e[2]))&&b.parentNode){if(b.id!==e[2])return d.find(a);this.length=1,this[0]=b}this.context=S,this.selector=a}return this}return!b||b.jquery?(b||d).find(a):this.constructor(b).find(a)}return a.nodeType?(this.context=this[0]=a,this.length=1,this):db.isFunction(a)?d.ready(a):(a.selector!==c&&(this.selector=a.selector,this.context=a.context),db.makeArray(a,this))},selector:"",length:0,toArray:function(){return $.call(this)},get:function(a){return null==a?this.toArray():0>a?this[this.length+a]:this[a]},pushStack:function(a){return a=db.merge(this.constructor(),a),a.prevObject=this,a.context=this.context,a},each:function(a,b){return db.each(this,a,b)},ready:function(a){return db.ready.promise().done(a),this},slice:function(){return this.pushStack($.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length;return a=+a+(0>a?b:0),this.pushStack(a>=0&&b>a?[this[a]]:[])},map:function(a){return this.pushStack(db.map(this,function(b,c){return a.call(b,c,b)}))},end:function(){return this.prevObject||this.constructor(null)},push:Z,sort:[].sort,splice:[].splice},db.fn.init.prototype=db.fn,db.extend=db.fn.extend=function(){var a,b,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[1]||{},h=2),"object"!=typeof g&&!db.isFunction(g)&&(g={}),i===h&&(g=this,--h);i>h;h++)if(null!=(f=arguments[h]))for(e in f)a=g[e],d=f[e],g!==d&&(j&&d&&(db.isPlainObject(d)||(b=db.isArray(d)))?(b?(b=!1,a=a&&db.isArray(a)?a:[]):a=a&&db.isPlainObject(a)?a:{},g[e]=db.extend(j,a,d)):d!==c&&(g[e]=d));return g},db.extend({expando:"jQuery"+("1.10.2"+Math.random()).replace(/\D/g,""),noConflict:function(b){return a.$===db&&(a.$=V),b&&a.jQuery===db&&(a.jQuery=U),db},isReady:!1,readyWait:1,holdReady:function(a){a?db.readyWait++:db.ready(!0)},ready:function(a){if(!(!0===a?--db.readyWait:db.isReady)){if(!S.body)return setTimeout(db.ready);db.isReady=!0,!0!==a&&0<--db.readyWait||(O.resolveWith(S,[db]),db.fn.trigger&&db(S).trigger("ready").off("ready"))}},isFunction:function(a){return"function"===db.type(a)},isArray:Array.isArray||function(a){return"array"===db.type(a)},isWindow:function(a){return null!=a&&a==a.window},isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},type:function(a){return null==a?String(a):"object"==typeof a||"function"==typeof a?W[ab.call(a)]||"object":typeof a},isPlainObject:function(a){var b;if(!a||"object"!==db.type(a)||a.nodeType||db.isWindow(a))return!1;try{if(a.constructor&&!bb.call(a,"constructor")&&!bb.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(d){return!1}if(db.support.ownLast)for(b in a)return bb.call(a,b);for(b in a);return b===c||bb.call(a,b)},isEmptyObject:function(a){for(var b in a)return!1;return!0},error:function(a){throw Error(a)},parseHTML:function(a,b,c){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(c=b,b=!1),b=b||S;var d=ib.exec(a);return c=!c&&[],d?[b.createElement(d[1])]:(d=db.buildFragment([a],b,c),c&&db(c).remove(),db.merge([],d.childNodes))},parseJSON:function(b){return a.JSON&&a.JSON.parse?a.JSON.parse(b):null===b?b:"string"==typeof b&&(b=db.trim(b))&&jb.test(b.replace(lb,"@").replace(mb,"]").replace(kb,""))?new Function("return "+b)():(db.error("Invalid JSON: "+b),void 0)},parseXML:function(b){var d,e;if(!b||"string"!=typeof b)return null;try{a.DOMParser?(e=new DOMParser,d=e.parseFromString(b,"text/xml")):(d=new ActiveXObject("Microsoft.XMLDOM"),d.async="false",d.loadXML(b))}catch(f){d=c}return(!d||!d.documentElement||d.getElementsByTagName("parsererror").length)&&db.error("Invalid XML: "+b),d},noop:function(){},globalEval:function(b){b&&db.trim(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(nb,"ms-").replace(ob,pb)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b,c){var e,f=0,g=a.length;if(e=d(a),c){if(e)for(;g>f&&(e=b.apply(a[f],c),!(!1===e));f++);else for(f in a)if(e=b.apply(a[f],c),!1===e)break}else if(e)for(;g>f&&(e=b.call(a[f],f,a[f]),!(!1===e));f++);else for(f in a)if(e=b.call(a[f],f,a[f]),!1===e)break;return a},trim:cb&&!cb.call("??")?function(a){return null==a?"":cb.call(a)}:function(a){return null==a?"":(a+"").replace(gb,"")},makeArray:function(a,b){var c=b||[];return null!=a&&(d(Object(a))?db.merge(c,"string"==typeof a?[a]:a):Z.call(c,a)),c},inArray:function(a,b,c){var d;if(b){if(_)return _.call(b,a,c);for(d=b.length,c=c?0>c?Math.max(0,d+c):c:0;d>c;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,b){var d=b.length,e=a.length,f=0;if("number"==typeof d)for(;d>f;f++)a[e++]=b[f];else for(;b[f]!==c;)a[e++]=b[f++];return a.length=e,a},grep:function(a,b,c){var d,e=[],f=0,g=a.length;for(c=!!c;g>f;f++)d=!!b(a[f],f),c!==d&&e.push(a[f]);return e},map:function(a,b,c){var e,f=0,g=a.length,h=[];if(d(a))for(;g>f;f++)e=b(a[f],f,c),null!=e&&(h[h.length]=e);else for(f in a)e=b(a[f],f,c),null!=e&&(h[h.length]=e);return Y.apply([],h)},guid:1,proxy:function(a,b){var d,e;return"string"==typeof b&&(e=a[b],b=a,a=e),db.isFunction(a)?(d=$.call(arguments,2),e=function(){return a.apply(b||this,d.concat($.call(arguments)))},e.guid=a.guid=a.guid||db.guid++,e):c},access:function(a,b,d,e,f,g,h){var i=0,j=a.length,k=null==d;if("object"===db.type(d))for(i in f=!0,d)db.access(a,b,i,d[i],!0,g,h);else if(e!==c&&(f=!0,db.isFunction(e)||(h=!0),k&&(h?(b.call(a,e),b=null):(k=b,b=function(a,b,c){return k.call(db(a),c)})),b))for(;j>i;i++)b(a[i],d,h?e:e.call(a[i],i,b(a[i],d)));return f?a:k?b.call(a):j?b(a[0],d):g},now:function(){return(new Date).getTime()},swap:function(a,b,c,d){var e,f={};for(e in b)f[e]=a.style[e],a.style[e]=b[e];c=c.apply(a,d||[]);for(e in b)a.style[e]=f[e];return c}}),db.ready.promise=function(b){if(!O)if(O=db.Deferred(),"complete"===S.readyState)setTimeout(db.ready);else if(S.addEventListener)S.addEventListener("DOMContentLoaded",qb,!1),a.addEventListener("load",qb,!1);else{S.attachEvent("onreadystatechange",qb),a.attachEvent("onload",qb);var c=!1;try{c=null==a.frameElement&&S.documentElement}catch(d){}c&&c.doScroll&&function e(){if(!db.isReady){try{c.doScroll("left")}catch(a){return setTimeout(e,50)}rb(),db.ready()}}()}return O.promise(b)},db.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){W["[object "+b+"]"]=b.toLowerCase()}),P=db(S),sb=a,tb=function(a,b,c,d){var e,f,g,h,i,k;if((b?b.ownerDocument||b:ac)!==Ub&&Tb(b),b=b||Ub,c=c||[],!a||"string"!=typeof a)return c;if(1!==(h=b.nodeType)&&9!==h)return[];if(Wb&&!d){if(e=Cc.exec(a))if(g=e[1]){if(9===h){if(!(f=b.getElementById(g))||!f.parentNode)return c;if(f.id===g)return c.push(f),c}else if(b.ownerDocument&&(f=b.ownerDocument.getElementById(g))&&$b(b,f)&&f.id===g)return c.push(f),c}else{if(e[2])return nc.apply(c,b.getElementsByTagName(a)),c;if((g=e[3])&&Lb.getElementsByClassName&&b.getElementsByClassName)return nc.apply(c,b.getElementsByClassName(g)),c}if(Lb.qsa&&(!Xb||!Xb.test(a))){if(f=e=_b,g=b,i=9===h&&a,1===h&&"object"!==b.nodeName.toLowerCase()){for(h=Db(a),(e=b.getAttribute("id"))?f=e.replace(Fc,"\\$&"):b.setAttribute("id",f),f="[id='"+f+"'] ",g=h.length;g--;)h[g]=f+Eb(h[g]);g=wc.test(a)&&b.parentNode||b,i=h.join(",")}if(i)try{return nc.apply(c,g.querySelectorAll(i)),c}catch(j){}finally{e||b.removeAttribute("id")}}}a:{if(a=a.replace(tc,"$1"),f=Db(a),!d&&1===f.length){if(e=f[0]=f[0].slice(0),2<e.length&&"ID"===(k=e[0]).type&&Lb.getById&&9===b.nodeType&&Wb&&Nb.relative[e[1].type]){if(b=(Nb.find.ID(k.matches[0].replace(Gc,Hc),b)||[])[0],!b){k=c;break a}a=a.slice(e.shift().value.length)}for(h=Ac.needsContext.test(a)?0:e.length;h--&&(k=e[h],!Nb.relative[g=k.type]);)if((g=Nb.find[g])&&(d=g(k.matches[0].replace(Gc,Hc),wc.test(e[0].type)&&b.parentNode||b))){if(e.splice(h,1),a=d.length&&Eb(e),!a){nc.apply(c,d),k=c;break a}break}}Qb(a,f)(d,b,!Wb,c,wc.test(a)),k=c}return k},ub=function(){function a(c,d){return b.push(c+=" ")>Nb.cacheLength&&delete a[b.shift()],a[c]=d}var b=[];return a},vb=function(a){return a[_b]=!0,a},wb=function(a){var b=Ub.createElement("div");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b)}},xb=function(a,b){for(var c=a.split("|"),d=a.length;d--;)Nb.attrHandle[c[d]]=b},yb=function(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||ic)-(~a.sourceIndex||ic);if(d)return d;if(c)for(;c=c.nextSibling;)if(c===b)return-1;return a?1:-1},zb=function(a){return function(b){return"input"===b.nodeName.toLowerCase()&&b.type===a}},Ab=function(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}},Bb=function(a){return vb(function(b){return b=+b,vb(function(c,d){for(var e,f=a([],c.length,b),g=f.length;g--;)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})},Cb=function(){},Db=function(a,b){var c,d,e,f,g,h,i;if(g=ec[a+" "])return b?0:g.slice(0);for(g=a,h=[],i=Nb.preFilter;g;){(!c||(d=uc.exec(g)))&&(d&&(g=g.slice(d[0].length)||g),h.push(e=[])),c=!1,(d=vc.exec(g))&&(c=d.shift(),e.push({value:c,type:d[0].replace(tc," ")}),g=g.slice(c.length));for(f in Nb.filter)!(d=Ac[f].exec(g))||i[f]&&!(d=i[f](d))||(c=d.shift(),e.push({value:c,type:f,matches:d}),g=g.slice(c.length));if(!c)break}return b?g.length:g?tb.error(a):ec(a,h).slice(0)},Eb=function(a){for(var b=0,c=a.length,d="";c>b;b++)d+=a[b].value;return d},Fb=function(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=cc++;return b.first?function(b,c,f){for(;b=b[d];)if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j,k=bc+" "+f;if(g){for(;b=b[d];)if((1===b.nodeType||e)&&a(b,c,g))return!0}else for(;b=b[d];)if(1===b.nodeType||e)if(j=b[_b]||(b[_b]={}),(i=j[d])&&i[0]===k){if(!0===(h=i[1])||h===Mb)return!0===h}else if(i=j[d]=[k],i[1]=a(b,c,g)||Mb,!0===i[1])return!0}},Gb=function(a){return 1<a.length?function(b,c,d){for(var e=a.length;e--;)if(!a[e](b,c,d))return!1;return!0}:a[0]},Hb=function(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;i>h;h++)(f=a[h])&&(!c||c(f,d,e))&&(g.push(f),j&&b.push(h));return g},Ib=function(a,b,c,d,e,f){return d&&!d[_b]&&(d=Ib(d)),e&&!e[_b]&&(e=Ib(e,f)),vb(function(f,g,h,i){var j,k,o,p,q,r,s,l=[],m=[],n=g.length;if(!(o=f)){for(o=b||"*",p=h.nodeType?[h]:h,q=[],r=0,s=p.length;s>r;r++)tb(o,p[r],q);o=q}if(o=!a||!f&&b?o:Hb(o,l,a,h,i),p=c?e||(f?a:n||d)?[]:g:o,c&&c(o,p,h,i),d)for(j=Hb(p,m),d(j,[],h,i),h=j.length;h--;)(k=j[h])&&(p[m[h]]=!(o[m[h]]=k));if(f){if(e||a){if(e){for(j=[],h=p.length;h--;)(k=p[h])&&j.push(o[h]=k);e(null,p=[],j,i)}for(h=p.length;h--;)(k=p[h])&&-1<(j=e?pc.call(f,k):l[h])&&(f[j]=!(g[j]=k))}}else p=Hb(p===g?p.splice(n,p.length):p),e?e(null,g,p,i):nc.apply(g,p)})},Jb=function(a){var b,d,g,h,i,j,e=a.length,f=Nb.relative[a[0].type],c=f||Nb.relative[" "];for(g=f?1:0,h=Fb(function(a){return a===b},c,!0),i=Fb(function(a){return-1<pc.call(b,a)},c,!0),j=[function(a,c,d){return!f&&(d||c!==Rb)||((b=c).nodeType?h(a,c,d):i(a,c,d))}];e>g;g++)if(c=Nb.relative[a[g].type])j=[Fb(Gb(j),c)];else{if(c=Nb.filter[a[g].type].apply(null,a[g].matches),c[_b]){for(d=++g;e>d&&!Nb.relative[a[d].type];d++);return Ib(g>1&&Gb(j),g>1&&Eb(a.slice(0,g-1).concat({value:" "===a[g-2].type?"*":""})).replace(tc,"$1"),c,d>g&&Jb(a.slice(g,d)),e>d&&Jb(a=a.slice(d)),e>d&&Eb(a))}j.push(c)}return Gb(j)},_b="sizzle"+-new Date,ac=sb.document,bc=0,cc=0,dc=ub(),ec=ub(),fc=ub(),gc=!1,hc=function(a,b){return a===b&&(gc=!0),0},ic=-2147483648,jc={}.hasOwnProperty,kc=[],lc=kc.pop,mc=kc.push,nc=kc.push,oc=kc.slice,pc=kc.indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(this[b]===a)return b;return-1},qc="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+".replace("w","w#"),rc="\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)[\\x20\\t\\r\\n\\f]*(?:([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+qc+")|)|)[\\x20\\t\\r\\n\\f]*\\]",sc=":((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+rc.replace(3,8)+")*)|.*)\\)|)",tc=RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$","g"),uc=/^[\x20\t\r\n\f]*,[\x20\t\r\n\f]*/,vc=/^[\x20\t\r\n\f]*([>+~]|[\x20\t\r\n\f])[\x20\t\r\n\f]*/,wc=/[\x20\t\r\n\f]*[+~]/,xc=RegExp("=[\\x20\\t\\r\\n\\f]*([^\\]'\"]*)[\\x20\\t\\r\\n\\f]*\\]","g"),yc=RegExp(sc),zc=RegExp("^"+qc+"$"),Ac={ID:/^#((?:\\.|[\w-]|[^\x00-\xa0])+)/,CLASS:/^\.((?:\\.|[\w-]|[^\x00-\xa0])+)/,TAG:RegExp("^("+"(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+".replace("w","w*")+")"),ATTR:RegExp("^"+rc),PSEUDO:RegExp("^"+sc),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\([\\x20\\t\\r\\n\\f]*(even|odd|(([+-]|)(\\d*)n|)[\\x20\\t\\r\\n\\f]*(?:([+-]|)[\\x20\\t\\r\\n\\f]*(\\d+)|))[\\x20\\t\\r\\n\\f]*\\)|)","i"),bool:RegExp("^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$","i"),needsContext:RegExp("^[\\x20\\t\\r\\n\\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\([\\x20\\t\\r\\n\\f]*((?:-\\d)?\\d*)[\\x20\\t\\r\\n\\f]*\\)|)(?=[^-]|$)","i")},Bc=/^[^{]+\{\s*\[native \w/,Cc=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Dc=/^(?:input|select|textarea|button)$/i,Ec=/^h\d$/i,Fc=/'|\\/g,Gc=RegExp("\\\\([\\da-f]{1,6}[\\x20\\t\\r\\n\\f]?|([\\x20\\t\\r\\n\\f])|.)","ig"),Hc=function(a,b,c){return a="0x"+b-65536,a!==a||c?b:0>a?String.fromCharCode(a+65536):String.fromCharCode(55296|a>>10,56320|1023&a)};try{nc.apply(kc=oc.call(ac.childNodes),ac.childNodes),kc[ac.childNodes.length].nodeType}catch(Ic){nc={apply:kc.length?function(a,b){mc.apply(a,oc.call(b))}:function(a,b){for(var c=a.length,d=0;a[c++]=b[d++];);a.length=c-1}}}Pb=tb.isXML=function(a){return(a=a&&(a.ownerDocument||a).documentElement)?"HTML"!==a.nodeName:!1},Lb=tb.support={},Tb=tb.setDocument=function(a){var b=a?a.ownerDocument||a:ac;return a=b.defaultView,b!==Ub&&9===b.nodeType&&b.documentElement?(Ub=b,Vb=b.documentElement,Wb=!Pb(b),a&&a.attachEvent&&a!==a.top&&a.attachEvent("onbeforeunload",function(){Tb()}),Lb.attributes=wb(function(a){return a.className="i",!a.getAttribute("className")}),Lb.getElementsByTagName=wb(function(a){return a.appendChild(b.createComment("")),!a.getElementsByTagName("*").length}),Lb.getElementsByClassName=wb(function(a){return a.innerHTML="<div class='a'></div><div class='a i'></div>",a.firstChild.className="i",2===a.getElementsByClassName("i").length}),Lb.getById=wb(function(a){return Vb.appendChild(a).id=_b,!b.getElementsByName||!b.getElementsByName(_b).length}),Lb.getById?(Nb.find.ID=function(a,b){if("undefined"!=typeof b.getElementById&&Wb){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},Nb.filter.ID=function(a){var b=a.replace(Gc,Hc);return function(a){return a.getAttribute("id")===b}}):(delete Nb.find.ID,Nb.filter.ID=function(a){var b=a.replace(Gc,Hc);return function(a){return(a="undefined"!=typeof a.getAttributeNode&&a.getAttributeNode("id"))&&a.value===b}}),Nb.find.TAG=Lb.getElementsByTagName?function(a,b){return"undefined"!=typeof b.getElementsByTagName?b.getElementsByTagName(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){for(;c=f[e++];)1===c.nodeType&&d.push(c);return d}return f},Nb.find.CLASS=Lb.getElementsByClassName&&function(a,b){return"undefined"!=typeof b.getElementsByClassName&&Wb?b.getElementsByClassName(a):void 0},Yb=[],Xb=[],(Lb.qsa=Bc.test(b.querySelectorAll))&&(wb(function(a){a.innerHTML="<select><option selected=''></option></select>",a.querySelectorAll("[selected]").length||Xb.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)"),a.querySelectorAll(":checked").length||Xb.push(":checked")}),wb(function(a){var c=b.createElement("input");c.setAttribute("type","hidden"),a.appendChild(c).setAttribute("t",""),a.querySelectorAll("[t^='']").length&&Xb.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")"),a.querySelectorAll(":enabled").length||Xb.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),Xb.push(",.*:")})),(Lb.matchesSelector=Bc.test(Zb=Vb.webkitMatchesSelector||Vb.mozMatchesSelector||Vb.oMatchesSelector||Vb.msMatchesSelector))&&wb(function(a){Lb.disconnectedMatch=Zb.call(a,"div"),Zb.call(a,"[s!='']:x"),Yb.push("!=",sc)}),Xb=Xb.length&&RegExp(Xb.join("|")),Yb=Yb.length&&RegExp(Yb.join("|")),$b=Bc.test(Vb.contains)||Vb.compareDocumentPosition?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},hc=Vb.compareDocumentPosition?function(a,c){if(a===c)return gc=!0,0;var d=c.compareDocumentPosition&&a.compareDocumentPosition&&a.compareDocumentPosition(c);return d?1&d||!Lb.sortDetached&&c.compareDocumentPosition(a)===d?a===b||$b(ac,a)?-1:c===b||$b(ac,c)?1:Sb?pc.call(Sb,a)-pc.call(Sb,c):0:4&d?-1:1:a.compareDocumentPosition?-1:1}:function(a,c){var e=0,d=a.parentNode,f=c.parentNode,g=[a],h=[c];if(a===c)return gc=!0,0;if(!d||!f)return a===b?-1:c===b?1:d?-1:f?1:Sb?pc.call(Sb,a)-pc.call(Sb,c):0;if(d===f)return yb(a,c);for(d=a;d=d.parentNode;)g.unshift(d);for(d=c;d=d.parentNode;)h.unshift(d);for(;g[e]===h[e];)e++;return e?yb(g[e],h[e]):g[e]===ac?-1:h[e]===ac?1:0},b):Ub},tb.matches=function(a,b){return tb(a,null,null,b)},tb.matchesSelector=function(a,b){if((a.ownerDocument||a)!==Ub&&Tb(a),b=b.replace(xc,"='$1']"),!(!Lb.matchesSelector||!Wb||Yb&&Yb.test(b)||Xb&&Xb.test(b)))try{var c=Zb.call(a,b);if(c||Lb.disconnectedMatch||a.document&&11!==a.document.nodeType)return c}catch(d){}return 0<tb(b,Ub,null,[a]).length},tb.contains=function(a,b){return(a.ownerDocument||a)!==Ub&&Tb(a),$b(a,b)},tb.attr=function(a,b){(a.ownerDocument||a)!==Ub&&Tb(a);var c=Nb.attrHandle[b.toLowerCase()],c=c&&jc.call(Nb.attrHandle,b.toLowerCase())?c(a,b,!Wb):void 0;return void 0===c?Lb.attributes||!Wb?a.getAttribute(b):(c=a.getAttributeNode(b))&&c.specified?c.value:null:c},tb.error=function(a){throw Error("Syntax error, unrecognized expression: "+a)},tb.uniqueSort=function(a){var b,c=[],d=0,e=0;if(gc=!Lb.detectDuplicates,Sb=!Lb.sortStable&&a.slice(0),a.sort(hc),gc){for(;b=a[e++];)b===a[e]&&(d=c.push(e));for(;d--;)a.splice(c[d],1)}return a},Ob=tb.getText=function(a){var b,c="",d=0;if(b=a.nodeType){if(1===b||9===b||11===b){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=Ob(a)}else if(3===b||4===b)return a.nodeValue}else for(;b=a[d];d++)c+=Ob(b);return c},Nb=tb.selectors={cacheLength:50,createPseudo:vb,match:Ac,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(Gc,Hc),a[3]=(a[4]||a[5]||"").replace(Gc,Hc),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||tb.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&tb.error(a[0]),a},PSEUDO:function(a){var b,c=!a[5]&&a[2];return Ac.CHILD.test(a[0])?null:(a[3]&&void 0!==a[4]?a[2]=a[4]:c&&yc.test(c)&&(b=Db(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(Gc,Hc).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=dc[a+" "];return b||(b=RegExp("(^|[\\x20\\t\\r\\n\\f])"+a+"([\\x20\\t\\r\\n\\f]|$)"))&&dc(a,function(a){return b.test("string"==typeof a.className&&a.className||"undefined"!=typeof a.getAttribute&&a.getAttribute("class")||"")})},ATTR:function(a,b,c){return function(d){return d=tb.attr(d,a),null==d?"!="===b:b?(d+="","="===b?d===c:"!="===b?d!==c:"^="===b?c&&0===d.indexOf(c):"*="===b?c&&-1<d.indexOf(c):"$="===b?c&&d.slice(-c.length)===c:"~="===b?-1<(" "+d+" ").indexOf(c):"|="===b?d===c||d.slice(0,c.length+1)===c+"-":!1):!0}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p;if(c=f!==g?"nextSibling":"previousSibling",o=b.parentNode,p=h&&b.nodeName.toLowerCase(),i=!i&&!h,o){if(f){for(;c;){for(k=b;k=k[c];)if(h?k.nodeName.toLowerCase()===p:1===k.nodeType)return!1;n=c="only"===a&&!n&&"nextSibling"}return!0}if(n=[g?o.firstChild:o.lastChild],g&&i){for(i=o[_b]||(o[_b]={}),j=i[a]||[],m=j[0]===bc&&j[1],l=j[0]===bc&&j[2],k=m&&o.childNodes[m];k=++m&&k&&k[c]||(l=m=0)||n.pop();)if(1===k.nodeType&&++l&&k===b){i[a]=[bc,m,l];break}}else if(i&&(j=(b[_b]||(b[_b]={}))[a])&&j[0]===bc)l=j[1];else for(;(k=++m&&k&&k[c]||(l=m=0)||n.pop())&&((h?k.nodeName.toLowerCase()!==p:1!==k.nodeType)||!++l||(i&&((k[_b]||(k[_b]={}))[a]=[bc,l]),k!==b)););return l-=e,l===d||0===l%d&&l/d>=0}}},PSEUDO:function(a,b){var c,d=Nb.pseudos[a]||Nb.setFilters[a.toLowerCase()]||tb.error("unsupported pseudo: "+a);return d[_b]?d(b):1<d.length?(c=[a,a,"",b],Nb.setFilters.hasOwnProperty(a.toLowerCase())?vb(function(a,c){for(var e,f=d(a,b),g=f.length;g--;)e=pc.call(a,f[g]),a[e]=!(c[e]=f[g])}):function(a){return d(a,0,c)}):d}},pseudos:{not:vb(function(a){var b=[],c=[],d=Qb(a.replace(tc,"$1"));return d[_b]?vb(function(a,b,c,e){e=d(a,null,e,[]);for(var f=a.length;f--;)(c=e[f])&&(a[f]=!(b[f]=c))}):function(a,e,f){return b[0]=a,d(b,null,f,c),!c.pop()}}),has:vb(function(a){return function(b){return 0<tb(a,b).length}}),contains:vb(function(a){return function(b){return-1<(b.textContent||b.innerText||Ob(b)).indexOf(a)}}),lang:vb(function(a){return zc.test(a||"")||tb.error("unsupported lang: "+a),a=a.replace(Gc,Hc).toLowerCase(),function(b){var c;do if(c=Wb?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(a){var b=sb.location&&sb.location.hash;return b&&b.slice(1)===a.id},root:function(a){return a===Vb},focus:function(a){return!(a!==Ub.activeElement||Ub.hasFocus&&!Ub.hasFocus()||!a.type&&!a.href&&!~a.tabIndex)},enabled:function(a){return!1===a.disabled},disabled:function(a){return!0===a.disabled},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,!0===a.selected},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if("@"<a.nodeName||3===a.nodeType||4===a.nodeType)return!1;
return!0},parent:function(a){return!Nb.pseudos.empty(a)},header:function(a){return Ec.test(a.nodeName)},input:function(a){return Dc.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||b.toLowerCase()===a.type)},first:Bb(function(){return[0]}),last:Bb(function(a,b){return[b-1]}),eq:Bb(function(a,b,c){return[0>c?c+b:c]}),even:Bb(function(a,b){for(var c=0;b>c;c+=2)a.push(c);return a}),odd:Bb(function(a,b){for(var c=1;b>c;c+=2)a.push(c);return a}),lt:Bb(function(a,b,c){for(b=0>c?c+b:c;0<=--b;)a.push(b);return a}),gt:Bb(function(a,b,c){for(c=0>c?c+b:c;++c<b;)a.push(c);return a})}},Nb.pseudos.nth=Nb.pseudos.eq;for(Kb in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})Nb.pseudos[Kb]=zb(Kb);for(Kb in{submit:!0,reset:!0})Nb.pseudos[Kb]=Ab(Kb);if(Cb.prototype=Nb.filters=Nb.pseudos,Nb.setFilters=new Cb,Qb=tb.compile=function(a,b){var c,g,h,i,d=[],e=[],f=fc[a+" "];if(!f){for(b||(b=Db(a)),c=b.length;c--;)f=Jb(b[c]),f[_b]?d.push(f):e.push(f);g=0,h=0<d.length,i=0<e.length,c=function(a,b,c,f,j){var k,l,m=[],n=0,o="0",p=a&&[],q=null!=j,r=Rb,s=a||i&&Nb.find.TAG("*",j&&b.parentNode||b),t=bc+=null==r?1:Math.random()||.1;for(q&&(Rb=b!==Ub&&b,Mb=g);null!=(j=s[o]);o++){if(i&&j){for(k=0;l=e[k++];)if(l(j,b,c)){f.push(j);break}q&&(bc=t,Mb=++g)}h&&((j=!l&&j)&&n--,a&&p.push(j))}if(n+=o,h&&o!==n){for(k=0;l=d[k++];)l(p,m,b,c);if(a){if(n>0)for(;o--;)!p[o]&&!m[o]&&(m[o]=lc.call(f));m=Hb(m)}nc.apply(f,m),q&&!a&&0<m.length&&1<n+d.length&&tb.uniqueSort(f)}return q&&(bc=t,Rb=r),p},c=h?vb(c):c,f=fc(a,c)}return f},Lb.sortStable=_b.split("").sort(hc).join("")===_b,Lb.detectDuplicates=gc,Tb(),Lb.sortDetached=wb(function(a){return 1&a.compareDocumentPosition(Ub.createElement("div"))}),wb(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||xb("type|href|height|width",function(a,b,c){return c?void 0:a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),(!Lb.attributes||!wb(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")}))&&xb("value",function(a,b,c){return c||"input"!==a.nodeName.toLowerCase()?void 0:a.defaultValue}),wb(function(a){return null==a.getAttribute("disabled")})||xb("checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",function(a,b,c){var d;return c?void 0:(d=a.getAttributeNode(b))&&d.specified?d.value:!0===a[b]?b.toLowerCase():null}),db.find=tb,db.expr=tb.selectors,db.expr[":"]=db.expr.pseudos,db.unique=tb.uniqueSort,db.text=tb.getText,db.isXMLDoc=tb.isXML,db.contains=tb.contains,Jc={},db.Callbacks=function(a){var b,d,e,f,g,h,i,j,k,l,m,n;return"string"==typeof a?(b=Jc[a])||(b=a,d=Jc[b]={},db.each(b.match(fb)||[],function(a,b){d[b]=!0}),b=d):b=db.extend({},a),a=b,k=[],l=!a.once&&[],m=function(b){for(f=a.memory&&b,g=!0,i=j||0,j=0,h=k.length,e=!0;k&&h>i;i++)if(!1===k[i].apply(b[0],b[1])&&a.stopOnFalse){f=!1;break}e=!1,k&&(l?l.length&&m(l.shift()):f?k=[]:n.disable())},n={add:function(){if(k){var b=k.length;!function c(b){db.each(b,function(b,d){var e=db.type(d);"function"===e?(!a.unique||!n.has(d))&&k.push(d):d&&d.length&&"string"!==e&&c(d)})}(arguments),e?h=k.length:f&&(j=b,m(f))}return this},remove:function(){return k&&db.each(arguments,function(a,b){for(var c;-1<(c=db.inArray(b,k,c));)k.splice(c,1),e&&(h>=c&&h--,i>=c&&i--)}),this},has:function(a){return a?-1<db.inArray(a,k):!(!k||!k.length)},empty:function(){return k=[],h=0,this},disable:function(){return k=l=f=c,this},disabled:function(){return!k},lock:function(){return l=c,f||n.disable(),this},locked:function(){return!l},fireWith:function(a,b){return!k||g&&!l||(b=b||[],b=[a,b.slice?b.slice():b],e?l.push(b):m(b)),this},fire:function(){return n.fireWith(this,arguments),this},fired:function(){return!!g}},n},db.extend({Deferred:function(a){var b=[["resolve","done",db.Callbacks("once memory"),"resolved"],["reject","fail",db.Callbacks("once memory"),"rejected"],["notify","progress",db.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return db.Deferred(function(c){db.each(b,function(b,f){var g=f[0],h=db.isFunction(a[b])&&a[b];e[f[1]](function(){var a=h&&h.apply(this,arguments);a&&db.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[g+"With"](this===d?c.promise():this,h?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?db.extend(a,d):d}},e={};return d.pipe=d.then,db.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this},e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var h,i,j,b=0,c=$.call(arguments),d=c.length,e=1!==d||a&&db.isFunction(a.promise)?d:0,f=1===e?a:db.Deferred(),g=function(a,b,c){return function(d){b[a]=this,c[a]=1<arguments.length?$.call(arguments):d,c===h?f.notifyWith(b,c):--e||f.resolveWith(b,c)}};if(d>1)for(h=Array(d),i=Array(d),j=Array(d);d>b;b++)c[b]&&db.isFunction(c[b].promise)?c[b].promise().done(g(b,j,c)).fail(f.reject).progress(g(b,i,h)):--e;return e||f.resolveWith(j,c),f.promise()}}),Kc=db,Lc={},Vc=S.createElement("div"),Vc.setAttribute("className","t"),Vc.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",Mc=Vc.getElementsByTagName("*")||[],(Nc=Vc.getElementsByTagName("a")[0])&&Nc.style&&Mc.length){Pc=S.createElement("select"),Rc=Pc.appendChild(S.createElement("option")),Oc=Vc.getElementsByTagName("input")[0],Nc.style.cssText="top:1px;float:left;opacity:.5",Lc.getSetAttribute="t"!==Vc.className,Lc.leadingWhitespace=3===Vc.firstChild.nodeType,Lc.tbody=!Vc.getElementsByTagName("tbody").length,Lc.htmlSerialize=!!Vc.getElementsByTagName("link").length,Lc.style=/top/.test(Nc.getAttribute("style")),Lc.hrefNormalized="/a"===Nc.getAttribute("href"),Lc.opacity=/^0.5/.test(Nc.style.opacity),Lc.cssFloat=!!Nc.style.cssFloat,Lc.checkOn=!!Oc.value,Lc.optSelected=Rc.selected,Lc.enctype=!!S.createElement("form").enctype,Lc.html5Clone="<:nav></:nav>"!==S.createElement("nav").cloneNode(!0).outerHTML,Lc.inlineBlockNeedsLayout=!1,Lc.shrinkWrapBlocks=!1,Lc.pixelPosition=!1,Lc.deleteExpando=!0,Lc.noCloneEvent=!0,Lc.reliableMarginRight=!0,Lc.boxSizingReliable=!0,Oc.checked=!0,Lc.noCloneChecked=Oc.cloneNode(!0).checked,Pc.disabled=!0,Lc.optDisabled=!Rc.disabled;try{delete Vc.test}catch(Wc){Lc.deleteExpando=!1}Oc=S.createElement("input"),Oc.setAttribute("value",""),Lc.input=""===Oc.getAttribute("value"),Oc.value="t",Oc.setAttribute("type","radio"),Lc.radioValue="t"===Oc.value,Oc.setAttribute("checked","t"),Oc.setAttribute("name","t"),Qc=S.createDocumentFragment(),Qc.appendChild(Oc),Lc.appendChecked=Oc.checked,Lc.checkClone=Qc.cloneNode(!0).cloneNode(!0).lastChild.checked,Vc.attachEvent&&(Vc.attachEvent("onclick",function(){Lc.noCloneEvent=!1}),Vc.cloneNode(!0).click());for(Uc in{submit:!0,change:!0,focusin:!0})Vc.setAttribute(Sc="on"+Uc,"t"),Lc[Uc+"Bubbles"]=Sc in a||!1===Vc.attributes[Sc].expando;Vc.style.backgroundClip="content-box",Vc.cloneNode(!0).style.backgroundClip="",Lc.clearCloneStyle="content-box"===Vc.style.backgroundClip;for(Uc in db(Lc))break;Lc.ownLast="0"!==Uc,db(function(){var b,c,d=S.getElementsByTagName("body")[0];d&&(b=S.createElement("div"),b.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",d.appendChild(b).appendChild(Vc),Vc.innerHTML="<table><tr><td></td><td>t</td></tr></table>",c=Vc.getElementsByTagName("td"),c[0].style.cssText="padding:0;margin:0;border:0;display:none",Tc=0===c[0].offsetHeight,c[0].style.display="",c[1].style.display="none",Lc.reliableHiddenOffsets=Tc&&0===c[0].offsetHeight,Vc.innerHTML="",Vc.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",db.swap(d,null!=d.style.zoom?{zoom:1}:{},function(){Lc.boxSizing=4===Vc.offsetWidth}),a.getComputedStyle&&(Lc.pixelPosition="1%"!==(a.getComputedStyle(Vc,null)||{}).top,Lc.boxSizingReliable="4px"===(a.getComputedStyle(Vc,null)||{width:"4px"}).width,c=Vc.appendChild(S.createElement("div")),c.style.cssText=Vc.style.cssText="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",c.style.marginRight=c.style.width="0",Vc.style.width="1px",Lc.reliableMarginRight=!parseFloat((a.getComputedStyle(c,null)||{}).marginRight)),typeof Vc.style.zoom!==Q&&(Vc.innerHTML="",Vc.style.cssText="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;width:1px;padding:1px;display:inline;zoom:1",Lc.inlineBlockNeedsLayout=3===Vc.offsetWidth,Vc.style.display="block",Vc.innerHTML="<div></div>",Vc.firstChild.style.width="5px",Lc.shrinkWrapBlocks=3!==Vc.offsetWidth,Lc.inlineBlockNeedsLayout&&(d.style.zoom=1)),d.removeChild(b),b=Vc=c=c=null)}),Mc=Pc=Qc=Rc=Nc=Oc=null}Kc.support=Lc,Xc=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,Yc=/([A-Z])/g,db.extend({cache:{},noData:{applet:!0,embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(a){return a=a.nodeType?db.cache[a[db.expando]]:a[db.expando],!!a&&!h(a)},data:function(a,b,c){return e(a,b,c)},removeData:function(a,b){return f(a,b)},_data:function(a,b,c){return e(a,b,c,!0)},_removeData:function(a,b){return f(a,b,!0)},acceptData:function(a){if(a.nodeType&&1!==a.nodeType&&9!==a.nodeType)return!1;var b=a.nodeName&&db.noData[a.nodeName.toLowerCase()];return!b||!0!==b&&a.getAttribute("classid")===b}}),db.fn.extend({data:function(a,b){var d,e,f=null,h=0,i=this[0];if(a===c){if(this.length&&(f=db.data(i),1===i.nodeType&&!db._data(i,"parsedAttrs"))){for(d=i.attributes;h<d.length;h++)e=d[h].name,0===e.indexOf("data-")&&(e=db.camelCase(e.slice(5)),g(i,e,f[e]));db._data(i,"parsedAttrs",!0)}return f}return"object"==typeof a?this.each(function(){db.data(this,a)}):1<arguments.length?this.each(function(){db.data(this,a,b)}):i?g(i,a,db.data(i,a)):null},removeData:function(a){return this.each(function(){db.removeData(this,a)})}}),db.extend({queue:function(a,b,c){var d;return a?(b=(b||"fx")+"queue",d=db._data(a,b),c&&(!d||db.isArray(c)?d=db._data(a,b,db.makeArray(c)):d.push(c)),d||[]):void 0},dequeue:function(a,b){b=b||"fx";var c=db.queue(a,b),d=c.length,e=c.shift(),f=db._queueHooks(a,b),g=function(){db.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return db._data(a,c)||db._data(a,c,{empty:db.Callbacks("once memory").add(function(){db._removeData(a,b+"queue"),db._removeData(a,c)})})}}),db.fn.extend({queue:function(a,b){var d=2;return"string"!=typeof a&&(b=a,a="fx",d--),arguments.length<d?db.queue(this[0],a):b===c?this:this.each(function(){var c=db.queue(this,a,b);db._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&db.dequeue(this,a)})},dequeue:function(a){return this.each(function(){db.dequeue(this,a)})},delay:function(a,b){return a=db.fx?db.fx.speeds[a]||a:a,this.queue(b||"fx",function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var d,e=1,f=db.Deferred(),g=this,h=this.length,i=function(){--e||f.resolveWith(g,[g])};for("string"!=typeof a&&(b=a,a=c),a=a||"fx";h--;)(d=db._data(g[h],a+"queueHooks"))&&d.empty&&(e++,d.empty.add(i));return i(),f.promise(b)}}),_c=/[\t\r\n\f]/g,ad=/\r/g,bd=/^(?:input|select|textarea|button|object)$/i,cd=/^(?:a|area)$/i,dd=/^(?:checked|selected)$/i,ed=db.support.getSetAttribute,fd=db.support.input,db.fn.extend({attr:function(a,b){return db.access(this,db.attr,a,b,1<arguments.length)},removeAttr:function(a){return this.each(function(){db.removeAttr(this,a)})},prop:function(a,b){return db.access(this,db.prop,a,b,1<arguments.length)},removeProp:function(a){return a=db.propFix[a]||a,this.each(function(){try{this[a]=c,delete this[a]}catch(b){}})},addClass:function(a){var b,c,d,e,f,g=0,h=this.length;if(b="string"==typeof a&&a,db.isFunction(a))return this.each(function(b){db(this).addClass(a.call(this,b,this.className))});if(b)for(b=(a||"").match(fb)||[];h>g;g++)if(c=this[g],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(_c," "):" ")){for(f=0;e=b[f++];)0>d.indexOf(" "+e+" ")&&(d+=e+" ");c.className=db.trim(d)}return this},removeClass:function(a){var b,c,d,e,f,g=0,h=this.length;if(b=0===arguments.length||"string"==typeof a&&a,db.isFunction(a))return this.each(function(b){db(this).removeClass(a.call(this,b,this.className))});if(b)for(b=(a||"").match(fb)||[];h>g;g++)if(c=this[g],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(_c," "):"")){for(f=0;e=b[f++];)for(;0<=d.indexOf(" "+e+" ");)d=d.replace(" "+e+" "," ");c.className=a?db.trim(d):""}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):db.isFunction(a)?this.each(function(c){db(this).toggleClass(a.call(this,c,this.className,b),b)}):this.each(function(){if("string"===c)for(var b,d=0,e=db(this),f=a.match(fb)||[];b=f[d++];)e.hasClass(b)?e.removeClass(b):e.addClass(b);else(c===Q||"boolean"===c)&&(this.className&&db._data(this,"__className__",this.className),this.className=this.className||!1===a?"":db._data(this,"__className__")||"")})},hasClass:function(a){a=" "+a+" ";for(var b=0,c=this.length;c>b;b++)if(1===this[b].nodeType&&0<=(" "+this[b].className+" ").replace(_c," ").indexOf(a))return!0;return!1},val:function(a){var b,d,e,f=this[0];return arguments.length?(e=db.isFunction(a),this.each(function(b){1!==this.nodeType||(b=e?a.call(this,b,db(this).val()):a,null==b?b="":"number"==typeof b?b+="":db.isArray(b)&&(b=db.map(b,function(a){return null==a?"":a+""})),d=db.valHooks[this.type]||db.valHooks[this.nodeName.toLowerCase()],d&&"set"in d&&d.set(this,b,"value")!==c)||(this.value=b)})):f?(d=db.valHooks[f.type]||db.valHooks[f.nodeName.toLowerCase()])&&"get"in d&&(b=d.get(f,"value"))!==c?b:(b=f.value,"string"==typeof b?b.replace(ad,""):null==b?"":b):void 0}}),db.extend({valHooks:{option:{get:function(a){var b=db.find.attr(a,"value");return null!=b?b:a.text}},select:{get:function(a){for(var b,c=a.options,d=a.selectedIndex,e=(a="select-one"===a.type||0>d)?null:[],f=a?d+1:c.length,g=0>d?f:a?d:0;f>g;g++)if(b=c[g],!(!b.selected&&g!==d||(db.support.optDisabled?b.disabled:null!==b.getAttribute("disabled"))||b.parentNode.disabled&&db.nodeName(b.parentNode,"optgroup"))){if(b=db(b).val(),a)return b;e.push(b)}return e},set:function(a,b){for(var c,d,e=a.options,f=db.makeArray(b),g=e.length;g--;)d=e[g],(d.selected=0<=db.inArray(db(d).val(),f))&&(c=!0);return c||(a.selectedIndex=-1),f}}},attr:function(a,b,d){var e,f,g=a.nodeType;if(a&&3!==g&&8!==g&&2!==g){if(typeof a.getAttribute===Q)return db.prop(a,b,d);if(1===g&&db.isXMLDoc(a)||(b=b.toLowerCase(),e=db.attrHooks[b]||(db.expr.match.bool.test(b)?$c:Zc)),d===c)return e&&"get"in e&&null!==(f=e.get(a,b))?f:(f=db.find.attr(a,b),null==f?c:f);if(null!==d)return e&&"set"in e&&(f=e.set(a,d,b))!==c?f:(a.setAttribute(b,d+""),d);db.removeAttr(a,b)}},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(fb);if(f&&1===a.nodeType)for(;c=f[e++];)d=db.propFix[c]||c,db.expr.match.bool.test(c)?fd&&ed||!dd.test(c)?a[d]=!1:a[db.camelCase("default-"+c)]=a[d]=!1:db.attr(a,c,""),a.removeAttribute(ed?c:d)},attrHooks:{type:{set:function(a,b){if(!db.support.radioValue&&"radio"===b&&db.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(a,b,d){var e,f,g;return g=a.nodeType,a&&3!==g&&8!==g&&2!==g?((g=1!==g||!db.isXMLDoc(a))&&(b=db.propFix[b]||b,f=db.propHooks[b]),d!==c?f&&"set"in f&&(e=f.set(a,d,b))!==c?e:a[b]=d:f&&"get"in f&&null!==(e=f.get(a,b))?e:a[b]):void 0},propHooks:{tabIndex:{get:function(a){var b=db.find.attr(a,"tabindex");return b?parseInt(b,10):bd.test(a.nodeName)||cd.test(a.nodeName)&&a.href?0:-1}}}}),$c={set:function(a,b,c){return!1===b?db.removeAttr(a,c):fd&&ed||!dd.test(c)?a.setAttribute(!ed&&db.propFix[c]||c,c):a[db.camelCase("default-"+c)]=a[c]=!0,c}},db.each(db.expr.match.bool.source.match(/\w+/g),function(a,b){var d=db.expr.attrHandle[b]||db.find.attr;db.expr.attrHandle[b]=fd&&ed||!dd.test(b)?function(a,b,e){var f=db.expr.attrHandle[b];return a=e?c:(db.expr.attrHandle[b]=c)!=d(a,b,e)?b.toLowerCase():null,db.expr.attrHandle[b]=f,a}:function(a,b,d){return d?c:a[db.camelCase("default-"+b)]?b.toLowerCase():null}}),fd&&ed||(db.attrHooks.value={set:function(a,b,c){return db.nodeName(a,"input")?(a.defaultValue=b,void 0):Zc&&Zc.set(a,b,c)}}),ed||(Zc={set:function(a,b,d){var e=a.getAttributeNode(d);return e||a.setAttributeNode(e=a.ownerDocument.createAttribute(d)),e.value=b+="","value"===d||b===a.getAttribute(d)?b:c}},db.expr.attrHandle.id=db.expr.attrHandle.name=db.expr.attrHandle.coords=function(a,b,d){var e;return d?c:(e=a.getAttributeNode(b))&&""!==e.value?e.value:null},db.valHooks.button={get:function(a,b){var d=a.getAttributeNode(b);return d&&d.specified?d.value:c},set:Zc.set},db.attrHooks.contenteditable={set:function(a,b,c){Zc.set(a,""===b?!1:b,c)}},db.each(["width","height"],function(a,b){db.attrHooks[b]={set:function(a,c){return""===c?(a.setAttribute(b,"auto"),c):void 0}}})),db.support.hrefNormalized||db.each(["href","src"],function(a,b){db.propHooks[b]={get:function(a){return a.getAttribute(b,4)}}}),db.support.style||(db.attrHooks.style={get:function(a){return a.style.cssText||c},set:function(a,b){return a.style.cssText=b+""}}),db.support.optSelected||(db.propHooks.selected={get:function(a){return(a=a.parentNode)&&(a.selectedIndex,a.parentNode&&a.parentNode.selectedIndex),null}}),db.each("tabIndex readOnly maxLength cellSpacing cellPadding rowSpan colSpan useMap frameBorder contentEditable".split(" "),function(){db.propFix[this.toLowerCase()]=this}),db.support.enctype||(db.propFix.enctype="encoding"),db.each(["radio","checkbox"],function(){db.valHooks[this]={set:function(a,b){return db.isArray(b)?a.checked=0<=db.inArray(db(a).val(),b):void 0}},db.support.checkOn||(db.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})}),gd=/^(?:input|select|textarea)$/i,hd=/^key/,id=/^(?:mouse|contextmenu)|click/,jd=/^(?:focusinfocus|focusoutblur)$/,kd=/^([^.]*)(?:\.(.+)|)$/,db.event={global:{},add:function(a,b,d,e,f){var g,h,i,j,k,l,m,n,o;if(i=db._data(a)){for(d.handler&&(j=d,d=j.handler,f=j.selector),d.guid||(d.guid=db.guid++),(h=i.events)||(h=i.events={}),(k=i.handle)||(k=i.handle=function(a){return typeof db===Q||a&&db.event.triggered===a.type?c:db.event.dispatch.apply(k.elem,arguments)},k.elem=a),b=(b||"").match(fb)||[""],i=b.length;i--;)g=kd.exec(b[i])||[],n=l=g[1],o=(g[2]||"").split(".").sort(),n&&(g=db.event.special[n]||{},n=(f?g.delegateType:g.bindType)||n,g=db.event.special[n]||{},l=db.extend({type:n,origType:l,data:e,handler:d,guid:d.guid,selector:f,needsContext:f&&db.expr.match.needsContext.test(f),namespace:o.join(".")},j),(m=h[n])||(m=h[n]=[],m.delegateCount=0,g.setup&&!1!==g.setup.call(a,e,o,k)||(a.addEventListener?a.addEventListener(n,k,!1):a.attachEvent&&a.attachEvent("on"+n,k))),g.add&&(g.add.call(a,l),l.handler.guid||(l.handler.guid=d.guid)),f?m.splice(m.delegateCount++,0,l):m.push(l),db.event.global[n]=!0);a=null}},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=db.hasData(a)&&db._data(a);if(q&&(k=q.events)){for(b=(b||"").match(fb)||[""],j=b.length;j--;)if(h=kd.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n){for(l=db.event.special[n]||{},n=(d?l.delegateType:l.bindType)||n,m=k[n]||[],h=h[2]&&RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)"),i=f=m.length;f--;)g=m[f],!e&&p!==g.origType||c&&c.guid!==g.guid||h&&!h.test(g.namespace)||d&&d!==g.selector&&("**"!==d||!g.selector)||(m.splice(f,1),g.selector&&m.delegateCount--,l.remove&&l.remove.call(a,g));i&&!m.length&&((!l.teardown||!1===l.teardown.call(a,o,q.handle))&&db.removeEvent(a,n,q.handle),delete k[n])}else for(n in k)db.event.remove(a,n+b[j],c,d,!0);db.isEmptyObject(k)&&(delete q.handle,db._removeData(a,"events"))}},trigger:function(b,d,e,f){var g,h,i,j,k,l,m=[e||S],n=bb.call(b,"type")?b.type:b;if(k=bb.call(b,"namespace")?b.namespace.split("."):[],i=g=e=e||S,3!==e.nodeType&&8!==e.nodeType&&!jd.test(n+db.event.triggered)&&(0<=n.indexOf(".")&&(k=n.split("."),n=k.shift(),k.sort()),h=0>n.indexOf(":")&&"on"+n,b=b[db.expando]?b:new db.Event(n,"object"==typeof b&&b),b.isTrigger=f?2:3,b.namespace=k.join("."),b.namespace_re=b.namespace?RegExp("(^|\\.)"+k.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=c,b.target||(b.target=e),d=null==d?[b]:db.makeArray(d,[b]),k=db.event.special[n]||{},f||!(k.trigger&&!1===k.trigger.apply(e,d)))){if(!f&&!k.noBubble&&!db.isWindow(e)){for(j=k.delegateType||n,jd.test(j+n)||(i=i.parentNode);i;i=i.parentNode)m.push(i),g=i;g===(e.ownerDocument||S)&&m.push(g.defaultView||g.parentWindow||a)}for(l=0;(i=m[l++])&&!b.isPropagationStopped();)b.type=l>1?j:k.bindType||n,(g=(db._data(i,"events")||{})[b.type]&&db._data(i,"handle"))&&g.apply(i,d),(g=h&&i[h])&&db.acceptData(i)&&g.apply&&!1===g.apply(i,d)&&b.preventDefault();if(b.type=n,!f&&!b.isDefaultPrevented()&&(!k._default||!1===k._default.apply(m.pop(),d))&&db.acceptData(e)&&h&&e[n]&&!db.isWindow(e)){(g=e[h])&&(e[h]=null),db.event.triggered=n;try{e[n]()}catch(o){}db.event.triggered=c,g&&(e[h]=g)}return b.result}},dispatch:function(a){var b,d,e,f,g,h,i;if(a=db.event.fix(a),g=[],h=$.call(arguments),b=(db._data(this,"events")||{})[a.type]||[],i=db.event.special[a.type]||{},h[0]=a,a.delegateTarget=this,!i.preDispatch||!1!==i.preDispatch.call(this,a)){for(g=db.event.handlers.call(this,a,b),b=0;(e=g[b++])&&!a.isPropagationStopped();)for(a.currentTarget=e.elem,f=0;(d=e.handlers[f++])&&!a.isImmediatePropagationStopped();)(!a.namespace_re||a.namespace_re.test(d.namespace))&&(a.handleObj=d,a.data=d.data,d=((db.event.special[d.origType]||{}).handle||d.handler).apply(e.elem,h),d!==c&&!1===(a.result=d)&&(a.preventDefault(),a.stopPropagation()));return i.postDispatch&&i.postDispatch.call(this,a),a.result}},handlers:function(a,b){var d,e,f,g,h=[],i=b.delegateCount,j=a.target;if(i&&j.nodeType&&(!a.button||"click"!==a.type))for(;j!=this;j=j.parentNode||this)if(1===j.nodeType&&(!0!==j.disabled||"click"!==a.type)){for(f=[],g=0;i>g;g++)e=b[g],d=e.selector+" ",f[d]===c&&(f[d]=e.needsContext?0<=db(d,this).index(j):db.find(d,this,null,[j]).length),f[d]&&f.push(e);f.length&&h.push({elem:j,handlers:f})}return i<b.length&&h.push({elem:this,handlers:b.slice(i)}),h},fix:function(a){var b,c,d,e,f;if(a[db.expando])return a;for(b=a.type,e=a,f=this.fixHooks[b],f||(this.fixHooks[b]=f=id.test(b)?this.mouseHooks:hd.test(b)?this.keyHooks:{}),d=f.props?this.props.concat(f.props):this.props,a=new db.Event(e),b=d.length;b--;)c=d[b],a[c]=e[c];return a.target||(a.target=e.srcElement||S),3===a.target.nodeType&&(a.target=a.target.parentNode),a.metaKey=!!a.metaKey,f.filter?f.filter(a,e):a},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:["char","charCode","key","keyCode"],filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var d,e,f=b.button,g=b.fromElement;return null==a.pageX&&null!=b.clientX&&(d=a.target.ownerDocument||S,e=d.documentElement,d=d.body,a.pageX=b.clientX+(e&&e.scrollLeft||d&&d.scrollLeft||0)-(e&&e.clientLeft||d&&d.clientLeft||0),a.pageY=b.clientY+(e&&e.scrollTop||d&&d.scrollTop||0)-(e&&e.clientTop||d&&d.clientTop||0)),!a.relatedTarget&&g&&(a.relatedTarget=g===a.target?b.toElement:g),!a.which&&f!==c&&(a.which=1&f?1:2&f?3:4&f?2:0),a}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==k()&&this.focus)try{return this.focus(),!1}catch(a){}},delegateType:"focusin"},blur:{trigger:function(){return this===k()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return db.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(a){return db.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){a.result!==c&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,c,d){a=db.extend(new db.Event,c,{type:a,isSimulated:!0,originalEvent:{}}),d?db.event.trigger(a,null,b):db.event.dispatch.call(b,a),a.isDefaultPrevented()&&c.preventDefault()}},db.removeEvent=S.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){b="on"+b,a.detachEvent&&(typeof a[b]===Q&&(a[b]=null),a.detachEvent(b,c))},db.Event=function(a,b){return this instanceof db.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||!1===a.returnValue||a.getPreventDefault&&a.getPreventDefault()?i:j):this.type=a,b&&db.extend(this,b),this.timeStamp=a&&a.timeStamp||db.now(),this[db.expando]=!0,void 0):new db.Event(a,b)},db.Event.prototype={isDefaultPrevented:j,isPropagationStopped:j,isImmediatePropagationStopped:j,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=i,a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=i,a&&(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=i,this.stopPropagation()}},db.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){db.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=a.relatedTarget,e=a.handleObj;return(!d||d!==this&&!db.contains(this,d))&&(a.type=e.origType,c=e.handler.apply(this,arguments),a.type=b),c}}}),db.support.submitBubbles||(db.event.special.submit={setup:function(){return db.nodeName(this,"form")?!1:(db.event.add(this,"click._submit keypress._submit",function(a){a=a.target,(a=db.nodeName(a,"input")||db.nodeName(a,"button")?a.form:c)&&!db._data(a,"submitBubbles")&&(db.event.add(a,"submit._submit",function(a){a._submit_bubble=!0}),db._data(a,"submitBubbles",!0))}),void 0)},postDispatch:function(a){a._submit_bubble&&(delete a._submit_bubble,this.parentNode&&!a.isTrigger&&db.event.simulate("submit",this.parentNode,a,!0))},teardown:function(){return db.nodeName(this,"form")?!1:(db.event.remove(this,"._submit"),void 0)}}),db.support.changeBubbles||(db.event.special.change={setup:function(){return gd.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(db.event.add(this,"propertychange._change",function(a){"checked"===a.originalEvent.propertyName&&(this._just_changed=!0)}),db.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1),db.event.simulate("change",this,a,!0)})),!1):(db.event.add(this,"beforeactivate._change",function(a){a=a.target,gd.test(a.nodeName)&&!db._data(a,"changeBubbles")&&(db.event.add(a,"change._change",function(a){this.parentNode&&!a.isSimulated&&!a.isTrigger&&db.event.simulate("change",this.parentNode,a,!0)}),db._data(a,"changeBubbles",!0))}),void 0)},handle:function(a){var b=a.target;return this!==b||a.isSimulated||a.isTrigger||"radio"!==b.type&&"checkbox"!==b.type?a.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return db.event.remove(this,"._change"),!gd.test(this.nodeName)}}),db.support.focusinBubbles||db.each({focus:"focusin",blur:"focusout"},function(a,b){var c=0,d=function(a){db.event.simulate(b,a.target,db.event.fix(a),!0)};db.event.special[b]={setup:function(){0===c++&&S.addEventListener(a,d,!0)},teardown:function(){0===--c&&S.removeEventListener(a,d,!0)}}}),db.fn.extend({on:function(a,b,d,e,f){var g,h;if("object"==typeof a){"string"!=typeof b&&(d=d||b,b=c);for(g in a)this.on(g,b,d,a[g],f);return this}if(null==d&&null==e?(e=b,d=b=c):null==e&&("string"==typeof b?(e=d,d=c):(e=d,d=b,b=c)),!1===e)e=j;else if(!e)return this;return 1===f&&(h=e,e=function(a){return db().off(a),h.apply(this,arguments)},e.guid=h.guid||(h.guid=db.guid++)),this.each(function(){db.event.add(this,a,e,d,b)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,b,d){var e;if(a&&a.preventDefault&&a.handleObj)return e=a.handleObj,db(a.delegateTarget).off(e.namespace?e.origType+"."+e.namespace:e.origType,e.selector,e.handler),this;if("object"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return(!1===b||"function"==typeof b)&&(d=b,b=c),!1===d&&(d=j),this.each(function(){db.event.remove(this,a,d,b)})},trigger:function(a,b){return this.each(function(){db.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];return c?db.event.trigger(a,b,c,!0):void 0}}),ld=/^.[^:#\[\.,]*$/,md=/^(?:parents|prev(?:Until|All))/,nd=db.expr.match.needsContext,od={children:!0,contents:!0,next:!0,prev:!0},db.fn.extend({find:function(a){var b,c=[],d=this,e=d.length;if("string"!=typeof a)return this.pushStack(db(a).filter(function(){for(b=0;e>b;b++)if(db.contains(d[b],this))return!0}));for(b=0;e>b;b++)db.find(a,d[b],c);return c=this.pushStack(e>1?db.unique(c):c),c.selector=this.selector?this.selector+" "+a:a,c},has:function(a){var b,c=db(a,this),d=c.length;return this.filter(function(){for(b=0;d>b;b++)if(db.contains(this,c[b]))return!0})},not:function(a){return this.pushStack(m(this,a||[],!0))},filter:function(a){return this.pushStack(m(this,a||[],!1))},is:function(a){return!!m(this,"string"==typeof a&&nd.test(a)?db(a):a||[],!1).length},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=nd.test(a)||"string"!=typeof a?db(a,b||this.context):0;e>d;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(11>c.nodeType&&(g?-1<g.index(c):1===c.nodeType&&db.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(1<f.length?db.unique(f):f)},index:function(a){return a?"string"==typeof a?db.inArray(this[0],db(a)):db.inArray(a.jquery?a[0]:a,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){var c="string"==typeof a?db(a,b):db.makeArray(a&&a.nodeType?[a]:a),c=db.merge(this.get(),c);return this.pushStack(db.unique(c))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}}),db.each({parent:function(a){return(a=a.parentNode)&&11!==a.nodeType?a:null},parents:function(a){return db.dir(a,"parentNode")},parentsUntil:function(a,b,c){return db.dir(a,"parentNode",c)},next:function(a){return l(a,"nextSibling")},prev:function(a){return l(a,"previousSibling")},nextAll:function(a){return db.dir(a,"nextSibling")},prevAll:function(a){return db.dir(a,"previousSibling")},nextUntil:function(a,b,c){return db.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return db.dir(a,"previousSibling",c)},siblings:function(a){return db.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return db.sibling(a.firstChild)},contents:function(a){return db.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:db.merge([],a.childNodes)}},function(a,b){db.fn[a]=function(c,d){var e=db.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=db.filter(d,e)),1<this.length&&(od[a]||(e=db.unique(e)),md.test(a)&&(e=e.reverse())),this.pushStack(e)}}),db.extend({filter:function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?db.find.matchesSelector(d,a)?[d]:[]:db.find.matches(a,db.grep(b,function(a){return 1===a.nodeType}))},dir:function(a,b,d){var e=[];for(a=a[b];a&&9!==a.nodeType&&(d===c||1!==a.nodeType||!db(a).is(d));)1===a.nodeType&&e.push(a),a=a[b];return e},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}}),pd="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",qd=/ jQuery\d+="(?:null|\d+)"/g,rd=RegExp("<(?:"+pd+")[\\s/>]","i"),sd=/^\s+/,td=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,ud=/<([\w:]+)/,vd=/<tbody/i,wd=/<|&#?\w+;/,xd=/<(?:script|style|link)/i,yd=/^(?:checkbox|radio)$/i,zd=/checked\s*(?:[^=]|=\s*.checked.)/i,Ad=/^$|\/(?:java|ecma)script/i,Bd=/^true\/(.*)/,Cd=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Dd={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:db.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},Ed=n(S).appendChild(S.createElement("div")),Dd.optgroup=Dd.option,Dd.tbody=Dd.tfoot=Dd.colgroup=Dd.caption=Dd.thead,Dd.th=Dd.td,db.fn.extend({text:function(a){return db.access(this,function(a){return a===c?db.text(this):this.empty().append((this[0]&&this[0].ownerDocument||S).createTextNode(a))
},null,a,arguments.length)},append:function(){return this.domManip(arguments,function(a){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&o(this,a).appendChild(a)})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=o(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=a?db.filter(a,this):this,e=0;null!=(c=d[e]);e++)!b&&1===c.nodeType&&db.cleanData(t(c)),c.parentNode&&(b&&db.contains(c.ownerDocument,c)&&r(t(c,"script")),c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++){for(1===a.nodeType&&db.cleanData(t(a,!1));a.firstChild;)a.removeChild(a.firstChild);a.options&&db.nodeName(a,"select")&&(a.options.length=0)}return this},clone:function(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return db.clone(this,a,b)})},html:function(a){return db.access(this,function(a){var b=this[0]||{},d=0,e=this.length;if(a===c)return 1===b.nodeType?b.innerHTML.replace(qd,""):c;if(!("string"!=typeof a||xd.test(a)||!db.support.htmlSerialize&&rd.test(a)||!db.support.leadingWhitespace&&sd.test(a)||Dd[(ud.exec(a)||["",""])[1].toLowerCase()])){a=a.replace(td,"<$1></$2>");try{for(;e>d;d++)b=this[d]||{},1===b.nodeType&&(db.cleanData(t(b,!1)),b.innerHTML=a);b=0}catch(f){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=db.map(this,function(a){return[a.nextSibling,a.parentNode]}),b=0;return this.domManip(arguments,function(c){var d=a[b++],e=a[b++];e&&(d&&d.parentNode!==e&&(d=this.nextSibling),db(this).remove(),e.insertBefore(c,d))},!0),b?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b,c){a=Y.apply([],a);var d,e,f,g,h=0,i=this.length,j=this,k=i-1,l=a[0],m=db.isFunction(l);if(m||!(1>=i||"string"!=typeof l||db.support.checkClone)&&zd.test(l))return this.each(function(d){var e=j.eq(d);m&&(a[0]=l.call(this,d,e.html())),e.domManip(a,b,c)});if(i&&(g=db.buildFragment(a,this[0].ownerDocument,!1,!c&&this),d=g.firstChild,1===g.childNodes.length&&(g=d),d)){for(f=db.map(t(g,"script"),p),e=f.length;i>h;h++)d=g,h!==k&&(d=db.clone(d,!0,!0),e&&db.merge(f,t(d,"script"))),b.call(this[h],d,h);if(e)for(g=f[f.length-1].ownerDocument,db.map(f,q),h=0;e>h;h++)d=f[h],Ad.test(d.type||"")&&!db._data(d,"globalEval")&&db.contains(g,d)&&(d.src?db._evalUrl(d.src):db.globalEval((d.text||d.textContent||d.innerHTML||"").replace(Cd,"")));g=d=null}return this}}),db.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){db.fn[a]=function(a){for(var c=0,d=[],e=db(a),f=e.length-1;f>=c;c++)a=c===f?this:this.clone(!0),db(e[c])[b](a),Z.apply(d,a.get());return this.pushStack(d)}}),db.extend({clone:function(a,b,c){var d,e,f,g,h,j,k,l,m,i=db.contains(a.ownerDocument,a);if(db.support.html5Clone||db.isXMLDoc(a)||!rd.test("<"+a.nodeName+">")?f=a.cloneNode(!0):(Ed.innerHTML=a.outerHTML,Ed.removeChild(f=Ed.firstChild)),!(db.support.noCloneEvent&&db.support.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||db.isXMLDoc(a)))for(d=t(f),h=t(a),g=0;null!=(e=h[g]);++g)if(d[g]&&(j=d[g],k=void 0,l=void 0,m=void 0,1===j.nodeType)){if(k=j.nodeName.toLowerCase(),!db.support.noCloneEvent&&j[db.expando]){m=db._data(j);for(l in m.events)db.removeEvent(j,l,m.handle);j.removeAttribute(db.expando)}"script"===k&&j.text!==e.text?(p(j).text=e.text,q(j)):"object"===k?(j.parentNode&&(j.outerHTML=e.outerHTML),db.support.html5Clone&&e.innerHTML&&!db.trim(j.innerHTML)&&(j.innerHTML=e.innerHTML)):"input"===k&&yd.test(e.type)?(j.defaultChecked=j.checked=e.checked,j.value!==e.value&&(j.value=e.value)):"option"===k?j.defaultSelected=j.selected=e.defaultSelected:("input"===k||"textarea"===k)&&(j.defaultValue=e.defaultValue)}if(b)if(c)for(h=h||t(a),d=d||t(f),g=0;null!=(e=h[g]);g++)s(e,d[g]);else s(a,f);return d=t(f,"script"),0<d.length&&r(d,!i&&t(a,"script")),f},buildFragment:function(a,b,c,d){for(var e,f,g,h,i,j,k=a.length,l=n(b),m=[],o=0;k>o;o++)if((f=a[o])||0===f)if("object"===db.type(f))db.merge(m,f.nodeType?[f]:f);else if(wd.test(f)){for(g=g||l.appendChild(b.createElement("div")),h=(ud.exec(f)||["",""])[1].toLowerCase(),j=Dd[h]||Dd._default,g.innerHTML=j[1]+f.replace(td,"<$1></$2>")+j[2],e=j[0];e--;)g=g.lastChild;if(!db.support.leadingWhitespace&&sd.test(f)&&m.push(b.createTextNode(sd.exec(f)[0])),!db.support.tbody)for(e=(f="table"!==h||vd.test(f)?"<table>"!==j[1]||vd.test(f)?0:g:g.firstChild)&&f.childNodes.length;e--;)db.nodeName(i=f.childNodes[e],"tbody")&&!i.childNodes.length&&f.removeChild(i);for(db.merge(m,g.childNodes),g.textContent="";g.firstChild;)g.removeChild(g.firstChild);g=l.lastChild}else m.push(b.createTextNode(f));for(g&&l.removeChild(g),db.support.appendChecked||db.grep(t(m,"input"),u),o=0;f=m[o++];)if((!d||-1===db.inArray(f,d))&&(a=db.contains(f.ownerDocument,f),g=t(l.appendChild(f),"script"),a&&r(g),c))for(e=0;f=g[e++];)Ad.test(f.type||"")&&c.push(f);return l},cleanData:function(a,b){for(var c,d,e,f,g=0,h=db.expando,i=db.cache,j=db.support.deleteExpando,k=db.event.special;null!=(c=a[g]);g++)if((b||db.acceptData(c))&&(f=(e=c[h])&&i[e])){if(f.events)for(d in f.events)k[d]?db.event.remove(c,d):db.removeEvent(c,d,f.handle);i[e]&&(delete i[e],j?delete c[h]:typeof c.removeAttribute!==Q?c.removeAttribute(h):c[h]=null,X.push(e))}},_evalUrl:function(a){return db.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}}),db.fn.extend({wrapAll:function(a){if(db.isFunction(a))return this.each(function(b){db(this).wrapAll(a.call(this,b))});if(this[0]){var b=db(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){for(var a=this;a.firstChild&&1===a.firstChild.nodeType;)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return db.isFunction(a)?this.each(function(b){db(this).wrapInner(a.call(this,b))}):this.each(function(){var b=db(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=db.isFunction(a);return this.each(function(c){db(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){db.nodeName(this,"body")||db(this).replaceWith(this.childNodes)}).end()}}),Id=/alpha\([^)]*\)/i,Jd=/opacity\s*=\s*([^)]*)/,Kd=/^(top|right|bottom|left)$/,Ld=/^(none|table(?!-c[ea]).+)/,Md=/^margin/,Nd=RegExp("^("+eb+")(.*)$","i"),Od=RegExp("^("+eb+")(?!px)[a-z%]+$","i"),Pd=RegExp("^([+-])=("+eb+")","i"),Qd={BODY:"block"},Rd={position:"absolute",visibility:"hidden",display:"block"},Sd={letterSpacing:0,fontWeight:400},Td=["Top","Right","Bottom","Left"],Ud=["Webkit","O","Moz","ms"],db.fn.extend({css:function(a,b){return db.access(this,function(a,b,d){var e,f={},g=0;if(db.isArray(b)){for(e=Gd(a),d=b.length;d>g;g++)f[b[g]]=db.css(a,b[g],!1,e);return f}return d!==c?db.style(a,b,d):db.css(a,b)},a,b,1<arguments.length)},show:function(){return x(this,!0)},hide:function(){return x(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){w(this)?db(this).show():db(this).hide()})}}),db.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=Hd(a,"opacity");return""===c?"1":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":db.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,b,d,e){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var f,g,h,i=db.camelCase(b),j=a.style;if(b=db.cssProps[i]||(db.cssProps[i]=v(j,i)),h=db.cssHooks[b]||db.cssHooks[i],d===c)return h&&"get"in h&&(f=h.get(a,!1,e))!==c?f:j[b];if(g=typeof d,"string"===g&&(f=Pd.exec(d))&&(d=(f[1]+1)*f[2]+parseFloat(db.css(a,b)),g="number"),!(null==d||"number"===g&&isNaN(d)||("number"===g&&!db.cssNumber[i]&&(d+="px"),!db.support.clearCloneStyle&&""===d&&0===b.indexOf("background")&&(j[b]="inherit"),h&&"set"in h&&(d=h.set(a,d,e))===c)))try{j[b]=d}catch(k){}}},css:function(a,b,d,e){var f,g;return g=db.camelCase(b),b=db.cssProps[g]||(db.cssProps[g]=v(a.style,g)),(g=db.cssHooks[b]||db.cssHooks[g])&&"get"in g&&(f=g.get(a,!0,d)),f===c&&(f=Hd(a,b,e)),"normal"===f&&b in Sd&&(f=Sd[b]),""===d||d?(a=parseFloat(f),!0===d||db.isNumeric(a)?a||0:f):f}}),a.getComputedStyle?(Gd=function(b){return a.getComputedStyle(b,null)},Hd=function(a,b,d){var e,f=(d=d||Gd(a))?d.getPropertyValue(b)||d[b]:c,g=a.style;return d&&(""===f&&!db.contains(a.ownerDocument,a)&&(f=db.style(a,b)),Od.test(f)&&Md.test(b)&&(a=g.width,b=g.minWidth,e=g.maxWidth,g.minWidth=g.maxWidth=g.width=f,f=d.width,g.width=a,g.minWidth=b,g.maxWidth=e)),f}):S.documentElement.currentStyle&&(Gd=function(a){return a.currentStyle},Hd=function(a,b,d){var e,f,g=(d=d||Gd(a))?d[b]:c,h=a.style;return null==g&&h&&h[b]&&(g=h[b]),Od.test(g)&&!Kd.test(b)&&(d=h.left,(f=(e=a.runtimeStyle)&&e.left)&&(e.left=a.currentStyle.left),h.left="fontSize"===b?"1em":g,g=h.pixelLeft+"px",h.left=d,f&&(e.left=f)),""===g?"auto":g}),db.each(["height","width"],function(a,b){db.cssHooks[b]={get:function(a,c,d){return c?0===a.offsetWidth&&Ld.test(db.css(a,"display"))?db.swap(a,Rd,function(){return A(a,b,d)}):A(a,b,d):void 0},set:function(a,c,d){var e=d&&Gd(a);return y(a,c,d?z(a,b,d,db.support.boxSizing&&"border-box"===db.css(a,"boxSizing",!1,e),e):0)}}}),db.support.opacity||(db.cssHooks.opacity={get:function(a,b){return Jd.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=db.isNumeric(b)?"alpha(opacity="+100*b+")":"",f=d&&d.filter||c.filter||"";c.zoom=1,(b>=1||""===b)&&""===db.trim(f.replace(Id,""))&&c.removeAttribute&&(c.removeAttribute("filter"),""===b||d&&!d.filter)||(c.filter=Id.test(f)?f.replace(Id,e):f+" "+e)}}),db(function(){db.support.reliableMarginRight||(db.cssHooks.marginRight={get:function(a,b){return b?db.swap(a,{display:"inline-block"},Hd,[a,"marginRight"]):void 0}}),!db.support.pixelPosition&&db.fn.position&&db.each(["top","left"],function(a,b){db.cssHooks[b]={get:function(a,c){return c?(c=Hd(a,b),Od.test(c)?db(a).position()[b]+"px":c):void 0}}})}),db.expr&&db.expr.filters&&(db.expr.filters.hidden=function(a){return 0>=a.offsetWidth&&0>=a.offsetHeight||!db.support.reliableHiddenOffsets&&"none"===(a.style&&a.style.display||db.css(a,"display"))},db.expr.filters.visible=function(a){return!db.expr.filters.hidden(a)}),db.each({margin:"",padding:"",border:"Width"},function(a,b){db.cssHooks[a+b]={expand:function(c){var d=0,e={};for(c="string"==typeof c?c.split(" "):[c];4>d;d++)e[a+Td[d]+b]=c[d]||c[d-2]||c[0];return e}},Md.test(a)||(db.cssHooks[a+b].set=y)}),Vd=/%20/g,Wd=/\[\]$/,Xd=/\r?\n/g,Yd=/^(?:submit|button|image|reset|file)$/i,Zd=/^(?:input|select|textarea|keygen)/i,db.fn.extend({serialize:function(){return db.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=db.prop(this,"elements");return a?db.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!db(this).is(":disabled")&&Zd.test(this.nodeName)&&!Yd.test(a)&&(this.checked||!yd.test(a))}).map(function(a,b){var c=db(this).val();return null==c?null:db.isArray(c)?db.map(c,function(a){return{name:b.name,value:a.replace(Xd,"\r\n")}}):{name:b.name,value:c.replace(Xd,"\r\n")}}).get()}}),db.param=function(a,b){var d,e=[],f=function(a,b){b=db.isFunction(b)?b():null==b?"":b,e[e.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(b===c&&(b=db.ajaxSettings&&db.ajaxSettings.traditional),db.isArray(a)||a.jquery&&!db.isPlainObject(a))db.each(a,function(){f(this.name,this.value)});else for(d in a)D(d,a[d],b,f);return e.join("&").replace(Vd,"+")},db.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){db.fn[b]=function(a,c){return 0<arguments.length?this.on(b,null,a,c):this.trigger(b)}}),db.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}}),ae=db.now(),be=/\?/,ce=/#.*$/,de=/([?&])_=[^&]*/,ee=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,fe=/^(?:GET|HEAD)$/,ge=/^\/\//,he=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,ie=db.fn.load,je={},ke={},le="*/".concat("*");try{_d=R.href}catch(me){_d=S.createElement("a"),_d.href="",_d=_d.href}$d=he.exec(_d.toLowerCase())||[],db.fn.load=function(a,b,d){if("string"!=typeof a&&ie)return ie.apply(this,arguments);var e,f,g,h=this,i=a.indexOf(" ");return i>=0&&(e=a.slice(i,a.length),a=a.slice(0,i)),db.isFunction(b)?(d=b,b=c):b&&"object"==typeof b&&(g="POST"),0<h.length&&db.ajax({url:a,type:g,dataType:"html",data:b}).done(function(a){f=arguments,h.html(e?db("<div>").append(db.parseHTML(a)).find(e):a)}).complete(d&&function(a,b){h.each(d,f||[a.responseText,b,a])}),this},db.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){db.fn[b]=function(a){return this.on(b,a)}}),db.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:_d,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test($d[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":le,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":db.parseJSON,"text xml":db.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?G(G(a,db.ajaxSettings),b):G(db.ajaxSettings,a)},ajaxPrefilter:E(je),ajaxTransport:E(ke),ajax:function(a,b){function d(a,b,d,e){var f,l,s,x,y,z,A,v,B,C,D,E,F,t=b;if(2!==u){if(u=2,i&&clearTimeout(i),k=c,h=e||"",w.readyState=a>0?4:0,e=a>=200&&300>a||304===a,d){for(s=m,v=w,B=s.contents,C=s.dataTypes;"*"===C[0];)C.shift(),y===c&&(y=s.mimeType||v.getResponseHeader("Content-Type"));if(y)for(A in B)if(B[A]&&B[A].test(y)){C.unshift(A);break}if(C[0]in d)z=C[0];else{for(A in d){if(!C[0]||s.converters[A+" "+C[0]]){z=A;break}x||(x=A)}z=z||x}z?(z!==C[0]&&C.unshift(z),s=d[z]):s=void 0}a:{if(d=m,x=s,y=w,z=e,v={},B=d.dataTypes.slice(),B[1])for(E in d.converters)v[E.toLowerCase()]=d.converters[E];for(A=B.shift();A;)if(d.responseFields[A]&&(y[d.responseFields[A]]=x),!F&&z&&d.dataFilter&&(x=d.dataFilter(x,d.dataType)),F=A,A=B.shift())if("*"===A)A=F;else if("*"!==F&&F!==A){if(E=v[F+" "+A]||v["* "+A],!E)for(D in v)if(s=D.split(" "),s[1]===A&&(E=v[F+" "+s[0]]||v["* "+s[0]])){!0===E?E=v[D]:!0!==v[D]&&(A=s[0],B.unshift(s[1]));break}if(!0!==E)if(E&&d["throws"])x=E(x);else try{x=E(x)}catch(G){s={state:"parsererror",error:E?G:"No conversion from "+F+" to "+A};break a}}s={state:"success",data:x}}e?(m.ifModified&&((t=w.getResponseHeader("Last-Modified"))&&(db.lastModified[g]=t),(t=w.getResponseHeader("etag"))&&(db.etag[g]=t)),204===a||"HEAD"===m.type?t="nocontent":304===a?t="notmodified":(t=s.state,f=s.data,l=s.error,e=!l)):(l=t,(a||!t)&&(t="error",0>a&&(a=0))),w.status=a,w.statusText=(b||t)+"",e?p.resolveWith(n,[f,t,w]):p.rejectWith(n,[w,t,l]),w.statusCode(r),r=c,j&&o.trigger(e?"ajaxSuccess":"ajaxError",[w,m,e?f:l]),q.fireWith(n,[w,t]),j&&(o.trigger("ajaxComplete",[w,m]),--db.active||db.event.trigger("ajaxStop"))}}"object"==typeof a&&(b=a,a=c),b=b||{};var e,f,g,h,i,j,k,l,m=db.ajaxSetup({},b),n=m.context||m,o=m.context&&(n.nodeType||n.jquery)?db(n):db.event,p=db.Deferred(),q=db.Callbacks("once memory"),r=m.statusCode||{},s={},t={},u=0,v="canceled",w={readyState:0,getResponseHeader:function(a){var b;if(2===u){if(!l)for(l={};b=ee.exec(h);)l[b[1].toLowerCase()]=b[2];b=l[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===u?h:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return u||(a=t[c]=t[c]||a,s[a]=b),this},overrideMimeType:function(a){return u||(m.mimeType=a),this},statusCode:function(a){var b;if(a)if(2>u)for(b in a)r[b]=[r[b],a[b]];else w.always(a[w.status]);return this},abort:function(a){return a=a||v,k&&k.abort(a),d(0,a),this}};if(p.promise(w).complete=q.add,w.success=w.done,w.error=w.fail,m.url=((a||m.url||_d)+"").replace(ce,"").replace(ge,$d[1]+"//"),m.type=b.method||b.type||m.method||m.type,m.dataTypes=db.trim(m.dataType||"*").toLowerCase().match(fb)||[""],null==m.crossDomain&&(e=he.exec(m.url.toLowerCase()),m.crossDomain=!(!e||e[1]===$d[1]&&e[2]===$d[2]&&(e[3]||("http:"===e[1]?"80":"443"))===($d[3]||("http:"===$d[1]?"80":"443")))),m.data&&m.processData&&"string"!=typeof m.data&&(m.data=db.param(m.data,m.traditional)),F(je,m,b,w),2===u)return w;(j=m.global)&&0===db.active++&&db.event.trigger("ajaxStart"),m.type=m.type.toUpperCase(),m.hasContent=!fe.test(m.type),g=m.url,m.hasContent||(m.data&&(g=m.url+=(be.test(g)?"&":"?")+m.data,delete m.data),!1===m.cache&&(m.url=de.test(g)?g.replace(de,"$1_="+ae++):g+(be.test(g)?"&":"?")+"_="+ae++)),m.ifModified&&(db.lastModified[g]&&w.setRequestHeader("If-Modified-Since",db.lastModified[g]),db.etag[g]&&w.setRequestHeader("If-None-Match",db.etag[g])),(m.data&&m.hasContent&&!1!==m.contentType||b.contentType)&&w.setRequestHeader("Content-Type",m.contentType),w.setRequestHeader("Accept",m.dataTypes[0]&&m.accepts[m.dataTypes[0]]?m.accepts[m.dataTypes[0]]+("*"!==m.dataTypes[0]?", "+le+"; q=0.01":""):m.accepts["*"]);for(f in m.headers)w.setRequestHeader(f,m.headers[f]);if(m.beforeSend&&(!1===m.beforeSend.call(n,w,m)||2===u))return w.abort();v="abort";for(f in{success:1,error:1,complete:1})w[f](m[f]);if(k=F(ke,m,b,w)){w.readyState=1,j&&o.trigger("ajaxSend",[w,m]),m.async&&0<m.timeout&&(i=setTimeout(function(){w.abort("timeout")},m.timeout));try{u=1,k.send(s,d)}catch(x){if(!(2>u))throw x;d(-1,x)}}else d(-1,"No Transport");return w},getJSON:function(a,b,c){return db.get(a,b,c,"json")},getScript:function(a,b){return db.get(a,c,b,"script")}}),db.each(["get","post"],function(a,b){db[b]=function(a,d,e,f){return db.isFunction(d)&&(f=f||e,e=d,d=c),db.ajax({url:a,type:b,dataType:f,data:d,success:e})}}),db.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){return db.globalEval(a),a}}}),db.ajaxPrefilter("script",function(a){a.cache===c&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),db.ajaxTransport("script",function(a){if(a.crossDomain){var b,d=S.head||db("head")[0]||S.documentElement;return{send:function(c,e){b=S.createElement("script"),b.async=!0,a.scriptCharset&&(b.charset=a.scriptCharset),b.src=a.url,b.onload=b.onreadystatechange=function(a,c){(c||!b.readyState||/loaded|complete/.test(b.readyState))&&(b.onload=b.onreadystatechange=null,b.parentNode&&b.parentNode.removeChild(b),b=null,c||e(200,"success"))},d.insertBefore(b,d.firstChild)},abort:function(){b&&b.onload(c,!0)}}}}),ne=[],oe=/(=)\?(?=&|$)|\?\?/,db.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=ne.pop()||db.expando+"_"+ae++;return this[a]=!0,a}}),db.ajaxPrefilter("json jsonp",function(b,d,e){var f,g,h,i=!1!==b.jsonp&&(oe.test(b.url)?"url":"string"==typeof b.data&&!(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&oe.test(b.data)&&"data");return i||"jsonp"===b.dataTypes[0]?(f=b.jsonpCallback=db.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,i?b[i]=b[i].replace(oe,"$1"+f):!1!==b.jsonp&&(b.url+=(be.test(b.url)?"&":"?")+b.jsonp+"="+f),b.converters["script json"]=function(){return h||db.error(f+" was not called"),h[0]},b.dataTypes[0]="json",g=a[f],a[f]=function(){h=arguments},e.always(function(){a[f]=g,b[f]&&(b.jsonpCallback=d.jsonpCallback,ne.push(f)),h&&db.isFunction(g)&&g(h[0]),h=g=c}),"script"):void 0}),re=0,se=a.ActiveXObject&&function(){for(var a in pe)pe[a](c,!0)},db.ajaxSettings.xhr=a.ActiveXObject?function(){var b;if(!(b=!this.isLocal&&H()))a:{try{b=new a.ActiveXObject("Microsoft.XMLHTTP");break a}catch(c){}b=void 0}return b}:H,qe=db.ajaxSettings.xhr(),db.support.cors=!!qe&&"withCredentials"in qe,(qe=db.support.ajax=!!qe)&&db.ajaxTransport(function(b){if(!b.crossDomain||db.support.cors){var d;return{send:function(e,f){var g,h,i=b.xhr();if(b.username?i.open(b.type,b.url,b.async,b.username,b.password):i.open(b.type,b.url,b.async),b.xhrFields)for(h in b.xhrFields)i[h]=b.xhrFields[h];b.mimeType&&i.overrideMimeType&&i.overrideMimeType(b.mimeType),!b.crossDomain&&!e["X-Requested-With"]&&(e["X-Requested-With"]="XMLHttpRequest");try{for(h in e)i.setRequestHeader(h,e[h])}catch(j){}i.send(b.hasContent&&b.data||null),d=function(a,e){var h,j,k,l;try{if(d&&(e||4===i.readyState))if(d=c,g&&(i.onreadystatechange=db.noop,se&&delete pe[g]),e)4!==i.readyState&&i.abort();else{l={},h=i.status,j=i.getAllResponseHeaders(),"string"==typeof i.responseText&&(l.text=i.responseText);try{k=i.statusText}catch(m){k=""}h||!b.isLocal||b.crossDomain?1223===h&&(h=204):h=l.text?200:404}}catch(n){e||f(-1,n)}l&&f(h,k,l,j)},b.async?4===i.readyState?setTimeout(d):(g=++re,se&&(pe||(pe={},db(a).unload(se)),pe[g]=d),i.onreadystatechange=d):d()},abort:function(){d&&d(c,!0)}}}}),ve=/^(?:toggle|show|hide)$/,we=RegExp("^(?:([+-])=|)("+eb+")([a-z%]*)$","i"),xe=/queueHooks$/,ye=[function(a,b,c){var d,e,f,g,h,i=this,j={},k=a.style,l=a.nodeType&&w(a),m=db._data(a,"fxshow");c.queue||(g=db._queueHooks(a,"fx"),null==g.unqueued&&(g.unqueued=0,h=g.empty.fire,g.empty.fire=function(){g.unqueued||h()}),g.unqueued++,i.always(function(){i.always(function(){g.unqueued--,db.queue(a,"fx").length||g.empty.fire()})})),1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[k.overflow,k.overflowX,k.overflowY],"inline"===db.css(a,"display")&&"none"===db.css(a,"float")&&(db.support.inlineBlockNeedsLayout&&"inline"!==B(a.nodeName)?k.zoom=1:k.display="inline-block")),c.overflow&&(k.overflow="hidden",db.support.shrinkWrapBlocks||i.always(function(){k.overflow=c.overflow[0],k.overflowX=c.overflow[1],k.overflowY=c.overflow[2]}));for(d in b)e=b[d],ve.exec(e)&&(delete b[d],f=f||"toggle"===e,e!==(l?"hide":"show"))&&(j[d]=m&&m[d]||db.style(a,d));if(!db.isEmptyObject(j))for(d in m?"hidden"in m&&(l=m.hidden):m=db._data(a,"fxshow",{}),f&&(m.hidden=!l),l?db(a).show():i.done(function(){db(a).hide()}),i.done(function(){var b;db._removeData(a,"fxshow");for(b in j)db.style(a,b,j[b])}),j)b=J(l?m[d]:0,d,i),d in m||(m[d]=b.start,l&&(b.end=b.start,b.start="width"===d||"height"===d?1:0))}],ze={"*":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=we.exec(b),f=e&&e[3]||(db.cssNumber[a]?"":"px"),g=(db.cssNumber[a]||"px"!==f&&+d)&&we.exec(db.css(c.elem,a)),h=1,i=20;if(g&&g[3]!==f){f=f||g[3],e=e||[],g=+d||1;do h=h||".5",g/=h,db.style(c.elem,a,g+f);while(h!==(h=c.cur()/d)&&1!==h&&--i)}return e&&(g=c.start=+g||+d||0,c.unit=f,c.end=e[1]?g+(e[1]+1)*e[2]:+e[2]),c}]},db.Animation=db.extend(K,{tweener:function(a,b){db.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;e>d;d++)c=a[d],ze[c]=ze[c]||[],ze[c].unshift(b)},prefilter:function(a,b){b?ye.unshift(a):ye.push(a)}}),db.Tween=L,L.prototype={constructor:L,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(db.cssNumber[c]?"":"px")},cur:function(){var a=L.propHooks[this.prop];return a&&a.get?a.get(this):L.propHooks._default.get(this)},run:function(a){var b,c=L.propHooks[this.prop];return this.pos=b=this.options.duration?db.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):L.propHooks._default.set(this),this}},L.prototype.init.prototype=L.prototype,L.propHooks={_default:{get:function(a){return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(a=db.css(a.elem,a.prop,""),a&&"auto"!==a?a:0):a.elem[a.prop]},set:function(a){db.fx.step[a.prop]?db.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[db.cssProps[a.prop]]||db.cssHooks[a.prop])?db.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}},L.propHooks.scrollTop=L.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},db.each(["toggle","show","hide"],function(a,b){var c=db.fn[b];db.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(M(b,!0),a,d,e)}}),db.fn.extend({fadeTo:function(a,b,c,d){return this.filter(w).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=db.isEmptyObject(a),f=db.speed(b,c,d);return b=function(){var b=K(this,db.extend({},a),f);(e||db._data(this,"finish"))&&b.stop(!0)},b.finish=b,e||!1===f.queue?this.each(b):this.queue(f.queue,b)},stop:function(a,b,d){var e=function(a){var b=a.stop;delete a.stop,b(d)};return"string"!=typeof a&&(d=b,b=a,a=c),b&&!1!==a&&this.queue(a||"fx",[]),this.each(function(){var b=!0,c=null!=a&&a+"queueHooks",f=db.timers,g=db._data(this);if(c)g[c]&&g[c].stop&&e(g[c]);else for(c in g)g[c]&&g[c].stop&&xe.test(c)&&e(g[c]);for(c=f.length;c--;)f[c].elem!==this||null!=a&&f[c].queue!==a||(f[c].anim.stop(d),b=!1,f.splice(c,1));(b||!d)&&db.dequeue(this,a)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var c=db._data(this),d=c[a+"queue"],b=c[a+"queueHooks"],e=db.timers,f=d?d.length:0;for(c.finish=!0,db.queue(this,a,[]),b&&b.stop&&b.stop.call(this,!0),b=e.length;b--;)e[b].elem===this&&e[b].queue===a&&(e[b].anim.stop(!0),e.splice(b,1));for(b=0;f>b;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),db.each({slideDown:M("show"),slideUp:M("hide"),slideToggle:M("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){db.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),db.speed=function(a,b,c){var d=a&&"object"==typeof a?db.extend({},a):{complete:c||!c&&b||db.isFunction(a)&&a,duration:a,easing:c&&b||b&&!db.isFunction(b)&&b};return d.duration=db.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in db.fx.speeds?db.fx.speeds[d.duration]:db.fx.speeds._default,(null==d.queue||!0===d.queue)&&(d.queue="fx"),d.old=d.complete,d.complete=function(){db.isFunction(d.old)&&d.old.call(this),d.queue&&db.dequeue(this,d.queue)},d},db.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}},db.timers=[],db.fx=L.prototype.init,db.fx.tick=function(){var a,b=db.timers,d=0;for(te=db.now();d<b.length;d++)a=b[d],!a()&&b[d]===a&&b.splice(d--,1);b.length||db.fx.stop(),te=c},db.fx.timer=function(a){a()&&db.timers.push(a)&&db.fx.start()},db.fx.interval=13,db.fx.start=function(){ue||(ue=setInterval(db.fx.tick,db.fx.interval))},db.fx.stop=function(){clearInterval(ue),ue=null},db.fx.speeds={slow:600,fast:200,_default:400},db.fx.step={},db.expr&&db.expr.filters&&(db.expr.filters.animated=function(a){return db.grep(db.timers,function(b){return a===b.elem}).length}),db.fn.offset=function(a){if(arguments.length)return a===c?this:this.each(function(b){db.offset.setOffset(this,a,b)});var b,d,e={top:0,left:0},f=(d=this[0])&&d.ownerDocument;return f?(b=f.documentElement,db.contains(b,d)?(typeof d.getBoundingClientRect!==Q&&(e=d.getBoundingClientRect()),d=N(f),{top:e.top+(d.pageYOffset||b.scrollTop)-(b.clientTop||0),left:e.left+(d.pageXOffset||b.scrollLeft)-(b.clientLeft||0)}):e):void 0},db.offset={setOffset:function(a,b,c){var e,f,g,h,i,j,d=db.css(a,"position");"static"===d&&(a.style.position="relative"),e=db(a),f=e.offset(),g=db.css(a,"top"),h=db.css(a,"left"),i={},j={},("absolute"===d||"fixed"===d)&&-1<db.inArray("auto",[g,h])?(j=e.position(),d=j.top,h=j.left):(d=parseFloat(g)||0,h=parseFloat(h)||0),db.isFunction(b)&&(b=b.call(a,c,f)),null!=b.top&&(i.top=b.top-f.top+d),null!=b.left&&(i.left=b.left-f.left+h),"using"in b?b.using.call(a,i):e.css(i)}},db.fn.extend({position:function(){if(this[0]){var a,b,c={top:0,left:0},d=this[0];return"fixed"===db.css(d,"position")?b=d.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),db.nodeName(a[0],"html")||(c=a.offset()),c.top+=db.css(a[0],"borderTopWidth",!0),c.left+=db.css(a[0],"borderLeftWidth",!0)),{top:b.top-c.top-db.css(d,"marginTop",!0),left:b.left-c.left-db.css(d,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||T;a&&!db.nodeName(a,"html")&&"static"===db.css(a,"position");)a=a.offsetParent;return a||T})}}),db.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,b){var d=/Y/.test(b);db.fn[a]=function(e){return db.access(this,function(a,e,f){var g=N(a);return f===c?g?b in g?g[b]:g.document.documentElement[e]:a[e]:(g?g.scrollTo(d?db(g).scrollLeft():f,d?f:db(g).scrollTop()):a[e]=f,void 0)},a,e,arguments.length,null)}}),db.each({Height:"height",Width:"width"},function(a,b){db.each({padding:"inner"+a,content:b,"":"outer"+a},function(d,e){db.fn[e]=function(e,f){var g=arguments.length&&(d||"boolean"!=typeof e),h=d||(!0===e||!0===f?"margin":"border");return db.access(this,function(b,d,e){return db.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(d=b.documentElement,Math.max(b.body["scroll"+a],d["scroll"+a],b.body["offset"+a],d["offset"+a],d["client"+a])):e===c?db.css(b,d,h):db.style(b,d,e,h)},b,g?e:c,g,null)}})}),db.fn.size=function(){return this.length},db.fn.andSelf=db.fn.addBack,b.jQuery=db}(window,ChemDoodle.lib),function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?module.exports=a:a(ChemDoodle.lib.jQuery)}(function(a){function b(b){var d=b||window.event,e=f.call(arguments,1),j=0,k=0,l=0,m=0;return b=a.event.fix(d),b.type="mousewheel","detail"in d&&(l=-1*d.detail),"wheelDelta"in d&&(l=d.wheelDelta),"wheelDeltaY"in d&&(l=d.wheelDeltaY),"wheelDeltaX"in d&&(k=-1*d.wheelDeltaX),"axis"in d&&d.axis===d.HORIZONTAL_AXIS&&(k=-1*l,l=0),j=0===l?k:l,"deltaY"in d&&(j=l=-1*d.deltaY),"deltaX"in d&&(k=d.deltaX,0===l&&(j=-1*k)),0!==l||0!==k?(1===d.deltaMode?(d=a.data(this,"mousewheel-line-height"),j*=d,l*=d,k*=d):2===d.deltaMode&&(d=a.data(this,"mousewheel-page-height"),j*=d,l*=d,k*=d),m=Math.max(Math.abs(l),Math.abs(k)),(!i||i>m)&&(i=m,120===i&&(g=!0,i/=40)),g&&(j/=40,k/=40,l/=40),j=Math[j>=1?"floor":"ceil"](j/i),k=Math[k>=1?"floor":"ceil"](k/i),l=Math[l>=1?"floor":"ceil"](l/i),b.deltaX=k,b.deltaY=l,b.deltaFactor=i,b.deltaMode=0,e.unshift(b,j,k,l),h&&clearTimeout(h),h=setTimeout(c,200),(a.event.dispatch||a.event.handle).apply(this,e)):void 0}function c(){g=i=null}var g,h,i,j,k,d=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],e="onwheel"in document||9<=document.documentMode?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],f=Array.prototype.slice;if(a.event.fixHooks)for(j=d.length;j;)a.event.fixHooks[d[--j]]=a.event.mouseHooks;k=a.event.special.mousewheel={version:"3.1.8",setup:function(){if(this.addEventListener)for(var c=e.length;c;)this.addEventListener(e[--c],b,!1);else this.onmousewheel=b;a.data(this,"mousewheel-line-height",k.getLineHeight(this)),a.data(this,"mousewheel-page-height",k.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var a=e.length;a;)this.removeEventListener(e[--a],b,!1);else this.onmousewheel=null},getLineHeight:function(b){return parseInt(a(b)["offsetParent"in a.fn?"offsetParent":"parent"]().css("fontSize"),10)},getPageHeight:function(b){return a(b).height()}},a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})}),function(a,b){"object"==typeof exports?module.exports=b(global):"function"==typeof define&&define.amd?define([],function(){return b(a)
}):b(a)}(ChemDoodle.lib,function(a){function b(a){return g=a}function c(){return g="undefined"!=typeof Float32Array?Float32Array:Array}var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,d={};return"undefined"!=typeof Float32Array?(e=new Float32Array(1),f=new Int32Array(e.buffer),d.invsqrt=function(a){e[0]=a,f[0]=1597463007-(f[0]>>1);var b=e[0];return b*(1.5-.5*a*b*b)}):d.invsqrt=function(a){return 1/Math.sqrt(a)},g=null,c(),h={create:function(a){var b=new g(3);return a?(b[0]=a[0],b[1]=a[1],b[2]=a[2]):b[0]=b[1]=b[2]=0,b},createFrom:function(a,b,c){var d=new g(3);return d[0]=a,d[1]=b,d[2]=c,d},set:function(a,b){return b[0]=a[0],b[1]=a[1],b[2]=a[2],b},equal:function(a,b){return a===b||1e-6>Math.abs(a[0]-b[0])&&1e-6>Math.abs(a[1]-b[1])&&1e-6>Math.abs(a[2]-b[2])},add:function(a,b,c){return c&&a!==c?(c[0]=a[0]+b[0],c[1]=a[1]+b[1],c[2]=a[2]+b[2],c):(a[0]+=b[0],a[1]+=b[1],a[2]+=b[2],a)},subtract:function(a,b,c){return c&&a!==c?(c[0]=a[0]-b[0],c[1]=a[1]-b[1],c[2]=a[2]-b[2],c):(a[0]-=b[0],a[1]-=b[1],a[2]-=b[2],a)},multiply:function(a,b,c){return c&&a!==c?(c[0]=a[0]*b[0],c[1]=a[1]*b[1],c[2]=a[2]*b[2],c):(a[0]*=b[0],a[1]*=b[1],a[2]*=b[2],a)},negate:function(a,b){return b||(b=a),b[0]=-a[0],b[1]=-a[1],b[2]=-a[2],b},scale:function(a,b,c){return c&&a!==c?(c[0]=a[0]*b,c[1]=a[1]*b,c[2]=a[2]*b,c):(a[0]*=b,a[1]*=b,a[2]*=b,a)},normalize:function(a,b){b||(b=a);var c=a[0],d=a[1],e=a[2],f=Math.sqrt(c*c+d*d+e*e);return f?1===f?(b[0]=c,b[1]=d,b[2]=e,b):(f=1/f,b[0]=c*f,b[1]=d*f,b[2]=e*f,b):(b[0]=0,b[1]=0,b[2]=0,b)},cross:function(a,b,c){var d,e,f,g;return c||(c=a),d=a[0],e=a[1],a=a[2],f=b[0],g=b[1],b=b[2],c[0]=e*b-a*g,c[1]=a*f-d*b,c[2]=d*g-e*f,c},length:function(a){var b=a[0],c=a[1];return a=a[2],Math.sqrt(b*b+c*c+a*a)},squaredLength:function(a){var b=a[0],c=a[1];return a=a[2],b*b+c*c+a*a},dot:function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]},direction:function(a,b,c){c||(c=a);var d=a[0]-b[0],e=a[1]-b[1];return a=a[2]-b[2],(b=Math.sqrt(d*d+e*e+a*a))?(b=1/b,c[0]=d*b,c[1]=e*b,c[2]=a*b,c):(c[0]=0,c[1]=0,c[2]=0,c)},lerp:function(a,b,c,d){return d||(d=a),d[0]=a[0]+c*(b[0]-a[0]),d[1]=a[1]+c*(b[1]-a[1]),d[2]=a[2]+c*(b[2]-a[2]),d},dist:function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2];return Math.sqrt(c*c+d*d+e*e)}},i=null,j=new g(4),h.unproject=function(a,b,c,d,e){e||(e=a),i||(i=p.create());var f=i;return j[0]=2*(a[0]-d[0])/d[2]-1,j[1]=2*(a[1]-d[1])/d[3]-1,j[2]=2*a[2]-1,j[3]=1,p.multiply(c,b,f),p.inverse(f)?(p.multiplyVec4(f,j),0===j[3]?null:(e[0]=j[0]/j[3],e[1]=j[1]/j[3],e[2]=j[2]/j[3],e)):null},k=h.createFrom(1,0,0),l=h.createFrom(0,1,0),m=h.createFrom(0,0,1),n=h.create(),h.rotationTo=function(a,b,c){var d,e;return c||(c=q.create()),d=h.dot(a,b),d>=1?q.set(r,c):-.999999>d?(h.cross(k,a,n),1e-6>h.length(n)&&h.cross(l,a,n),1e-6>h.length(n)&&h.cross(m,a,n),h.normalize(n),q.fromAngleAxis(Math.PI,n,c)):(d=Math.sqrt(2*(1+d)),e=1/d,h.cross(a,b,n),c[0]=n[0]*e,c[1]=n[1]*e,c[2]=n[2]*e,c[3]=.5*d,q.normalize(c)),1<c[3]?c[3]=1:-1>c[3]&&(c[3]=-1),c},h.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+"]"},o={create:function(a){var b=new g(9);return a?(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8]):b[0]=b[1]=b[2]=b[3]=b[4]=b[5]=b[6]=b[7]=b[8]=0,b},createFrom:function(a,b,c,d,e,f,h,i,j){var k=new g(9);return k[0]=a,k[1]=b,k[2]=c,k[3]=d,k[4]=e,k[5]=f,k[6]=h,k[7]=i,k[8]=j,k},determinant:function(a){var b=a[3],c=a[4],d=a[5],e=a[6],f=a[7],g=a[8];return a[0]*(g*c-d*f)+a[1]*(-g*b+d*e)+a[2]*(f*b-c*e)},inverse:function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],i=a[6],j=a[7],k=a[8],l=k*g-h*j,m=-k*f+h*i,n=j*f-g*i,p=c*l+d*m+e*n;return p?(p=1/p,b||(b=o.create()),b[0]=l*p,b[1]=(-k*d+e*j)*p,b[2]=(h*d-e*g)*p,b[3]=m*p,b[4]=(k*c-e*i)*p,b[5]=(-h*c+e*f)*p,b[6]=n*p,b[7]=(-j*c+d*i)*p,b[8]=(g*c-d*f)*p,b):null},multiply:function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;return c||(c=a),d=a[0],e=a[1],f=a[2],g=a[3],h=a[4],i=a[5],j=a[6],k=a[7],a=a[8],l=b[0],m=b[1],n=b[2],o=b[3],p=b[4],q=b[5],r=b[6],s=b[7],b=b[8],c[0]=l*d+m*g+n*j,c[1]=l*e+m*h+n*k,c[2]=l*f+m*i+n*a,c[3]=o*d+p*g+q*j,c[4]=o*e+p*h+q*k,c[5]=o*f+p*i+q*a,c[6]=r*d+s*g+b*j,c[7]=r*e+s*h+b*k,c[8]=r*f+s*i+b*a,c},multiplyVec2:function(a,b,c){c||(c=b);var d=b[0];return b=b[1],c[0]=d*a[0]+b*a[3]+a[6],c[1]=d*a[1]+b*a[4]+a[7],c},multiplyVec3:function(a,b,c){c||(c=b);var d=b[0],e=b[1];return b=b[2],c[0]=d*a[0]+e*a[3]+b*a[6],c[1]=d*a[1]+e*a[4]+b*a[7],c[2]=d*a[2]+e*a[5]+b*a[8],c},set:function(a,b){return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b},equal:function(a,b){return a===b||1e-6>Math.abs(a[0]-b[0])&&1e-6>Math.abs(a[1]-b[1])&&1e-6>Math.abs(a[2]-b[2])&&1e-6>Math.abs(a[3]-b[3])&&1e-6>Math.abs(a[4]-b[4])&&1e-6>Math.abs(a[5]-b[5])&&1e-6>Math.abs(a[6]-b[6])&&1e-6>Math.abs(a[7]-b[7])&&1e-6>Math.abs(a[8]-b[8])},identity:function(a){return a||(a=o.create()),a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},transpose:function(a,b){if(!b||a===b){var c=a[1],d=a[2],e=a[5];return a[1]=a[3],a[2]=a[6],a[3]=c,a[5]=a[7],a[6]=d,a[7]=e,a}return b[0]=a[0],b[1]=a[3],b[2]=a[6],b[3]=a[1],b[4]=a[4],b[5]=a[7],b[6]=a[2],b[7]=a[5],b[8]=a[8],b},toMat4:function(a,b){return b||(b=p.create()),b[15]=1,b[14]=0,b[13]=0,b[12]=0,b[11]=0,b[10]=a[8],b[9]=a[7],b[8]=a[6],b[7]=0,b[6]=a[5],b[5]=a[4],b[4]=a[3],b[3]=0,b[2]=a[2],b[1]=a[1],b[0]=a[0],b},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+"]"}},p={create:function(a){var b=new g(16);return a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]),b},createFrom:function(a,b,c,d,e,f,h,i,j,k,l,m,n,o,p,q){var r=new g(16);return r[0]=a,r[1]=b,r[2]=c,r[3]=d,r[4]=e,r[5]=f,r[6]=h,r[7]=i,r[8]=j,r[9]=k,r[10]=l,r[11]=m,r[12]=n,r[13]=o,r[14]=p,r[15]=q,r},set:function(a,b){return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15],b},equal:function(a,b){return a===b||1e-6>Math.abs(a[0]-b[0])&&1e-6>Math.abs(a[1]-b[1])&&1e-6>Math.abs(a[2]-b[2])&&1e-6>Math.abs(a[3]-b[3])&&1e-6>Math.abs(a[4]-b[4])&&1e-6>Math.abs(a[5]-b[5])&&1e-6>Math.abs(a[6]-b[6])&&1e-6>Math.abs(a[7]-b[7])&&1e-6>Math.abs(a[8]-b[8])&&1e-6>Math.abs(a[9]-b[9])&&1e-6>Math.abs(a[10]-b[10])&&1e-6>Math.abs(a[11]-b[11])&&1e-6>Math.abs(a[12]-b[12])&&1e-6>Math.abs(a[13]-b[13])&&1e-6>Math.abs(a[14]-b[14])&&1e-6>Math.abs(a[15]-b[15])},identity:function(a){return a||(a=p.create()),a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},transpose:function(a,b){if(!b||a===b){var c=a[1],d=a[2],e=a[3],f=a[6],g=a[7],h=a[11];return a[1]=a[4],a[2]=a[8],a[3]=a[12],a[4]=c,a[6]=a[9],a[7]=a[13],a[8]=d,a[9]=f,a[11]=a[14],a[12]=e,a[13]=g,a[14]=h,a}return b[0]=a[0],b[1]=a[4],b[2]=a[8],b[3]=a[12],b[4]=a[1],b[5]=a[5],b[6]=a[9],b[7]=a[13],b[8]=a[2],b[9]=a[6],b[10]=a[10],b[11]=a[14],b[12]=a[3],b[13]=a[7],b[14]=a[11],b[15]=a[15],b},determinant:function(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7],j=a[8],k=a[9],l=a[10],m=a[11],n=a[12],o=a[13],p=a[14];return a=a[15],n*k*h*e-j*o*h*e-n*g*l*e+f*o*l*e+j*g*p*e-f*k*p*e-n*k*d*i+j*o*d*i+n*c*l*i-b*o*l*i-j*c*p*i+b*k*p*i+n*g*d*m-f*o*d*m-n*c*h*m+b*o*h*m+f*c*p*m-b*g*p*m-j*g*d*a+f*k*d*a+j*c*h*a-b*k*h*a-f*c*l*a+b*g*l*a},inverse:function(a,b){b||(b=a);var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],i=a[6],j=a[7],k=a[8],l=a[9],m=a[10],n=a[11],o=a[12],p=a[13],q=a[14],r=a[15],s=c*h-d*g,t=c*i-e*g,u=c*j-f*g,v=d*i-e*h,w=d*j-f*h,x=e*j-f*i,y=k*p-l*o,z=k*q-m*o,A=k*r-n*o,B=l*q-m*p,C=l*r-n*p,D=m*r-n*q,E=s*D-t*C+u*B+v*A-w*z+x*y;return E?(E=1/E,b[0]=(h*D-i*C+j*B)*E,b[1]=(-d*D+e*C-f*B)*E,b[2]=(p*x-q*w+r*v)*E,b[3]=(-l*x+m*w-n*v)*E,b[4]=(-g*D+i*A-j*z)*E,b[5]=(c*D-e*A+f*z)*E,b[6]=(-o*x+q*u-r*t)*E,b[7]=(k*x-m*u+n*t)*E,b[8]=(g*C-h*A+j*y)*E,b[9]=(-c*C+d*A-f*y)*E,b[10]=(o*w-p*u+r*s)*E,b[11]=(-k*w+l*u-n*s)*E,b[12]=(-g*B+h*z-i*y)*E,b[13]=(c*B-d*z+e*y)*E,b[14]=(-o*v+p*t-q*s)*E,b[15]=(k*v-l*t+m*s)*E,b):null},toRotationMat:function(a,b){return b||(b=p.create()),b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=0,b[13]=0,b[14]=0,b[15]=1,b},toMat3:function(a,b){return b||(b=o.create()),b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[4],b[4]=a[5],b[5]=a[6],b[6]=a[8],b[7]=a[9],b[8]=a[10],b},toInverseMat3:function(a,b){var c=a[0],d=a[1],e=a[2],f=a[4],g=a[5],h=a[6],i=a[8],j=a[9],k=a[10],l=k*g-h*j,m=-k*f+h*i,n=j*f-g*i,p=c*l+d*m+e*n;return p?(p=1/p,b||(b=o.create()),b[0]=l*p,b[1]=(-k*d+e*j)*p,b[2]=(h*d-e*g)*p,b[3]=m*p,b[4]=(k*c-e*i)*p,b[5]=(-h*c+e*f)*p,b[6]=n*p,b[7]=(-j*c+d*i)*p,b[8]=(g*c-d*f)*p,b):null},multiply:function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v;return c||(c=a),d=a[0],e=a[1],f=a[2],g=a[3],h=a[4],i=a[5],j=a[6],k=a[7],l=a[8],m=a[9],n=a[10],o=a[11],p=a[12],q=a[13],r=a[14],a=a[15],s=b[0],t=b[1],u=b[2],v=b[3],c[0]=s*d+t*h+u*l+v*p,c[1]=s*e+t*i+u*m+v*q,c[2]=s*f+t*j+u*n+v*r,c[3]=s*g+t*k+u*o+v*a,s=b[4],t=b[5],u=b[6],v=b[7],c[4]=s*d+t*h+u*l+v*p,c[5]=s*e+t*i+u*m+v*q,c[6]=s*f+t*j+u*n+v*r,c[7]=s*g+t*k+u*o+v*a,s=b[8],t=b[9],u=b[10],v=b[11],c[8]=s*d+t*h+u*l+v*p,c[9]=s*e+t*i+u*m+v*q,c[10]=s*f+t*j+u*n+v*r,c[11]=s*g+t*k+u*o+v*a,s=b[12],t=b[13],u=b[14],v=b[15],c[12]=s*d+t*h+u*l+v*p,c[13]=s*e+t*i+u*m+v*q,c[14]=s*f+t*j+u*n+v*r,c[15]=s*g+t*k+u*o+v*a,c},multiplyVec3:function(a,b,c){c||(c=b);var d=b[0],e=b[1];return b=b[2],c[0]=a[0]*d+a[4]*e+a[8]*b+a[12],c[1]=a[1]*d+a[5]*e+a[9]*b+a[13],c[2]=a[2]*d+a[6]*e+a[10]*b+a[14],c},multiplyVec4:function(a,b,c){c||(c=b);var d=b[0],e=b[1],f=b[2];return b=b[3],c[0]=a[0]*d+a[4]*e+a[8]*f+a[12]*b,c[1]=a[1]*d+a[5]*e+a[9]*f+a[13]*b,c[2]=a[2]*d+a[6]*e+a[10]*f+a[14]*b,c[3]=a[3]*d+a[7]*e+a[11]*f+a[15]*b,c},translate:function(a,b,c){var f,g,h,i,j,k,l,m,n,o,p,q,d=b[0],e=b[1];return b=b[2],c&&a!==c?(f=a[0],g=a[1],h=a[2],i=a[3],j=a[4],k=a[5],l=a[6],m=a[7],n=a[8],o=a[9],p=a[10],q=a[11],c[0]=f,c[1]=g,c[2]=h,c[3]=i,c[4]=j,c[5]=k,c[6]=l,c[7]=m,c[8]=n,c[9]=o,c[10]=p,c[11]=q,c[12]=f*d+j*e+n*b+a[12],c[13]=g*d+k*e+o*b+a[13],c[14]=h*d+l*e+p*b+a[14],c[15]=i*d+m*e+q*b+a[15],c):(a[12]=a[0]*d+a[4]*e+a[8]*b+a[12],a[13]=a[1]*d+a[5]*e+a[9]*b+a[13],a[14]=a[2]*d+a[6]*e+a[10]*b+a[14],a[15]=a[3]*d+a[7]*e+a[11]*b+a[15],a)},scale:function(a,b,c){var d=b[0],e=b[1];return b=b[2],c&&a!==c?(c[0]=a[0]*d,c[1]=a[1]*d,c[2]=a[2]*d,c[3]=a[3]*d,c[4]=a[4]*e,c[5]=a[5]*e,c[6]=a[6]*e,c[7]=a[7]*e,c[8]=a[8]*b,c[9]=a[9]*b,c[10]=a[10]*b,c[11]=a[11]*b,c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15],c):(a[0]*=d,a[1]*=d,a[2]*=d,a[3]*=d,a[4]*=e,a[5]*=e,a[6]*=e,a[7]*=e,a[8]*=b,a[9]*=b,a[10]*=b,a[11]*=b,a)},rotate:function(a,b,c,d){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,g,e=c[0],f=c[1];return c=c[2],(g=Math.sqrt(e*e+f*f+c*c))?(1!==g&&(g=1/g,e*=g,f*=g,c*=g),h=Math.sin(b),i=Math.cos(b),j=1-i,b=a[0],g=a[1],k=a[2],l=a[3],m=a[4],n=a[5],o=a[6],p=a[7],q=a[8],r=a[9],s=a[10],t=a[11],u=e*e*j+i,v=f*e*j+c*h,w=c*e*j-f*h,x=e*f*j-c*h,y=f*f*j+i,z=c*f*j+e*h,A=e*c*j+f*h,e=f*c*j-e*h,f=c*c*j+i,d?a!==d&&(d[12]=a[12],d[13]=a[13],d[14]=a[14],d[15]=a[15]):d=a,d[0]=b*u+m*v+q*w,d[1]=g*u+n*v+r*w,d[2]=k*u+o*v+s*w,d[3]=l*u+p*v+t*w,d[4]=b*x+m*y+q*z,d[5]=g*x+n*y+r*z,d[6]=k*x+o*y+s*z,d[7]=l*x+p*y+t*z,d[8]=b*A+m*e+q*f,d[9]=g*A+n*e+r*f,d[10]=k*A+o*e+s*f,d[11]=l*A+p*e+t*f,d):null},rotateX:function(a,b,c){var e,f,g,h,i,j,k,l,d=Math.sin(b);return b=Math.cos(b),e=a[4],f=a[5],g=a[6],h=a[7],i=a[8],j=a[9],k=a[10],l=a[11],c?a!==c&&(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a,c[4]=e*b+i*d,c[5]=f*b+j*d,c[6]=g*b+k*d,c[7]=h*b+l*d,c[8]=e*-d+i*b,c[9]=f*-d+j*b,c[10]=g*-d+k*b,c[11]=h*-d+l*b,c},rotateY:function(a,b,c){var e,f,g,h,i,j,k,l,d=Math.sin(b);return b=Math.cos(b),e=a[0],f=a[1],g=a[2],h=a[3],i=a[8],j=a[9],k=a[10],l=a[11],c?a!==c&&(c[4]=a[4],c[5]=a[5],c[6]=a[6],c[7]=a[7],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a,c[0]=e*b+i*-d,c[1]=f*b+j*-d,c[2]=g*b+k*-d,c[3]=h*b+l*-d,c[8]=e*d+i*b,c[9]=f*d+j*b,c[10]=g*d+k*b,c[11]=h*d+l*b,c},rotateZ:function(a,b,c){var e,f,g,h,i,j,k,l,d=Math.sin(b);return b=Math.cos(b),e=a[0],f=a[1],g=a[2],h=a[3],i=a[4],j=a[5],k=a[6],l=a[7],c?a!==c&&(c[8]=a[8],c[9]=a[9],c[10]=a[10],c[11]=a[11],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a,c[0]=e*b+i*d,c[1]=f*b+j*d,c[2]=g*b+k*d,c[3]=h*b+l*d,c[4]=e*-d+i*b,c[5]=f*-d+j*b,c[6]=g*-d+k*b,c[7]=h*-d+l*b,c},frustum:function(a,b,c,d,e,f,g){g||(g=p.create());var h=b-a,i=d-c,j=f-e;return g[0]=2*e/h,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=2*e/i,g[6]=0,g[7]=0,g[8]=(b+a)/h,g[9]=(d+c)/i,g[10]=-(f+e)/j,g[11]=-1,g[12]=0,g[13]=0,g[14]=-(2*f*e)/j,g[15]=0,g},perspective:function(a,b,c,d,e){return a=c*Math.tan(a*Math.PI/360),b*=a,p.frustum(-b,b,-a,a,c,d,e)},ortho:function(a,b,c,d,e,f,g){g||(g=p.create());var h=b-a,i=d-c,j=f-e;return g[0]=2/h,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=2/i,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=-2/j,g[11]=0,g[12]=-(a+b)/h,g[13]=-(d+c)/i,g[14]=-(f+e)/j,g[15]=1,g},lookAt:function(a,b,c,d){d||(d=p.create());var e,f,g,h,i,j,k,l,m=a[0],n=a[1];return a=a[2],g=c[0],h=c[1],f=c[2],k=b[0],c=b[1],e=b[2],m===k&&n===c&&a===e?p.identity(d):(b=m-k,c=n-c,k=a-e,l=1/Math.sqrt(b*b+c*c+k*k),b*=l,c*=l,k*=l,e=h*k-f*c,f=f*b-g*k,g=g*c-h*b,(l=Math.sqrt(e*e+f*f+g*g))?(l=1/l,e*=l,f*=l,g*=l):g=f=e=0,h=c*g-k*f,i=k*e-b*g,j=b*f-c*e,(l=Math.sqrt(h*h+i*i+j*j))?(l=1/l,h*=l,i*=l,j*=l):j=i=h=0,d[0]=e,d[1]=h,d[2]=b,d[3]=0,d[4]=f,d[5]=i,d[6]=c,d[7]=0,d[8]=g,d[9]=j,d[10]=k,d[11]=0,d[12]=-(e*m+f*n+g*a),d[13]=-(h*m+i*n+j*a),d[14]=-(b*m+c*n+k*a),d[15]=1,d)},fromRotationTranslation:function(a,b,c){var d,e,f,g,h,i,j,k,l;return c||(c=p.create()),d=a[0],e=a[1],f=a[2],g=a[3],h=d+d,i=e+e,j=f+f,a=d*h,k=d*i,d*=j,l=e*i,e*=j,f*=j,h=g*h,i=g*i,g*=j,c[0]=1-(l+f),c[1]=k+g,c[2]=d-i,c[3]=0,c[4]=k-g,c[5]=1-(a+f),c[6]=e+h,c[7]=0,c[8]=d+i,c[9]=e-h,c[10]=1-(a+l),c[11]=0,c[12]=b[0],c[13]=b[1],c[14]=b[2],c[15]=1,c},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+"]"}},q={create:function(a){var b=new g(4);return a?(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3]):b[0]=b[1]=b[2]=b[3]=0,b},createFrom:function(a,b,c,d){var e=new g(4);return e[0]=a,e[1]=b,e[2]=c,e[3]=d,e},set:function(a,b){return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b},equal:function(a,b){return a===b||1e-6>Math.abs(a[0]-b[0])&&1e-6>Math.abs(a[1]-b[1])&&1e-6>Math.abs(a[2]-b[2])&&1e-6>Math.abs(a[3]-b[3])},identity:function(a){return a||(a=q.create()),a[0]=0,a[1]=0,a[2]=0,a[3]=1,a}},r=q.identity(),q.calculateW=function(a,b){var c=a[0],d=a[1],e=a[2];return b&&a!==b?(b[0]=c,b[1]=d,b[2]=e,b[3]=-Math.sqrt(Math.abs(1-c*c-d*d-e*e)),b):(a[3]=-Math.sqrt(Math.abs(1-c*c-d*d-e*e)),a)},q.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]},q.inverse=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],c=(c=c*c+d*d+e*e+f*f)?1/c:0;return b&&a!==b?(b[0]=-a[0]*c,b[1]=-a[1]*c,b[2]=-a[2]*c,b[3]=a[3]*c,b):(a[0]*=-c,a[1]*=-c,a[2]*=-c,a[3]*=c,a)},q.conjugate=function(a,b){return b&&a!==b?(b[0]=-a[0],b[1]=-a[1],b[2]=-a[2],b[3]=a[3],b):(a[0]*=-1,a[1]*=-1,a[2]*=-1,a)},q.length=function(a){var b=a[0],c=a[1],d=a[2];return a=a[3],Math.sqrt(b*b+c*c+d*d+a*a)},q.normalize=function(a,b){b||(b=a);var c=a[0],d=a[1],e=a[2],f=a[3],g=Math.sqrt(c*c+d*d+e*e+f*f);return 0===g?(b[0]=0,b[1]=0,b[2]=0,b[3]=0,b):(g=1/g,b[0]=c*g,b[1]=d*g,b[2]=e*g,b[3]=f*g,b)},q.add=function(a,b,c){return c&&a!==c?(c[0]=a[0]+b[0],c[1]=a[1]+b[1],c[2]=a[2]+b[2],c[3]=a[3]+b[3],c):(a[0]+=b[0],a[1]+=b[1],a[2]+=b[2],a[3]+=b[3],a)},q.multiply=function(a,b,c){var d,e,f,g,h,i;return c||(c=a),d=a[0],e=a[1],f=a[2],a=a[3],g=b[0],h=b[1],i=b[2],b=b[3],c[0]=d*b+a*g+e*i-f*h,c[1]=e*b+a*h+f*g-d*i,c[2]=f*b+a*i+d*h-e*g,c[3]=a*b-d*g-e*h-f*i,c},q.multiplyVec3=function(a,b,c){var d,e,f,g,h,i,j,k;return c||(c=b),d=b[0],e=b[1],f=b[2],b=a[0],g=a[1],h=a[2],a=a[3],i=a*d+g*f-h*e,j=a*e+h*d-b*f,k=a*f+b*e-g*d,d=-b*d-g*e-h*f,c[0]=i*a+d*-b+j*-h-k*-g,c[1]=j*a+d*-g+k*-b-i*-h,c[2]=k*a+d*-h+i*-g-j*-b,c},q.scale=function(a,b,c){return c&&a!==c?(c[0]=a[0]*b,c[1]=a[1]*b,c[2]=a[2]*b,c[3]=a[3]*b,c):(a[0]*=b,a[1]*=b,a[2]*=b,a[3]*=b,a)},q.toMat3=function(a,b){b||(b=o.create());var c=a[0],d=a[1],e=a[2],f=a[3],g=c+c,h=d+d,i=e+e,j=c*g,k=c*h,c=c*i,l=d*h,d=d*i,e=e*i,g=f*g,h=f*h,f=f*i;return b[0]=1-(l+e),b[1]=k+f,b[2]=c-h,b[3]=k-f,b[4]=1-(j+e),b[5]=d+g,b[6]=c+h,b[7]=d-g,b[8]=1-(j+l),b},q.toMat4=function(a,b){b||(b=p.create());var c=a[0],d=a[1],e=a[2],f=a[3],g=c+c,h=d+d,i=e+e,j=c*g,k=c*h,c=c*i,l=d*h,d=d*i,e=e*i,g=f*g,h=f*h,f=f*i;return b[0]=1-(l+e),b[1]=k+f,b[2]=c-h,b[3]=0,b[4]=k-f,b[5]=1-(j+e),b[6]=d+g,b[7]=0,b[8]=c+h,b[9]=d-g,b[10]=1-(j+l),b[11]=0,b[12]=0,b[13]=0,b[14]=0,b[15]=1,b},q.slerp=function(a,b,c,d){d||(d=a);var f,g,e=a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3];return 1<=Math.abs(e)?(d!==a&&(d[0]=a[0],d[1]=a[1],d[2]=a[2],d[3]=a[3]),d):(f=Math.acos(e),g=Math.sqrt(1-e*e),.001>Math.abs(g)?(d[0]=.5*a[0]+.5*b[0],d[1]=.5*a[1]+.5*b[1],d[2]=.5*a[2]+.5*b[2],d[3]=.5*a[3]+.5*b[3],d):(e=Math.sin((1-c)*f)/g,c=Math.sin(c*f)/g,d[0]=a[0]*e+b[0]*c,d[1]=a[1]*e+b[1]*c,d[2]=a[2]*e+b[2]*c,d[3]=a[3]*e+b[3]*c,d))},q.fromRotationMatrix=function(a,b){var d,c,e,f;return b||(b=q.create()),c=a[0]+a[4]+a[8],c>0?(d=Math.sqrt(c+1),b[3]=.5*d,d=.5/d,b[0]=(a[7]-a[5])*d,b[1]=(a[2]-a[6])*d,b[2]=(a[3]-a[1])*d):(d=q.fromRotationMatrix.s_iNext=q.fromRotationMatrix.s_iNext||[1,2,0],c=0,a[4]>a[0]&&(c=1),a[8]>a[3*c+c]&&(c=2),e=d[c],f=d[e],d=Math.sqrt(a[3*c+c]-a[3*e+e]-a[3*f+f]+1),b[c]=.5*d,d=.5/d,b[3]=(a[3*f+e]-a[3*e+f])*d,b[e]=(a[3*e+c]+a[3*c+e])*d,b[f]=(a[3*f+c]+a[3*c+f])*d),b},o.toQuat4=q.fromRotationMatrix,s=o.create(),q.fromAxes=function(a,b,c,d){return s[0]=b[0],s[3]=b[1],s[6]=b[2],s[1]=c[0],s[4]=c[1],s[7]=c[2],s[2]=a[0],s[5]=a[1],s[8]=a[2],q.fromRotationMatrix(s,d)},q.identity=function(a){return a||(a=q.create()),a[0]=0,a[1]=0,a[2]=0,a[3]=1,a},q.fromAngleAxis=function(a,b,c){c||(c=q.create()),a*=.5;var d=Math.sin(a);return c[3]=Math.cos(a),c[0]=d*b[0],c[1]=d*b[1],c[2]=d*b[2],c},q.toAngleAxis=function(a,b){b||(b=a);var c=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];return c>0?(b[3]=2*Math.acos(a[3]),c=d.invsqrt(c),b[0]=a[0]*c,b[1]=a[1]*c,b[2]=a[2]*c):(b[3]=0,b[0]=1,b[1]=0,b[2]=0),b},q.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"},t={create:function(a){var b=new g(2);return a?(b[0]=a[0],b[1]=a[1]):(b[0]=0,b[1]=0),b},createFrom:function(a,b){var c=new g(2);return c[0]=a,c[1]=b,c},add:function(a,b,c){return c||(c=b),c[0]=a[0]+b[0],c[1]=a[1]+b[1],c},subtract:function(a,b,c){return c||(c=b),c[0]=a[0]-b[0],c[1]=a[1]-b[1],c},multiply:function(a,b,c){return c||(c=b),c[0]=a[0]*b[0],c[1]=a[1]*b[1],c},divide:function(a,b,c){return c||(c=b),c[0]=a[0]/b[0],c[1]=a[1]/b[1],c},scale:function(a,b,c){return c||(c=a),c[0]=a[0]*b,c[1]=a[1]*b,c},dist:function(a,b){var c=b[0]-a[0],d=b[1]-a[1];return Math.sqrt(c*c+d*d)},set:function(a,b){return b[0]=a[0],b[1]=a[1],b},equal:function(a,b){return a===b||1e-6>Math.abs(a[0]-b[0])&&1e-6>Math.abs(a[1]-b[1])},negate:function(a,b){return b||(b=a),b[0]=-a[0],b[1]=-a[1],b},normalize:function(a,b){b||(b=a);var c=a[0]*a[0]+a[1]*a[1];return c>0?(c=Math.sqrt(c),b[0]=a[0]/c,b[1]=a[1]/c):b[0]=b[1]=0,b},cross:function(a,b,c){return a=a[0]*b[1]-a[1]*b[0],c?(c[0]=c[1]=0,c[2]=a,c):a},length:function(a){var b=a[0];return a=a[1],Math.sqrt(b*b+a*a)},squaredLength:function(a){var b=a[0];return a=a[1],b*b+a*a},dot:function(a,b){return a[0]*b[0]+a[1]*b[1]},direction:function(a,b,c){c||(c=a);var d=a[0]-b[0];return a=a[1]-b[1],(b=d*d+a*a)?(b=1/Math.sqrt(b),c[0]=d*b,c[1]=a*b,c):(c[0]=0,c[1]=0,c[2]=0,c)},lerp:function(a,b,c,d){return d||(d=a),d[0]=a[0]+c*(b[0]-a[0]),d[1]=a[1]+c*(b[1]-a[1]),d},str:function(a){return"["+a[0]+", "+a[1]+"]"}},u={create:function(a){var b=new g(4);return a?(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3]):b[0]=b[1]=b[2]=b[3]=0,b},createFrom:function(a,b,c,d){var e=new g(4);return e[0]=a,e[1]=b,e[2]=c,e[3]=d,e},set:function(a,b){return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b},equal:function(a,b){return a===b||1e-6>Math.abs(a[0]-b[0])&&1e-6>Math.abs(a[1]-b[1])&&1e-6>Math.abs(a[2]-b[2])&&1e-6>Math.abs(a[3]-b[3])},identity:function(a){return a||(a=u.create()),a[0]=1,a[1]=0,a[2]=0,a[3]=1,a},transpose:function(a,b){if(!b||a===b){var c=a[1];return a[1]=a[2],a[2]=c,a}return b[0]=a[0],b[1]=a[2],b[2]=a[1],b[3]=a[3],b},determinant:function(a){return a[0]*a[3]-a[2]*a[1]},inverse:function(a,b){b||(b=a);var c=a[0],d=a[1],e=a[2],f=a[3],g=c*f-e*d;return g?(g=1/g,b[0]=f*g,b[1]=-d*g,b[2]=-e*g,b[3]=c*g,b):null},multiply:function(a,b,c){c||(c=a);var d=a[0],e=a[1],f=a[2];return a=a[3],c[0]=d*b[0]+e*b[2],c[1]=d*b[1]+e*b[3],c[2]=f*b[0]+a*b[2],c[3]=f*b[1]+a*b[3],c},rotate:function(a,b,c){var d,e,f,g;return c||(c=a),d=a[0],e=a[1],f=a[2],a=a[3],g=Math.sin(b),b=Math.cos(b),c[0]=d*b+e*g,c[1]=d*-g+e*b,c[2]=f*b+a*g,c[3]=f*-g+a*b,c},multiplyVec2:function(a,b,c){c||(c=b);var d=b[0];return b=b[1],c[0]=d*a[0]+b*a[1],c[1]=d*a[2]+b*a[3],c},scale:function(a,b,c){c||(c=a);var d=a[1],e=a[2],f=a[3],g=b[0];return b=b[1],c[0]=a[0]*g,c[1]=d*b,c[2]=e*g,c[3]=f*b,c},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"}},v={create:function(a){var b=new g(4);return a?(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3]):(b[0]=0,b[1]=0,b[2]=0,b[3]=0),b},createFrom:function(a,b,c,d){var e=new g(4);return e[0]=a,e[1]=b,e[2]=c,e[3]=d,e},add:function(a,b,c){return c||(c=b),c[0]=a[0]+b[0],c[1]=a[1]+b[1],c[2]=a[2]+b[2],c[3]=a[3]+b[3],c},subtract:function(a,b,c){return c||(c=b),c[0]=a[0]-b[0],c[1]=a[1]-b[1],c[2]=a[2]-b[2],c[3]=a[3]-b[3],c},multiply:function(a,b,c){return c||(c=b),c[0]=a[0]*b[0],c[1]=a[1]*b[1],c[2]=a[2]*b[2],c[3]=a[3]*b[3],c},divide:function(a,b,c){return c||(c=b),c[0]=a[0]/b[0],c[1]=a[1]/b[1],c[2]=a[2]/b[2],c[3]=a[3]/b[3],c},scale:function(a,b,c){return c||(c=a),c[0]=a[0]*b,c[1]=a[1]*b,c[2]=a[2]*b,c[3]=a[3]*b,c},set:function(a,b){return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b},equal:function(a,b){return a===b||1e-6>Math.abs(a[0]-b[0])&&1e-6>Math.abs(a[1]-b[1])&&1e-6>Math.abs(a[2]-b[2])&&1e-6>Math.abs(a[3]-b[3])},negate:function(a,b){return b||(b=a),b[0]=-a[0],b[1]=-a[1],b[2]=-a[2],b[3]=-a[3],b},length:function(a){var b=a[0],c=a[1],d=a[2];return a=a[3],Math.sqrt(b*b+c*c+d*d+a*a)},squaredLength:function(a){var b=a[0],c=a[1],d=a[2];return a=a[3],b*b+c*c+d*d+a*a},lerp:function(a,b,c,d){return d||(d=a),d[0]=a[0]+c*(b[0]-a[0]),d[1]=a[1]+c*(b[1]-a[1]),d[2]=a[2]+c*(b[2]-a[2]),d[3]=a[3]+c*(b[3]-a[3]),d},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"}},a&&(a.glMatrixArrayType=g,a.MatrixArray=g,a.setMatrixArrayType=b,a.determineMatrixArrayType=c,a.glMath=d,a.vec2=t,a.vec3=h,a.vec4=v,a.mat2=u,a.mat3=o,a.mat4=p,a.quat4=q),{glMatrixArrayType:g,MatrixArray:g,setMatrixArrayType:b,determineMatrixArrayType:c,glMath:d,vec2:t,vec3:h,vec4:v,mat2:u,mat3:o,mat4:p,quat4:q}}),ChemDoodle.animations=function(a){var b={};return a.requestAnimFrame=a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.oRequestAnimationFrame||a.msRequestAnimationFrame||function(b){a.setTimeout(b,1e3/60)},b.requestInterval=function(b,c){function d(){(new Date).getTime()-e>=c&&(b.call(),e=(new Date).getTime()),f.value=a.requestAnimFrame(d)}if(!(a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame&&a.mozCancelRequestAnimationFrame||a.oRequestAnimationFrame||a.msRequestAnimationFrame))return a.setInterval(b,c);var e=(new Date).getTime(),f={};return f.value=a.requestAnimFrame(d),f},b.clearRequestInterval=function(b){a.cancelAnimationFrame?a.cancelAnimationFrame(b.value):a.webkitCancelAnimationFrame?a.webkitCancelAnimationFrame(b.value):a.webkitCancelRequestAnimationFrame?a.webkitCancelRequestAnimationFrame(b.value):a.mozCancelRequestAnimationFrame?a.mozCancelRequestAnimationFrame(b.value):a.oCancelRequestAnimationFrame?a.oCancelRequestAnimationFrame(b.value):a.msCancelRequestAnimationFrame?a.msCancelRequestAnimationFrame(b.value):clearInterval(b)},b.requestTimeout=function(b,c){function d(){(new Date).getTime()-e>=c?b.call():f.value=a.requestAnimFrame(d)}if(!(a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame&&a.mozCancelRequestAnimationFrame||a.oRequestAnimationFrame||a.msRequestAnimationFrame))return a.setTimeout(b,c);var e=(new Date).getTime(),f={};return f.value=a.requestAnimFrame(d),f},b.clearRequestTimeout=function(b){a.cancelAnimationFrame?a.cancelAnimationFrame(b.value):a.webkitCancelAnimationFrame?a.webkitCancelAnimationFrame(b.value):a.webkitCancelRequestAnimationFrame?a.webkitCancelRequestAnimationFrame(b.value):a.mozCancelRequestAnimationFrame?a.mozCancelRequestAnimationFrame(b.value):a.oCancelRequestAnimationFrame?a.oCancelRequestAnimationFrame(b.value):a.msCancelRequestAnimationFrame?a.msCancelRequestAnimationFrame(b.value):clearTimeout(b)},b}(window),ChemDoodle.extensions=function(a,b,c){return{stringStartsWith:function(a,b){return a.slice(0,b.length)===b},vec3AngleFrom:function(a,d){var e=b.length(a),f=b.length(d),e=b.dot(a,d)/e/f;return c.acos(e)},contextHashTo:function(b,c,d,e,f,g,h){var n,i=0,j=new a.Point(c,d).distance(new a.Point(e,f)),k=!1,l=c,m=d;for(c=e-c,d=f-d;j>i;){if(k){if(i+h>j){b.moveTo(e,f);break}n=h/j,l+=n*c,m+=n*d,b.moveTo(l,m),i+=h}else{if(i+g>j){b.lineTo(e,f);break}n=g/j,l+=n*c,m+=n*d,b.lineTo(l,m),i+=g}k=!k}},contextRoundRect:function(a,b,c,d,e,f){a.beginPath(),a.moveTo(b+f,c),a.lineTo(b+d-f,c),a.quadraticCurveTo(b+d,c,b+d,c+f),a.lineTo(b+d,c+e-f),a.quadraticCurveTo(b+d,c+e,b+d-f,c+e),a.lineTo(b+f,c+e),a.quadraticCurveTo(b,c+e,b,c+e-f),a.lineTo(b,c+f),a.quadraticCurveTo(b,c,b+f,c),a.closePath()},contextEllipse:function(a,b,c,d,e){var f=.5522848*(d/2),g=.5522848*(e/2),h=b+d,i=c+e;d=b+d/2,e=c+e/2,a.beginPath(),a.moveTo(b,e),a.bezierCurveTo(b,e-g,d-f,c,d,c),a.bezierCurveTo(d+f,c,h,e-g,h,e),a.bezierCurveTo(h,e+g,d+f,i,d,i),a.bezierCurveTo(d-f,i,b,e+g,b,e),a.closePath()},getFontString:function(a,b,c,d){var e=[];for(c&&e.push("bold "),d&&e.push("italic "),e.push(a+"px "),a=0,c=b.length;c>a;a++)d=b[a],-1!==d.indexOf(" ")&&(d='"'+d+'"'),e.push((0!==a?",":"")+d);return e.join("")}}}(ChemDoodle.structures,ChemDoodle.lib.vec3,Math),ChemDoodle.math=function(a,b,c,d,e){var f={},g={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c","indigo ":"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};return f.angleBetweenLargest=function(a){var b,c,d,f,g;if(0===a.length)return{angle:0,largest:2*e.PI};if(1===a.length)return{angle:a[0]+e.PI,largest:2*e.PI};for(b=0,c=0,d=0,f=a.length-1;f>d;d++)g=a[d+1]-a[d],g>b&&(b=g,c=(a[d+1]+a[d])/2);return d=a[0]+2*e.PI-a[a.length-1],d>b&&(c=a[0]-d/2,b=d,0>c&&(c+=2*e.PI)),{angle:c,largest:b}},f.isBetween=function(a,b,c){if(b>c){var d=b;b=c,c=d}return a>=b&&c>=a},d(document).ready(function(){a.iChemLabs.checkForUpdates({})}),f.getRGB=function(a,c){var e,d=[0,0,0];return g[a.toLowerCase()]&&(a=g[a.toLowerCase()]),"#"===a.charAt(0)?(4===a.length&&(a="#"+a.charAt(1)+a.charAt(1)+a.charAt(2)+a.charAt(2)+a.charAt(3)+a.charAt(3)),[parseInt(a.substring(1,3),16)/255*c,parseInt(a.substring(3,5),16)/255*c,parseInt(a.substring(5,7),16)/255*c]):b.stringStartsWith(a,"rgb")?(e=a.replace(/rgb\(|\)/g,"").split(","),3!==e.length?d:[parseInt(e[0])/255*c,parseInt(e[1])/255*c,parseInt(e[2])/255*c]):d},f.idx2color=function(a){a=a.toString(16);for(var b=0,c=6-a.length;c>b;b++)a="0"+a;return"#"+a},f.distanceFromPointToLineInclusive=function(a,b,d){var g=b.distance(d);return d=b.angle(d),d=e.PI/2-d,d=b.angle(a)+d,a=b.distance(a),a=new c.Point(a*e.cos(d),-a*e.sin(d)),f.isBetween(-a.y,0,g)?e.abs(a.x):-1},f.calculateDistanceInterior=function(a,b,c){var d,f,g,h;if(this.isBetween(b.x,c.x,c.x+c.w)&&this.isBetween(b.y,c.y,c.y+c.w))return a.distance(b);for(d=[],d.push({x1:c.x,y1:c.y,x2:c.x+c.w,y2:c.y}),d.push({x1:c.x,y1:c.y+c.h,x2:c.x+c.w,y2:c.y+c.h}),d.push({x1:c.x,y1:c.y,x2:c.x,y2:c.y+c.h}),d.push({x1:c.x+c.w,y1:c.y,x2:c.x+c.w,y2:c.y+c.h}),c=[],f=0;4>f;f++)g=d[f],(g=this.intersectLines(b.x,b.y,a.x,a.y,g.x1,g.y1,g.x2,g.y2))&&c.push(g);if(0===c.length)return 0;for(f=b=0,d=c.length;d>f;f++)g=c[f],h=a.x-g.x,g=a.y-g.y,b=e.max(b,e.sqrt(h*h+g*g));return b},f.intersectLines=function(a,b,c,d,e,f,g,h){c-=a,d-=b,g-=e,h-=f;var i=d*g-c*h;return 0===i?!1:(g=(h*(a-e)-g*(b-f))/i,e=(d*(a-e)-c*(b-f))/i,e>=0&&1>=e&&g>=0&&1>=g?{x:a+g*c,y:b+g*d}:!1)},f.hsl2rgb=function(a,b,c){var e,f,d=function(a,b,c){return 0>c?c+=1:c>1&&(c-=1),1/6>c?a+6*(b-a)*c:.5>c?b:2/3>c?a+6*(b-a)*(2/3-c):a};return 0===b?c=b=a=c:(e=.5>c?c*(1+b):c+b-c*b,f=2*c-e,c=d(f,e,a+1/3),b=d(f,e,a),a=d(f,e,a-1/3)),[255*c,255*b,255*a]},f.isPointInPoly=function(a,b){for(var c=!1,d=-1,e=a.length,f=e-1;++d<e;f=d)(a[d].y<=b.y&&b.y<a[f].y||a[f].y<=b.y&&b.y<a[d].y)&&b.x<(a[f].x-a[d].x)*(b.y-a[d].y)/(a[f].y-a[d].y)+a[d].x&&(c=!c);return c},f.clamp=function(a,b,c){return b>a?b:a>c?c:a},f.rainbowAt=function(a,b,c){1>c.length?c.push("#000000","#FFFFFF"):2>c.length&&c.push("#FFFFFF");var d=b/(c.length-1);return b=e.floor(a/d),a=(a-b*d)/d,d=f.getRGB(c[b],1),c=f.getRGB(c[b+1],1),"rgb("+[255*(d[0]+(c[0]-d[0])*a),255*(d[1]+(c[1]-d[1])*a),255*(d[2]+(c[2]-d[2])*a)].join()+")"},f.angleBounds=function(a,b,c){for(var d=2*e.PI;0>a;)a+=d;for(;a>d;)a-=d;return c&&a>e.PI&&(a=2*e.PI-a),b&&(a=180*a/e.PI),a},f}(ChemDoodle,ChemDoodle.extensions,ChemDoodle.structures,ChemDoodle.lib.jQuery,Math),function(a,b){a.Bounds=function(){};var c=a.Bounds.prototype;c.minX=c.minY=c.minZ=1/0,c.maxX=c.maxY=c.maxZ=-1/0,c.expand=function(c,d,e,f){c instanceof a.Bounds?(this.minX=b.min(this.minX,c.minX),this.minY=b.min(this.minY,c.minY),this.maxX=b.max(this.maxX,c.maxX),this.maxY=b.max(this.maxY,c.maxY),1/0!==c.maxZ&&(this.minZ=b.min(this.minZ,c.minZ),this.maxZ=b.max(this.maxZ,c.maxZ))):(this.minX=b.min(this.minX,c),this.maxX=b.max(this.maxX,c),this.minY=b.min(this.minY,d),this.maxY=b.max(this.maxY,d),void 0!==e&&void 0!==f&&(this.minX=b.min(this.minX,e),this.maxX=b.max(this.maxX,e),this.minY=b.min(this.minY,f),this.maxY=b.max(this.maxY,f)))
},c.expand3D=function(a,c,d,e,f,g){this.minX=b.min(this.minX,a),this.maxX=b.max(this.maxX,a),this.minY=b.min(this.minY,c),this.maxY=b.max(this.maxY,c),this.minZ=b.min(this.minZ,d),this.maxZ=b.max(this.maxZ,d),void 0!==e&&void 0!==f&&void 0!==g&&(this.minX=b.min(this.minX,e),this.maxX=b.max(this.maxX,e),this.minY=b.min(this.minY,f),this.maxY=b.max(this.maxY,f),this.minZ=b.min(this.minZ,g),this.maxZ=b.max(this.maxZ,g))}}(ChemDoodle.math,Math),function(){var a={subtract:function(a,b){return{x:a.x-b.x,y:a.y-b.y}},dotProduct:function(a,b){return a.x*b.x+a.y*b.y},square:function(a){return Math.sqrt(a.x*a.x+a.y*a.y)},scale:function(a,b){return{x:a.x*b,y:a.y*b}}},b=Math.pow(2,-65),c=function(b,c){var f,g,h,i,j,k,l,m,n,o;for(f=[],g=c.length-1,h=2*g-1,i=[],j=[],k=[],l=[],m=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]],n=0;g>=n;n++)i[n]=a.subtract(c[n],b);for(n=0;g-1>=n;n++)j[n]=a.subtract(c[n+1],c[n]),j[n]=a.scale(j[n],3);for(n=0;g-1>=n;n++)for(o=0;g>=o;o++)k[n]||(k[n]=[]),k[n][o]=a.dotProduct(j[n],i[o]);for(n=0;h>=n;n++)l[n]||(l[n]=[]),l[n].y=0,l[n].x=parseFloat(n)/h;for(h=g-1,i=0;g+h>=i;i++)for(n=Math.max(0,i-h),j=Math.min(i,g);j>=n;n++)o=i-n,l[n+o].y+=k[o][n]*m[o][n];for(g=c.length-1,l=d(l,2*g-1,f,0),h=a.subtract(b,c[0]),k=a.square(h),n=m=0;l>n;n++)h=a.subtract(b,e(c,g,f[n],null,null)),h=a.square(h),k>h&&(k=h,m=f[n]);return h=a.subtract(b,c[g]),h=a.square(h),k>h&&(k=h,m=1),{location:m,distance:k}},d=function(a,c,f,g){var m,o,p,q,r,h=[],i=[],j=[],k=[],l=0,n=0==a[0].y?0:0<a[0].y?1:-1;for(o=1;c>=o;o++)m=0==a[o].y?0:0<a[o].y?1:-1,m!=n&&l++,n=m;switch(l){case 0:return 0;case 1:if(g>=64)return f[0]=(a[0].x+a[c].x)/2,1;for(l=a[0].y-a[c].y,m=a[c].x-a[0].x,n=a[0].x*a[c].y-a[c].x*a[0].y,o=p=0,q=1;c>q;q++)r=l*a[q].x+m*a[q].y+n,r>p?p=r:o>r&&(o=r);if(r=m,q=0*r-1*l,p=(1*(n-p)-0*r)*(1/q),r=m,q=0*r-1*l,l=(1*(n-o)-0*r)*(1/q),m=Math.min(p,l),Math.max(p,l)-m<b)return j=a[c].x-a[0].x,k=a[c].y-a[0].y,f[0]=0+1*(j*(a[0].y-0)-k*(a[0].x-0))*(1/(0*j-1*k)),1}for(e(a,c,.5,h,i),a=d(h,c,j,g+1),c=d(i,c,k,g+1),g=0;a>g;g++)f[g]=j[g];for(g=0;c>g;g++)f[g+a]=k[g];return a+c},e=function(a,b,c,d,e){for(var f=[[]],g=0;b>=g;g++)f[0][g]=a[g];for(a=1;b>=a;a++)for(g=0;b-a>=g;g++)f[a]||(f[a]=[]),f[a][g]||(f[a][g]={}),f[a][g].x=(1-c)*f[a-1][g].x+c*f[a-1][g+1].x,f[a][g].y=(1-c)*f[a-1][g].y+c*f[a-1][g+1].y;if(null!=d)for(g=0;b>=g;g++)d[g]=f[g][0];if(null!=e)for(g=0;b>=g;g++)e[g]=f[b-g][g];return f[b][0]},f={},g=function(a,b){var e,g,h,i,j,k,l,d=a.length-1,c=f[d];if(!c){for(c=[],e=function(a){return function(){return a}},g=function(){return function(a){return a}},h=function(){return function(a){return 1-a}},i=function(a){return function(b){for(var c=1,d=0;d<a.length;d++)c*=a[d](b);return c}},c.push(new function(){return function(a){return Math.pow(a,d)}}),j=1;d>j;j++){for(k=[new e(d)],l=0;d-j>l;l++)k.push(new g);for(l=0;j>l;l++)k.push(new h);c.push(new i(k))}c.push(new function(){return function(a){return Math.pow(1-a,d)}}),f[d]=c}for(h=g=e=0;h<a.length;h++)e+=a[h].x*c[h](b),g+=a[h].y*c[h](b);return{x:e,y:g}},h=function(a,b){return Math.sqrt(Math.pow(a.x-b.x,2)+Math.pow(a.y-b.y,2))},i=function(a,b,c){for(var d=g(a,b),e=0,f=c>0?1:-1,i=null;e<Math.abs(c);)b+=.005*f,i=g(a,b),e+=h(i,d),d=i;return{point:i,location:b}},j=function(a,b){var c=g(a,b),d=g(a.slice(0,a.length-1),b),e=d.y-c.y,c=d.x-c.x;return 0==e?1/0:Math.atan(e/c)};ChemDoodle.math.jsBezier={distanceFromCurve:c,gradientAtPoint:j,gradientAtPointAlongCurveFrom:function(a,b,c){return b=i(a,b,c),1<b.location&&(b.location=1),0>b.location&&(b.location=0),j(a,b.location)},nearestPointOnCurve:function(a,b){var d=c(a,b);return{point:e(b,b.length-1,d.location,null,null),location:d.location}},pointOnCurve:g,pointAlongCurveFrom:function(a,b,c){return i(a,b,c).point},perpendicularToCurveAt:function(a,b,c,d){return b=i(a,b,null==d?0:d),a=j(a,b.location),d=Math.atan(-1/a),a=c/2*Math.sin(d),c=c/2*Math.cos(d),[{x:b.point.x+c,y:b.point.y+a},{x:b.point.x-c,y:b.point.y-a}]},locationAlongCurveFrom:function(a,b,c){return i(a,b,c).location},getLength:function(a){for(var b=g(a,0),c=0,d=0,e=null;1>d;)d+=.005,e=g(a,d),c+=h(e,b),b=e;return c}}}(ChemDoodle.math),ChemDoodle.featureDetection=function(a,b,c,d){var e={supports_canvas:function(){return!!c.createElement("canvas").getContext},supports_canvas_text:function(){return e.supports_canvas()?"function"==typeof c.createElement("canvas").getContext("2d").fillText:!1},supports_webgl:function(){var a=c.createElement("canvas");try{if(a.getContext("webgl")||a.getContext("experimental-webgl"))return!0}catch(b){}return!1},supports_xhr2:function(){return b.support.cors},supports_touch:function(){return"ontouchstart"in d&&navigator.userAgent.match(/iPhone|iPad|iPod|Android|BlackBerry|BB10/i)},supports_gesture:function(){return"ongesturestart"in d}};return e}(ChemDoodle.iChemLabs,ChemDoodle.lib.jQuery,document,window),ChemDoodle.SYMBOLS="H He Li Be B C N O F Ne Na Mg Al Si P S Cl Ar K Ca Sc Ti V Cr Mn Fe Co Ni Cu Zn Ga Ge As Se Br Kr Rb Sr Y Zr Nb Mo Tc Ru Rh Pd Ag Cd In Sn Sb Te I Xe Cs Ba La Ce Pr Nd Pm Sm Eu Gd Tb Dy Ho Er Tm Yb Lu Hf Ta W Re Os Ir Pt Au Hg Tl Pb Bi Po At Rn Fr Ra Ac Th Pa U Np Pu Am Cm Bk Cf Es Fm Md No Lr Rf Db Sg Bh Hs Mt Ds Rg Cn Uut Uuq Uup Uuh Uus Uuo".split(" "),ChemDoodle.ELEMENT=function(){function a(a,b,c,d,e,f,g,h,i){this.symbol=a,this.name=b,this.atomicNumber=c,this.addH=d,this.jmolColor=this.pymolColor=e,this.covalentRadius=f,this.vdWRadius=g,this.valency=h,this.mass=i}var b=[];return b.H=new a("H","Hydrogen",1,!1,"#FFFFFF",.31,1.2,1,1),b.He=new a("He","Helium",2,!1,"#D9FFFF",.28,1.4,0,4),b.Li=new a("Li","Lithium",3,!1,"#CC80FF",1.28,1.82,1,7),b.Be=new a("Be","Beryllium",4,!1,"#C2FF00",.96,0,2,9),b.B=new a("B","Boron",5,!0,"#FFB5B5",.84,0,3,11),b.C=new a("C","Carbon",6,!0,"#909090",.76,1.7,4,12),b.N=new a("N","Nitrogen",7,!0,"#3050F8",.71,1.55,3,14),b.O=new a("O","Oxygen",8,!0,"#FF0D0D",.66,1.52,2,16),b.F=new a("F","Fluorine",9,!0,"#90E050",.57,1.47,1,19),b.Ne=new a("Ne","Neon",10,!1,"#B3E3F5",.58,1.54,0,20),b.Na=new a("Na","Sodium",11,!1,"#AB5CF2",1.66,2.27,1,23),b.Mg=new a("Mg","Magnesium",12,!1,"#8AFF00",1.41,1.73,0,24),b.Al=new a("Al","Aluminum",13,!1,"#BFA6A6",1.21,0,0,27),b.Si=new a("Si","Silicon",14,!0,"#F0C8A0",1.11,2.1,4,28),b.P=new a("P","Phosphorus",15,!0,"#FF8000",1.07,1.8,3,31),b.S=new a("S","Sulfur",16,!0,"#FFFF30",1.05,1.8,2,32),b.Cl=new a("Cl","Chlorine",17,!0,"#1FF01F",1.02,1.75,1,35),b.Ar=new a("Ar","Argon",18,!1,"#80D1E3",1.06,1.88,0,40),b.K=new a("K","Potassium",19,!1,"#8F40D4",2.03,2.75,0,39),b.Ca=new a("Ca","Calcium",20,!1,"#3DFF00",1.76,0,0,40),b.Sc=new a("Sc","Scandium",21,!1,"#E6E6E6",1.7,0,0,45),b.Ti=new a("Ti","Titanium",22,!1,"#BFC2C7",1.6,0,1,48),b.V=new a("V","Vanadium",23,!1,"#A6A6AB",1.53,0,1,51),b.Cr=new a("Cr","Chromium",24,!1,"#8A99C7",1.39,0,2,52),b.Mn=new a("Mn","Manganese",25,!1,"#9C7AC7",1.39,0,3,55),b.Fe=new a("Fe","Iron",26,!1,"#E06633",1.32,0,2,56),b.Co=new a("Co","Cobalt",27,!1,"#F090A0",1.26,0,1,59),b.Ni=new a("Ni","Nickel",28,!1,"#50D050",1.24,1.63,1,58),b.Cu=new a("Cu","Copper",29,!1,"#C88033",1.32,1.4,0,63),b.Zn=new a("Zn","Zinc",30,!1,"#7D80B0",1.22,1.39,0,64),b.Ga=new a("Ga","Gallium",31,!1,"#C28F8F",1.22,1.87,0,69),b.Ge=new a("Ge","Germanium",32,!1,"#668F8F",1.2,0,4,74),b.As=new a("As","Arsenic",33,!0,"#BD80E3",1.19,1.85,3,75),b.Se=new a("Se","Selenium",34,!0,"#FFA100",1.2,1.9,2,80),b.Br=new a("Br","Bromine",35,!0,"#A62929",1.2,1.85,1,79),b.Kr=new a("Kr","Krypton",36,!1,"#5CB8D1",1.16,2.02,0,84),b.Rb=new a("Rb","Rubidium",37,!1,"#702EB0",2.2,0,0,85),b.Sr=new a("Sr","Strontium",38,!1,"#00FF00",1.95,0,0,88),b.Y=new a("Y","Yttrium",39,!1,"#94FFFF",1.9,0,0,89),b.Zr=new a("Zr","Zirconium",40,!1,"#94E0E0",1.75,0,0,90),b.Nb=new a("Nb","Niobium",41,!1,"#73C2C9",1.64,0,1,93),b.Mo=new a("Mo","Molybdenum",42,!1,"#54B5B5",1.54,0,2,98),b.Tc=new a("Tc","Technetium",43,!1,"#3B9E9E",1.47,0,3,0),b.Ru=new a("Ru","Ruthenium",44,!1,"#248F8F",1.46,0,2,102),b.Rh=new a("Rh","Rhodium",45,!1,"#0A7D8C",1.42,0,1,103),b.Pd=new a("Pd","Palladium",46,!1,"#006985",1.39,1.63,0,106),b.Ag=new a("Ag","Silver",47,!1,"#C0C0C0",1.45,1.72,0,107),b.Cd=new a("Cd","Cadmium",48,!1,"#FFD98F",1.44,1.58,0,114),b.In=new a("In","Indium",49,!1,"#A67573",1.42,1.93,0,115),b.Sn=new a("Sn","Tin",50,!1,"#668080",1.39,2.17,4,120),b.Sb=new a("Sb","Antimony",51,!1,"#9E63B5",1.39,0,3,121),b.Te=new a("Te","Tellurium",52,!0,"#D47A00",1.38,2.06,2,130),b.I=new a("I","Iodine",53,!0,"#940094",1.39,1.98,1,127),b.Xe=new a("Xe","Xenon",54,!1,"#429EB0",1.4,2.16,0,132),b.Cs=new a("Cs","Cesium",55,!1,"#57178F",2.44,0,0,133),b.Ba=new a("Ba","Barium",56,!1,"#00C900",2.15,0,0,138),b.La=new a("La","Lanthanum",57,!1,"#70D4FF",2.07,0,0,139),b.Ce=new a("Ce","Cerium",58,!1,"#FFFFC7",2.04,0,0,140),b.Pr=new a("Pr","Praseodymium",59,!1,"#D9FFC7",2.03,0,0,141),b.Nd=new a("Nd","Neodymium",60,!1,"#C7FFC7",2.01,0,0,142),b.Pm=new a("Pm","Promethium",61,!1,"#A3FFC7",1.99,0,0,0),b.Sm=new a("Sm","Samarium",62,!1,"#8FFFC7",1.98,0,0,152),b.Eu=new a("Eu","Europium",63,!1,"#61FFC7",1.98,0,0,153),b.Gd=new a("Gd","Gadolinium",64,!1,"#45FFC7",1.96,0,0,158),b.Tb=new a("Tb","Terbium",65,!1,"#30FFC7",1.94,0,0,159),b.Dy=new a("Dy","Dysprosium",66,!1,"#1FFFC7",1.92,0,0,164),b.Ho=new a("Ho","Holmium",67,!1,"#00FF9C",1.92,0,0,165),b.Er=new a("Er","Erbium",68,!1,"#00E675",1.89,0,0,166),b.Tm=new a("Tm","Thulium",69,!1,"#00D452",1.9,0,0,169),b.Yb=new a("Yb","Ytterbium",70,!1,"#00BF38",1.87,0,0,174),b.Lu=new a("Lu","Lutetium",71,!1,"#00AB24",1.87,0,0,175),b.Hf=new a("Hf","Hafnium",72,!1,"#4DC2FF",1.75,0,0,180),b.Ta=new a("Ta","Tantalum",73,!1,"#4DA6FF",1.7,0,1,181),b.W=new a("W","Tungsten",74,!1,"#2194D6",1.62,0,2,184),b.Re=new a("Re","Rhenium",75,!1,"#267DAB",1.51,0,3,187),b.Os=new a("Os","Osmium",76,!1,"#266696",1.44,0,2,192),b.Ir=new a("Ir","Iridium",77,!1,"#175487",1.41,0,3,193),b.Pt=new a("Pt","Platinum",78,!1,"#D0D0E0",1.36,1.75,0,195),b.Au=new a("Au","Gold",79,!1,"#FFD123",1.36,1.66,1,197),b.Hg=new a("Hg","Mercury",80,!1,"#B8B8D0",1.32,1.55,0,202),b.Tl=new a("Tl","Thallium",81,!1,"#A6544D",1.45,1.96,0,205),b.Pb=new a("Pb","Lead",82,!1,"#575961",1.46,2.02,4,208),b.Bi=new a("Bi","Bismuth",83,!1,"#9E4FB5",1.48,0,3,209),b.Po=new a("Po","Polonium",84,!1,"#AB5C00",1.4,0,2,0),b.At=new a("At","Astatine",85,!0,"#754F45",1.5,0,1,0),b.Rn=new a("Rn","Radon",86,!1,"#428296",1.5,0,0,0),b.Fr=new a("Fr","Francium",87,!1,"#420066",2.6,0,0,0),b.Ra=new a("Ra","Radium",88,!1,"#007D00",2.21,0,0,0),b.Ac=new a("Ac","Actinium",89,!1,"#70ABFA",2.15,0,0,0),b.Th=new a("Th","Thorium",90,!1,"#00BAFF",2.06,0,0,232),b.Pa=new a("Pa","Protactinium",91,!1,"#00A1FF",2,0,0,231),b.U=new a("U","Uranium",92,!1,"#008FFF",1.96,1.86,0,238),b.Np=new a("Np","Neptunium",93,!1,"#0080FF",1.9,0,0,0),b.Pu=new a("Pu","Plutonium",94,!1,"#006BFF",1.87,0,0,0),b.Am=new a("Am","Americium",95,!1,"#545CF2",1.8,0,0,0),b.Cm=new a("Cm","Curium",96,!1,"#785CE3",1.69,0,0,0),b.Bk=new a("Bk","Berkelium",97,!1,"#8A4FE3",0,0,0,0),b.Cf=new a("Cf","Californium",98,!1,"#A136D4",0,0,0,0),b.Es=new a("Es","Einsteinium",99,!1,"#B31FD4",0,0,0,0),b.Fm=new a("Fm","Fermium",100,!1,"#B31FBA",0,0,0,0),b.Md=new a("Md","Mendelevium",101,!1,"#B30DA6",0,0,0,0),b.No=new a("No","Nobelium",102,!1,"#BD0D87",0,0,0,0),b.Lr=new a("Lr","Lawrencium",103,!1,"#C70066",0,0,0,0),b.Rf=new a("Rf","Rutherfordium",104,!1,"#CC0059",0,0,0,0),b.Db=new a("Db","Dubnium",105,!1,"#D1004F",0,0,0,0),b.Sg=new a("Sg","Seaborgium",106,!1,"#D90045",0,0,0,0),b.Bh=new a("Bh","Bohrium",107,!1,"#E00038",0,0,0,0),b.Hs=new a("Hs","Hassium",108,!1,"#E6002E",0,0,0,0),b.Mt=new a("Mt","Meitnerium",109,!1,"#EB0026",0,0,0,0),b.Ds=new a("Ds","Darmstadtium",110,!1,"#000000",0,0,0,0),b.Rg=new a("Rg","Roentgenium",111,!1,"#000000",0,0,0,0),b.Cn=new a("Cn","Copernicium",112,!1,"#000000",0,0,0,0),b.Uut=new a("Uut","Ununtrium",113,!1,"#000000",0,0,0,0),b.Uuq=new a("Uuq","Ununquadium",114,!1,"#000000",0,0,0,0),b.Uup=new a("Uup","Ununpentium",115,!1,"#000000",0,0,0,0),b.Uuh=new a("Uuh","Ununhexium",116,!1,"#000000",0,0,0,0),b.Uus=new a("Uus","Ununseptium",117,!1,"#000000",0,0,0,0),b.Uuo=new a("Uuo","Ununoctium",118,!1,"#000000",0,0,0,0),b.H.pymolColor="#E6E6E6",b.C.pymolColor="#33FF33",b.N.pymolColor="#3333FF",b.O.pymolColor="#FF4D4D",b.F.pymolColor="#B3FFFF",b.S.pymolColor="#E6C640",b}(ChemDoodle.SYMBOLS),ChemDoodle.RESIDUE=function(){function a(a,b,c,d,e,f){this.symbol=a,this.name=b,this.polar=c,this.aminoColor=d,this.shapelyColor=e,this.acidity=f}var b=[];return b.Ala=new a("Ala","Alanine",!1,"#C8C8C8","#8CFF8C",0),b.Arg=new a("Arg","Arginine",!0,"#145AFF","#00007C",1),b.Asn=new a("Asn","Asparagine",!0,"#00DCDC","#FF7C70",0),b.Asp=new a("Asp","Aspartic Acid",!0,"#E60A0A","#A00042",-1),b.Cys=new a("Cys","Cysteine",!0,"#E6E600","#FFFF70",0),b.Gln=new a("Gln","Glutamine",!0,"#00DCDC","#FF4C4C",0),b.Glu=new a("Glu","Glutamic Acid",!0,"#E60A0A","#660000",-1),b.Gly=new a("Gly","Glycine",!1,"#EBEBEB","#FFFFFF",0),b.His=new a("His","Histidine",!0,"#8282D2","#7070FF",1),b.Ile=new a("Ile","Isoleucine",!1,"#0F820F","#004C00",0),b.Leu=new a("Leu","Leucine",!1,"#0F820F","#455E45",0),b.Lys=new a("Lys","Lysine",!0,"#145AFF","#4747B8",1),b.Met=new a("Met","Methionine",!1,"#E6E600","#B8A042",0),b.Phe=new a("Phe","Phenylalanine",!1,"#3232AA","#534C52",0),b.Pro=new a("Pro","Proline",!1,"#DC9682","#525252",0),b.Ser=new a("Ser","Serine",!0,"#FA9600","#FF7042",0),b.Thr=new a("Thr","Threonine",!0,"#FA9600","#B84C00",0),b.Trp=new a("Trp","Tryptophan",!0,"#B45AB4","#4F4600",0),b.Tyr=new a("Tyr","Tyrosine",!0,"#3232AA","#8C704C",0),b.Val=new a("Val","Valine",!1,"#0F820F","#FF8CFF",0),b.Asx=new a("Asx","Asparagine/Aspartic Acid",!0,"#FF69B4","#FF00FF",0),b.Glx=new a("Glx","Glutamine/Glutamic Acid",!0,"#FF69B4","#FF00FF",0),b["*"]=new a("*","Other",!1,"#BEA06E","#FF00FF",0),b.A=new a("A","Adenine",!1,"#BEA06E","#A0A0FF",0),b.G=new a("G","Guanine",!1,"#BEA06E","#FF7070",0),b.I=new a("I","",!1,"#BEA06E","#80FFFF",0),b.C=new a("C","Cytosine",!1,"#BEA06E","#FF8C4B",0),b.T=new a("T","Thymine",!1,"#BEA06E","#A0FFA0",0),b.U=new a("U","Uracil",!1,"#BEA06E","#FF8080",0),b}(),function(a){a.Queue=function(){this.queue=[]},a=a.Queue.prototype,a.queueSpace=0,a.getSize=function(){return this.queue.length-this.queueSpace},a.isEmpty=function(){return 0===this.queue.length},a.enqueue=function(a){this.queue.push(a)},a.dequeue=function(){var a;return this.queue.length&&(a=this.queue[this.queueSpace],2*++this.queueSpace>=this.queue.length&&(this.queue=this.queue.slice(this.queueSpace),this.queueSpace=0)),a},a.getOldestElement=function(){var a;return this.queue.length&&(a=this.queue[this.queueSpace]),a}}(ChemDoodle.structures),function(a,b){a.Point=function(a,b){this.x=a?a:0,this.y=b?b:0};var c=a.Point.prototype;c.sub=function(a){this.x-=a.x,this.y-=a.y},c.add=function(a){this.x+=a.x,this.y+=a.y},c.distance=function(a){var c=a.x-this.x;return a=a.y-this.y,b.sqrt(c*c+a*a)},c.angleForStupidCanvasArcs=function(a){var d,c=a.x-this.x;for(a=a.y-this.y,d=0,d=0===c?0===a?0:a>0?b.PI/2:3*b.PI/2:0===a?c>0?0:b.PI:0>c?b.atan(a/c)+b.PI:0>a?b.atan(a/c)+2*b.PI:b.atan(a/c);0>d;)d+=2*b.PI;return d%=2*b.PI},c.angle=function(a){var d,c=a.x-this.x;for(a=this.y-a.y,d=0,d=0===c?0===a?0:a>0?b.PI/2:3*b.PI/2:0===a?c>0?0:b.PI:0>c?b.atan(a/c)+b.PI:0>a?b.atan(a/c)+2*b.PI:b.atan(a/c);0>d;)d+=2*b.PI;return d%=2*b.PI}}(ChemDoodle.structures,Math),function(a,b,c,d,e,f){d.Atom=function(b,c,d,e){this.label=b?b.replace(/\s/g,""):"C",a[this.label]||(this.label="C"),this.x=c?c:0,this.y=d?d:0,this.z=e?e:0},d=d.Atom.prototype=new d.Point(0,0),d.charge=0,d.numLonePair=0,d.numRadical=0,d.mass=-1,d.coordinationNumber=0,d.bondNumber=0,d.angleOfLeastInterference=0,d.isHidden=!1,d.altLabel=void 0,d.any=!1,d.rgroup=-1,d.isLone=!1,d.isHover=!1,d.isSelected=!1,d.add3D=function(a){this.x+=a.x,this.y+=a.y,this.z+=a.z},d.sub3D=function(a){this.x-=a.x,this.y-=a.y,this.z-=a.z},d.distance3D=function(a){var b=a.x-this.x,c=a.y-this.y;return a=a.z-this.z,e.sqrt(b*b+c*c+a*a)},d.draw=function(a,d){var f,g,h,i,j,k,l,m,n,o,p,q;if(this.isLassoed&&(f=a.createRadialGradient(this.x-1,this.y-1,0,this.x,this.y,7),f.addColorStop(0,"rgba(212, 99, 0, 0)"),f.addColorStop(.7,"rgba(212, 99, 0, 0.8)"),a.fillStyle=f,a.beginPath(),a.arc(this.x,this.y,5,0,2*e.PI,!1),a.fill()),this.textBounds=[],this.specs&&(d=this.specs),g=b.getFontString(d.atoms_font_size_2D,d.atoms_font_families_2D,d.atoms_font_bold_2D,d.atoms_font_italic_2D),a.font=g,a.fillStyle=this.getElementColor(d.atoms_useJMOLColors,d.atoms_usePYMOLColors,d.atoms_color,2),"H"===this.label&&d.atoms_HBlack_2D&&(a.fillStyle="black"),this.isLone&&!d.atoms_displayAllCarbonLabels_2D||d.atoms_circles_2D?(a.beginPath(),a.arc(this.x,this.y,d.atoms_circleDiameter_2D/2,0,2*e.PI,!1),a.fill(),0<d.atoms_circleBorderWidth_2D&&(a.lineWidth=d.atoms_circleBorderWidth_2D,a.strokeStyle="black",a.stroke())):this.isLabelVisible(d)&&(a.textAlign="center",a.textBaseline="middle",void 0!==this.altLabel?(a.fillText(this.altLabel,this.x,this.y),i=a.measureText(this.altLabel).width,this.textBounds.push({x:this.x-i/2,y:this.y-d.atoms_font_size_2D/2+1,w:i,h:d.atoms_font_size_2D-2})):this.any?(a.font=b.getFontString(d.atoms_font_size_2D+5,d.atoms_font_families_2D,!0),a.fillText("*",this.x+1,this.y+3),i=a.measureText("*").width,this.textBounds.push({x:this.x-i/2,y:this.y-d.atoms_font_size_2D/2+1,w:i,h:d.atoms_font_size_2D-2})):-1!==this.rgroup?(f="R"+this.rgroup,a.fillText(f,this.x,this.y),i=a.measureText(f).width,this.textBounds.push({x:this.x-i/2,y:this.y-d.atoms_font_size_2D/2+1,w:i,h:d.atoms_font_size_2D-2})):(a.fillText(this.label,this.x,this.y),i=a.measureText(this.label).width,this.textBounds.push({x:this.x-i/2,y:this.y-d.atoms_font_size_2D/2+1,w:i,h:d.atoms_font_size_2D-2}),j=0,-1!==this.mass&&(f=a.font,a.font=b.getFontString(.7*d.atoms_font_size_2D,d.atoms_font_families_2D,d.atoms_font_bold_2D,d.atoms_font_italic_2D),j=a.measureText(this.mass).width,a.fillText(this.mass,this.x-j-.5,this.y-d.atoms_font_size_2D/2+1),this.textBounds.push({x:this.x-i/2-j-.5,y:this.y-1.7*d.atoms_font_size_2D/2+1,w:j,h:d.atoms_font_size_2D/2-1}),a.font=f),f=i/2,k=this.getImplicitHydrogenCount(),d.atoms_implicitHydrogens_2D&&k>0&&(h=0,l=a.measureText("H").width,m=!0,k>1?(n=i/2+l/2,o=0,p=b.getFontString(.8*d.atoms_font_size_2D,d.atoms_font_families_2D,d.atoms_font_bold_2D,d.atoms_font_italic_2D),a.font=p,q=a.measureText(k).width,1===this.bondNumber?this.angleOfLeastInterference>e.PI/2&&this.angleOfLeastInterference<3*e.PI/2&&(n=-i/2-q-l/2-j/2,m=!1,h=e.PI):this.angleOfLeastInterference<=e.PI/4||(this.angleOfLeastInterference<3*e.PI/4?(n=0,o=.9*-d.atoms_font_size_2D,0!==this.charge&&(o-=.3*d.atoms_font_size_2D),m=!1,h=e.PI/2):this.angleOfLeastInterference<=5*e.PI/4?(n=-i/2-q-l/2-j/2,m=!1,h=e.PI):this.angleOfLeastInterference<7*e.PI/4&&(n=0,o=.9*d.atoms_font_size_2D,m=!1,h=3*e.PI/2)),a.font=g,a.fillText("H",this.x+n,this.y+o),a.font=p,a.fillText(k,this.x+n+l/2+q/2,this.y+o+.3*d.atoms_font_size_2D),this.textBounds.push({x:this.x+n-l/2,y:this.y+o-d.atoms_font_size_2D/2+1,w:l,h:d.atoms_font_size_2D-2}),this.textBounds.push({x:this.x+n+l/2,y:this.y+o+.3*d.atoms_font_size_2D-d.atoms_font_size_2D/2+1,w:q,h:.8*d.atoms_font_size_2D-2})):(n=i/2+l/2,o=0,1===this.bondNumber?this.angleOfLeastInterference>e.PI/2&&this.angleOfLeastInterference<3*e.PI/2&&(n=-i/2-l/2-j/2,m=!1,h=e.PI):this.angleOfLeastInterference<=e.PI/4||(this.angleOfLeastInterference<3*e.PI/4?(n=0,o=.9*-d.atoms_font_size_2D,m=!1,h=e.PI/2):this.angleOfLeastInterference<=5*e.PI/4?(n=-i/2-l/2-j/2,m=!1,h=e.PI):this.angleOfLeastInterference<7*e.PI/4&&(n=0,o=.9*d.atoms_font_size_2D,m=!1,h=3*e.PI/2)),a.fillText("H",this.x+n,this.y+o),this.textBounds.push({x:this.x+n-l/2,y:this.y+o-d.atoms_font_size_2D/2+1,w:l,h:d.atoms_font_size_2D-2})),m&&(f+=l)),0!==this.charge&&(g=this.charge.toFixed(0),g="1"===g?"+":"-1"===g?"C":b.stringStartsWith(g,"-")?g.substring(1)+"C":g+"+",i=a.measureText(g).width,f+=i/2,a.textAlign="center",a.textBaseline="middle",a.font=b.getFontString(e.floor(.8*d.atoms_font_size_2D),d.atoms_font_families_2D,d.atoms_font_bold_2D,d.atoms_font_italic_2D),a.fillText(g,this.x+f-1,this.y-d.atoms_font_size_2D/2+1),this.textBounds.push({x:this.x+f-i/2-1,y:this.y-1.8*d.atoms_font_size_2D/2+5,w:i,h:d.atoms_font_size_2D/2-1})))),0<this.numLonePair||0<this.numRadical){for(a.fillStyle="black",k=this.angles.slice(0),f=this.angleOfLeastInterference,g=this.largestAngle,void 0!==h&&(k.push(h),k.sort(),g=c.angleBetweenLargest(k),f=g.angle%(2*e.PI),g=g.largest),i=[],j=0;j<this.numLonePair;j++)i.push({t:2});for(j=0;j<this.numRadical;j++)i.push({t:1});if(void 0===h&&e.abs(g-2*e.PI/k.length)<e.PI/60)for(k=e.ceil(i.length/k.length),j=0,l=i.length;l>j;j+=k,f+=g)this.drawElectrons(a,d,i.slice(j,e.min(i.length,j+k)),f,g,h);else this.drawElectrons(a,d,i,f,g,h)}},d.drawElectrons=function(a,b,c,d,f,g){var h,i,j,k;for(g=f/(c.length+(0===this.bonds.length&&void 0===g?0:1)),f=d-f/2+g,h=0;h<c.length;h++)i=c[h],d=f+h*g,j=this.x+Math.cos(d)*b.atoms_lonePairDistance_2D,k=this.y-Math.sin(d)*b.atoms_lonePairDistance_2D,2===i.t?(i=d+Math.PI/2,d=Math.cos(i)*b.atoms_lonePairSpread_2D/2,i=-Math.sin(i)*b.atoms_lonePairSpread_2D/2,a.beginPath(),a.arc(j+d,k+i,b.atoms_lonePairDiameter_2D,0,2*e.PI,!1),a.fill(),a.beginPath(),a.arc(j-d,k-i,b.atoms_lonePairDiameter_2D,0,2*e.PI,!1),a.fill()):1===i.t&&(a.beginPath(),a.arc(j,k,b.atoms_lonePairDiameter_2D,0,2*e.PI,!1),a.fill())},d.drawDecorations=function(a){(this.isHover||this.isSelected)&&(a.strokeStyle=this.isHover?"#885110":"#0060B2",a.lineWidth=1.2,a.beginPath(),a.arc(this.x,this.y,this.isHover?7:15,0,2*e.PI,!1),a.stroke()),this.isOverlap&&(a.strokeStyle="#C10000",a.lineWidth=1.2,a.beginPath(),a.arc(this.x,this.y,7,0,2*e.PI,!1),a.stroke())},d.render=function(b,c,d){this.specs&&(c=this.specs);var e=f.translate(b.modelViewMatrix,[this.x,this.y,this.z],[]),g=c.atoms_useVDWDiameters_3D?a[this.label].vdWRadius*c.atoms_vdwMultiplier_3D:c.atoms_sphereDiameter_3D/2;0===g&&(g=1),f.scale(e,[g,g,g]),d||(d=c.atoms_color,c.atoms_useJMOLColors?d=a[this.label].jmolColor:c.atoms_usePYMOLColors&&(d=a[this.label].pymolColor),b.material.setDiffuseColor(d)),b.setMatrixUniforms(e),b.drawElements(b.TRIANGLES,(this.renderAsStar?b.starBuffer:b.sphereBuffer).vertexIndexBuffer.numItems,b.UNSIGNED_SHORT,0)},d.renderHighlight=function(b,c){if(this.isSelected||this.isHover){this.specs&&(c=this.specs);var d=f.translate(b.modelViewMatrix,[this.x,this.y,this.z],[]),e=c.atoms_useVDWDiameters_3D?a[this.label].vdWRadius*c.atoms_vdwMultiplier_3D:c.atoms_sphereDiameter_3D/2;0===e&&(e=1),e*=1.3,f.scale(d,[e,e,e]),b.setMatrixUniforms(d),b.material.setDiffuseColor(this.isHover?"#885110":"#0060B2"),b.drawElements(b.TRIANGLES,(this.renderAsStar?b.starBuffer:b.sphereBuffer).vertexIndexBuffer.numItems,b.UNSIGNED_SHORT,0)}},d.isLabelVisible=function(a){return a.atoms_displayAllCarbonLabels_2D||"C"!==this.label||this.altLabel||this.any||-1!==this.rgroup||-1!==this.mass||0!==this.charge||a.atoms_showAttributedCarbons_2D&&(0!==this.numRadical||0!==this.numLonePair)||this.isHidden&&a.atoms_showHiddenCarbons_2D||a.atoms_displayTerminalCarbonLabels_2D&&1===this.bondNumber?!0:!1},d.getImplicitHydrogenCount=function(){if("H"===this.label||!a[this.label]||!a[this.label].addH)return 0;var b=a[this.label].valency,c=b-this.coordinationNumber;return 0<this.numRadical&&(c=e.max(0,c-this.numRadical)),0<this.charge?(b=4-b,c=this.charge<=b?c+this.charge:4-this.coordinationNumber-this.charge+b):c+=this.charge,0>c?0:e.floor(c)},d.getBounds=function(){var b,d,e,a=new c.Bounds;if(a.expand(this.x,this.y),this.textBounds)for(b=0,d=this.textBounds.length;d>b;b++)e=this.textBounds[b],a.expand(e.x,e.y,e.x+e.w,e.y+e.h);return a},d.getBounds3D=function(){var a=new c.Bounds;return a.expand3D(this.x,this.y,this.z),a},d.getElementColor=function(b,c,d,e){return 2==e&&this.any||-1!==this.rgroup?d:(b?d=a[this.label].jmolColor:c&&(d=a[this.label].pymolColor),d)}}(ChemDoodle.ELEMENT,ChemDoodle.extensions,ChemDoodle.math,ChemDoodle.structures,Math,ChemDoodle.lib.mat4),function(a,b,c,d,e,f,g){c.Bond=function(a,b,c){this.a1=a,this.a2=b,this.bondOrder=void 0!==c?c:1},c.Bond.STEREO_NONE="none",c.Bond.STEREO_PROTRUDING="protruding",c.Bond.STEREO_RECESSED="recessed",c.Bond.STEREO_AMBIGUOUS="ambiguous",a=c.Bond.prototype,a.stereo=c.Bond.STEREO_NONE,a.isHover=!1,a.ring=void 0,a.getCenter=function(){return new c.Point((this.a1.x+this.a2.x)/2,(this.a1.y+this.a2.y)/2)},a.getLength=function(){return this.a1.distance(this.a2)},a.getLength3D=function(){return this.a1.distance3D(this.a2)},a.contains=function(a){return a===this.a1||a===this.a2},a.getNeighbor=function(a){return a===this.a1?this.a2:a===this.a2?this.a1:void 0},a.draw=function(a,f){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w;if(this.a1.x!==this.a2.x||this.a1.y!==this.a2.y){if(this.specs&&(f=this.specs),g=this.a1.x,h=this.a2.x,i=this.a1.y,j=this.a2.y,k=this.a1.distance(this.a2),l=h-g,m=j-i,this.a1.isLassoed&&this.a2.isLassoed&&(n=a.createLinearGradient(g,i,h,j),n.addColorStop(0,"rgba(212, 99, 0, 0)"),n.addColorStop(.5,"rgba(212, 99, 0, 0.8)"),n.addColorStop(1,"rgba(212, 99, 0, 0)"),o=2.5,p=this.a1.angle(this.a2)+e.PI/2,q=e.cos(p),p=e.sin(p),r=g-q*o,s=i+p*o,t=g+q*o,u=i-p*o,v=h+q*o,w=j-p*o,q=h-q*o,p=j+p*o,a.fillStyle=n,a.beginPath(),a.moveTo(r,s),a.lineTo(t,u),a.lineTo(v,w),a.lineTo(q,p),a.closePath(),a.fill()),f.atoms_display&&!f.atoms_circles_2D&&this.a1.isLabelVisible(f)&&this.a1.textBounds){for(o=q=0,r=this.a1.textBounds.length;r>o;o++)q=Math.max(q,d.calculateDistanceInterior(this.a1,this.a2,this.a1.textBounds[o]));q+=f.bonds_atomLabelBuffer_2D,q/=k,g+=l*q,i+=m*q}if(f.atoms_display&&!f.atoms_circles_2D&&this.a2.isLabelVisible(f)&&this.a2.textBounds){for(o=q=0,r=this.a2.textBounds.length;r>o;o++)q=Math.max(q,d.calculateDistanceInterior(this.a2,this.a1,this.a2.textBounds[o]));q+=f.bonds_atomLabelBuffer_2D,q/=k,h-=l*q,j-=m*q}if(f.bonds_clearOverlaps_2D&&(q=g+.15*l,p=i+.15*m,o=h-.15*l,k=j-.15*m,a.strokeStyle=f.backgroundColor,a.lineWidth=f.bonds_width_2D+2*f.bonds_overlapClearWidth_2D,a.lineCap="round",a.beginPath(),a.moveTo(q,p),a.lineTo(o,k),a.closePath(),a.stroke()),a.strokeStyle=f.bonds_color,a.fillStyle=f.bonds_color,a.lineWidth=f.bonds_width_2D,a.lineCap=f.bonds_ends_2D,(f.bonds_useJMOLColors||f.bonds_usePYMOLColors)&&(q=a.createLinearGradient(g,i,h,j),p=this.a1.getElementColor(f.bonds_useJMOLColors,f.bonds_usePYMOLColors,f.atoms_color,2),o=this.a2.getElementColor(f.bonds_useJMOLColors,f.bonds_usePYMOLColors,f.atoms_color,2),q.addColorStop(0,p),f.bonds_colorGradient||(q.addColorStop(.5,p),q.addColorStop(.51,o)),q.addColorStop(1,o),a.strokeStyle=q,a.fillStyle=q),f.bonds_lewisStyle_2D&&0===this.bondOrder%1)this.drawLewisStyle(a,f,g,i,h,j);else switch(this.bondOrder){case 0:for(h-=g,j-=i,h=e.sqrt(h*h+j*j),j=e.floor(h/f.bonds_dotSize_2D),h=(h-(j-1)*f.bonds_dotSize_2D)/2,1===j%2?h+=f.bonds_dotSize_2D/4:(h-=f.bonds_dotSize_2D/4,j+=2),j/=2,m=this.a1.angle(this.a2),q=g+h*Math.cos(m),p=i-h*Math.sin(m),a.beginPath(),o=0;j>o;o++)a.arc(q,p,f.bonds_dotSize_2D/2,0,2*e.PI,!1),q+=2*f.bonds_dotSize_2D*Math.cos(m),p-=2*f.bonds_dotSize_2D*Math.sin(m);a.fill();break;case.5:a.beginPath(),a.moveTo(g,i),b.contextHashTo(a,g,i,h,j,f.bonds_hashSpacing_2D,f.bonds_hashSpacing_2D),a.stroke();break;case 1:if(this.stereo===c.Bond.STEREO_PROTRUDING||this.stereo===c.Bond.STEREO_RECESSED)m=f.bonds_width_2D/2,o=this.a1.distance(this.a2)*f.bonds_wedgeThickness_2D/2,p=this.a1.angle(this.a2)+e.PI/2,q=e.cos(p),p=e.sin(p),r=g-q*m,s=i+p*m,t=g+q*m,u=i-p*m,v=h+q*o,w=j-p*o,q=h-q*o,p=j+p*o,a.beginPath(),a.moveTo(r,s),a.lineTo(t,u),a.lineTo(v,w),a.lineTo(q,p),a.closePath(),this.stereo===c.Bond.STEREO_PROTRUDING?a.fill():(a.save(),a.clip(),a.lineWidth=2*o,a.lineCap="butt",a.beginPath(),a.moveTo(g,i),b.contextHashTo(a,g,i,h,j,f.bonds_hashWidth_2D,f.bonds_hashSpacing_2D),a.stroke(),a.restore());else{if(this.stereo===c.Bond.STEREO_AMBIGUOUS){for(a.beginPath(),a.moveTo(g,i),h=e.floor(e.sqrt(l*l+m*m)/f.bonds_wavyLength_2D),p=this.a1.angle(this.a2)+e.PI/2,q=e.cos(p),p=e.sin(p),j=l/h,m/=h,o=0,r=h;r>o;o++)g+=j,i+=m,h=f.bonds_wavyLength_2D*q+g-.5*j,k=f.bonds_wavyLength_2D*-p+i-.5*m,l=f.bonds_wavyLength_2D*-q+g-.5*j,s=f.bonds_wavyLength_2D*p+i-.5*m,0===o%2?a.quadraticCurveTo(h,k,g,i):a.quadraticCurveTo(l,s,g,i);a.stroke();break}a.beginPath(),a.moveTo(g,i),a.lineTo(h,j),a.stroke()}break;case 1.5:case 2:this.stereo===c.Bond.STEREO_AMBIGUOUS?(o=this.a1.distance(this.a2)*f.bonds_saturationWidth_2D/2,p=this.a1.angle(this.a2)+e.PI/2,q=e.cos(p),p=e.sin(p),r=g-q*o,s=i+p*o,t=g+q*o,u=i-p*o,v=h+q*o,w=j-p*o,q=h-q*o,p=j+p*o,a.beginPath(),a.moveTo(r,s),a.lineTo(v,w),a.moveTo(t,u),a.lineTo(q,p),a.stroke()):!f.bonds_symmetrical_2D&&(this.ring||"C"===this.a1.label&&"C"===this.a2.label)?(a.beginPath(),a.moveTo(g,i),a.lineTo(h,j),q=0,k=this.a1.distance(this.a2),m=this.a1.angle(this.a2),p=m+e.PI/2,o=k*f.bonds_saturationWidth_2D,l=f.bonds_saturationAngle_2D,l<e.PI/2&&(q=-(o/e.tan(l))),e.abs(q)<k/2&&(l=g-e.cos(m)*q,g=h+e.cos(m)*q,h=i+e.sin(m)*q,i=j-e.sin(m)*q,q=e.cos(p),p=e.sin(p),r=l-q*o,s=h+p*o,t=l+q*o,u=h-p*o,v=g-q*o,w=i+p*o,q=g+q*o,p=i-p*o,!this.ring||this.ring.center.angle(this.a1)>this.ring.center.angle(this.a2)&&!(this.ring.center.angle(this.a1)-this.ring.center.angle(this.a2)>e.PI)||this.ring.center.angle(this.a1)-this.ring.center.angle(this.a2)<-e.PI?(a.moveTo(r,s),2===this.bondOrder?a.lineTo(v,w):b.contextHashTo(a,r,s,v,w,f.bonds_hashSpacing_2D,f.bonds_hashSpacing_2D)):(a.moveTo(t,u),2===this.bondOrder?a.lineTo(q,p):b.contextHashTo(a,t,u,q,p,f.bonds_hashSpacing_2D,f.bonds_hashSpacing_2D)),a.stroke())):(o=this.a1.distance(this.a2)*f.bonds_saturationWidth_2D/2,p=this.a1.angle(this.a2)+e.PI/2,q=e.cos(p),p=e.sin(p),r=g-q*o,s=i+p*o,t=g+q*o,u=i-p*o,v=h+q*o,w=j-p*o,q=h-q*o,p=j+p*o,a.beginPath(),a.moveTo(r,s),a.lineTo(q,p),a.moveTo(t,u),2===this.bondOrder?a.lineTo(v,w):b.contextHashTo(a,t,u,v,w,f.bonds_hashSpacing_2D,f.bonds_hashSpacing_2D),a.stroke());break;case 3:o=this.a1.distance(this.a2)*f.bonds_saturationWidth_2D,p=this.a1.angle(this.a2)+e.PI/2,q=e.cos(p),p=e.sin(p),r=g-q*o,s=i+p*o,t=g+q*o,u=i-p*o,v=h+q*o,w=j-p*o,q=h-q*o,p=j+p*o,a.beginPath(),a.moveTo(r,s),a.lineTo(q,p),a.moveTo(t,u),a.lineTo(v,w),a.moveTo(g,i),a.lineTo(h,j),a.stroke()}}},a.drawDecorations=function(a){var b,c,d;(this.isHover||this.isSelected)&&(b=2*e.PI,c=(this.a1.angleForStupidCanvasArcs(this.a2)+e.PI/2)%b,a.strokeStyle=this.isHover?"#885110":"#0060B2",a.lineWidth=1.2,a.beginPath(),d=(c+e.PI)%b,d%=2*e.PI,a.arc(this.a1.x,this.a1.y,7,c,d,!1),a.stroke(),a.beginPath(),c+=e.PI,d=(c+e.PI)%b,a.arc(this.a2.x,this.a2.y,7,c,d,!1),a.stroke())},a.drawLewisStyle=function(a,b,c,d,f,g){var j,k,l,m,h=this.a1.angle(this.a2),i=h+e.PI/2;for(f-=c,g-=d,f=e.sqrt(f*f+g*g)/(this.bondOrder+1),g=f*e.cos(h),h=-f*e.sin(h),c+=g,d+=h,f=0;f<this.bondOrder;f++)j=b.atoms_lonePairSpread_2D/2,k=c-e.cos(i)*j,l=d+e.sin(i)*j,m=c+e.cos(i)*j,j=d-e.sin(i)*j,a.beginPath(),a.arc(k-b.atoms_lonePairDiameter_2D/2,l-b.atoms_lonePairDiameter_2D/2,b.atoms_lonePairDiameter_2D,0,2*e.PI,!1),a.fill(),a.beginPath(),a.arc(m-b.atoms_lonePairDiameter_2D/2,j-b.atoms_lonePairDiameter_2D/2,b.atoms_lonePairDiameter_2D,0,2*e.PI,!1),a.fill(),c+=g,d+=h},a.render=function(a,c,d){var h,k,m,i,j,l,n,o,p,q,r,s,t,u,v,w,x,y,z;if(this.specs&&(c=this.specs),h=this.a1.distance3D(this.a2),0!==h)if(i=c.bonds_cylinderDiameter_3D/2,j=c.bonds_color,l=f.translate(a.modelViewMatrix,[this.a1.x,this.a1.y,this.a1.z],[]),n=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z],o=[0,1,0],p=0,this.a1.x===this.a2.x&&this.a1.z===this.a2.z?(o=[0,0,1],this.a2.y<this.a1.y&&(p=e.PI)):(p=b.vec3AngleFrom(o,n),o=g.cross(o,n,[])),q=c.bonds_useJMOLColors,r=c.bonds_usePYMOLColors,(q||r)&&(j=this.a1.getElementColor(q,r,j),k=this.a2.getElementColor(q,r,c.bonds_color),j!=k&&(m=f.translate(a.modelViewMatrix,[this.a2.x,this.a2.y,this.a2.z],[]))),q=[0],d)for(c.bonds_showBondOrders_3D&&1<this.bondOrder&&(q=[c.bonds_cylinderDiameter_3D],s=[0,0,1],d=f.inverse(a.rotationMatrix,[]),f.multiplyVec3(d,s),s=g.cross(n,s,[]),g.normalize(s)),i=1,t=c.bonds_pillSpacing_3D,n=c.bonds_pillHeight_3D,0==this.bondOrder&&(c.bonds_renderAsLines_3D?n=t:(n=c.bonds_pillDiameter_3D,n<c.bonds_cylinderDiameter_3D&&(n/=2),i=n/2,h/=i,t/=i/2)),d=n+t,r=e.floor(h/d),u=(t+c.bonds_pillDiameter_3D+(h-d*r))/2,v=r,m&&(v=e.floor(r/2)),h=0,t=q.length;t>h;h++){for(w=f.set(l,[]),0!==q[h]&&f.translate(w,g.scale(s,q[h],[])),0!==p&&f.rotate(w,p,o),1!=i&&f.scale(w,[i,i,i]),j&&a.material.setDiffuseColor(j),f.translate(w,[0,u,0]),x=0;v>x;x++)c.bonds_renderAsLines_3D?0==this.bondOrder?(a.setMatrixUniforms(w),a.drawArrays(a.POINTS,0,1)):(f.scale(w,[1,n,1]),a.setMatrixUniforms(w),a.drawArrays(a.LINES,0,a.lineBuffer.vertexPositionBuffer.numItems),f.scale(w,[1,1/n,1])):(a.setMatrixUniforms(w),0==this.bondOrder?a.drawElements(a.TRIANGLES,a.sphereBuffer.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0):a.drawElements(a.TRIANGLES,a.pillBuffer.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0)),f.translate(w,[0,d,0]);
if(m){for(c.bonds_renderAsLines_3D?(y=n,y/=2,z=0):(y=2/3,z=(1-y)/2),0!=r%2&&(f.scale(w,[1,y,1]),a.setMatrixUniforms(w),c.bonds_renderAsLines_3D?0==this.bondOrder?a.drawArrays(a.POINTS,0,1):a.drawArrays(a.LINES,0,a.lineBuffer.vertexPositionBuffer.numItems):0==this.bondOrder?a.drawElements(a.TRIANGLES,a.sphereBuffer.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0):a.drawElements(a.TRIANGLES,a.pillBuffer.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0),f.translate(w,[0,d*(1+z),0]),f.scale(w,[1,1/y,1])),f.set(m,w),0!==q[h]&&f.translate(w,g.scale(s,q[h],[])),f.rotate(w,p+e.PI,o),1!=i&&f.scale(w,[i,i,i]),k&&a.material.setDiffuseColor(k),f.translate(w,[0,u,0]),x=0;v>x;x++)c.bonds_renderAsLines_3D?0==this.bondOrder?(a.setMatrixUniforms(w),a.drawArrays(a.POINTS,0,1)):(f.scale(w,[1,n,1]),a.setMatrixUniforms(w),a.drawArrays(a.LINES,0,a.lineBuffer.vertexPositionBuffer.numItems),f.scale(w,[1,1/n,1])):(a.setMatrixUniforms(w),0==this.bondOrder?a.drawElements(a.TRIANGLES,a.sphereBuffer.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0):a.drawElements(a.TRIANGLES,a.pillBuffer.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0)),f.translate(w,[0,d,0]);0!=r%2&&(f.scale(w,[1,y,1]),a.setMatrixUniforms(w),c.bonds_renderAsLines_3D?0==this.bondOrder?a.drawArrays(a.POINTS,0,1):a.drawArrays(a.LINES,0,a.lineBuffer.vertexPositionBuffer.numItems):0==this.bondOrder?a.drawElements(a.TRIANGLES,a.sphereBuffer.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0):a.drawElements(a.TRIANGLES,a.pillBuffer.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0),f.translate(w,[0,d*(1+z),0]),f.scale(w,[1,1/y,1]))}}else{if(c.bonds_showBondOrders_3D){switch(this.bondOrder){case 1.5:q=[-c.bonds_cylinderDiameter_3D];break;case 2:q=[-c.bonds_cylinderDiameter_3D,c.bonds_cylinderDiameter_3D];break;case 3:q=[-1.2*c.bonds_cylinderDiameter_3D,0,1.2*c.bonds_cylinderDiameter_3D]}1<this.bondOrder&&(s=[0,0,1],d=f.inverse(a.rotationMatrix,[]),f.multiplyVec3(d,s),s=g.cross(n,s,[]),g.normalize(s))}else switch(this.bondOrder){case 0:i*=.25;break;case.5:case 1.5:i*=.5}for(m&&(h/=2),i=[i,h,i],h=0,t=q.length;t>h;h++)w=f.set(l,[]),0!==q[h]&&f.translate(w,g.scale(s,q[h],[])),0!==p&&f.rotate(w,p,o),f.scale(w,i),j&&a.material.setDiffuseColor(j),a.setMatrixUniforms(w),c.bonds_renderAsLines_3D?a.drawArrays(a.LINES,0,a.lineBuffer.vertexPositionBuffer.numItems):a.drawArrays(a.TRIANGLE_STRIP,0,a.cylinderBuffer.vertexPositionBuffer.numItems),m&&(f.set(m,w),0!==q[h]&&f.translate(w,g.scale(s,q[h],[])),f.rotate(w,p+e.PI,o),f.scale(w,i),k&&a.material.setDiffuseColor(k),a.setMatrixUniforms(w),c.bonds_renderAsLines_3D?a.drawArrays(a.LINES,0,a.lineBuffer.vertexPositionBuffer.numItems):a.drawArrays(a.TRIANGLE_STRIP,0,a.cylinderBuffer.vertexPositionBuffer.numItems))}},a.renderHighlight=function(a,c){var d,h,i,j,k,l;(this.isSelected||this.isHover)&&(this.specs&&(c=this.specs),this.specs&&(c=this.specs),d=this.a1.distance3D(this.a2),0!==d&&(h=c.bonds_cylinderDiameter_3D/1.2,i=f.translate(a.modelViewMatrix,[this.a1.x,this.a1.y,this.a1.z],[]),j=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z],k=[0,1,0],l=0,this.a1.x===this.a2.x&&this.a1.z===this.a2.z?(j=[0,0,1],this.a2.y<this.a1.y&&(l=e.PI)):(l=b.vec3AngleFrom(k,j),j=g.cross(k,j,[])),d=[h,d,h],0!==l&&f.rotate(i,l,j),f.scale(i,d),a.setMatrixUniforms(i),a.material.setDiffuseColor(this.isHover?"#885110":"#0060B2"),a.drawArrays(a.TRIANGLE_STRIP,0,a.cylinderBuffer.vertexPositionBuffer.numItems)))},a.renderPicker=function(a,c){var d,h,i,j,k,l,n,m,o;if(this.specs&&(c=this.specs),d=this.a1.distance3D(this.a2),0!==d){if(h=c.bonds_cylinderDiameter_3D/2,i=f.translate(a.modelViewMatrix,[this.a1.x,this.a1.y,this.a1.z],[]),j=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z],k=[0,1,0],l=0,this.a1.x===this.a2.x&&this.a1.z===this.a2.z?(k=[0,0,1],this.a2.y<this.a1.y&&(l=e.PI)):(l=b.vec3AngleFrom(k,j),k=g.cross(k,j,[])),m=[0],c.bonds_showBondOrders_3D)if(c.bonds_renderAsLines_3D){switch(this.bondOrder){case 1.5:case 2:m=[-c.bonds_cylinderDiameter_3D,c.bonds_cylinderDiameter_3D];break;case 3:m=[-1.2*c.bonds_cylinderDiameter_3D,0,1.2*c.bonds_cylinderDiameter_3D]}1<this.bondOrder&&(n=[0,0,1],o=f.inverse(a.rotationMatrix,[]),f.multiplyVec3(o,n),n=g.cross(j,n,[]),g.normalize(n))}else switch(this.bondOrder){case 1.5:case 2:h*=3;break;case 3:h*=3.4}else switch(this.bondOrder){case 0:h*=.25;break;case.5:case 1.5:h*=.5}for(d=[h,d,h],h=0,j=m.length;j>h;h++)o=f.set(i,[]),0!==m[h]&&f.translate(o,g.scale(n,m[h],[])),0!==l&&f.rotate(o,l,k),f.scale(o,d),a.setMatrixUniforms(o),c.bonds_renderAsLines_3D?a.drawArrays(a.LINES,0,a.lineBuffer.vertexPositionBuffer.numItems):a.drawArrays(a.TRIANGLE_STRIP,0,a.cylinderBuffer.vertexPositionBuffer.numItems)}}}(ChemDoodle.ELEMENT,ChemDoodle.extensions,ChemDoodle.structures,ChemDoodle.math,Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3),function(a,b){a.Ring=function(){this.atoms=[],this.bonds=[]};var c=a.Ring.prototype;c.center=void 0,c.setupBonds=function(){for(var a=0,b=this.bonds.length;b>a;a++)this.bonds[a].ring=this;this.center=this.getCenter()},c.getCenter=function(){for(var c=1/0,d=1/0,e=-1/0,f=-1/0,g=0,h=this.atoms.length;h>g;g++)c=b.min(this.atoms[g].x,c),d=b.min(this.atoms[g].y,d),e=b.max(this.atoms[g].x,e),f=b.max(this.atoms[g].y,f);return new a.Point((e+c)/2,(f+d)/2)}}(ChemDoodle.structures,Math),function(a,b,c,d,e){c.Molecule=function(){this.atoms=[],this.bonds=[],this.rings=[]};var f=c.Molecule.prototype;f.findRings=!0,f.draw=function(a,b){if(this.specs&&(b=this.specs),b.atoms_display&&!b.atoms_circles_2D)for(var c=0,d=this.atoms.length;d>c;c++)this.atoms[c].draw(a,b);if(b.bonds_display)for(c=0,d=this.bonds.length;d>c;c++)this.bonds[c].draw(a,b);if(b.atoms_display&&b.atoms_circles_2D)for(c=0,d=this.atoms.length;d>c;c++)this.atoms[c].draw(a,b)},f.render=function(a,e){var f,g,h,i,j,k,l;if(this.specs&&(e=this.specs),f=0<this.atoms.length&&void 0!==this.atoms[0].hetatm){if(e.macro_displayBonds)for(0<this.bonds.length&&(e.bonds_renderAsLines_3D&&!this.residueSpecs||this.residueSpecs&&this.residueSpecs.bonds_renderAsLines_3D?(a.lineWidth(this.residueSpecs?this.residueSpecs.bonds_width_2D:e.bonds_width_2D),a.lineBuffer.bindBuffers(a)):a.cylinderBuffer.bindBuffers(a),a.material.setTempColors(e.bonds_materialAmbientColor_3D,void 0,e.bonds_materialSpecularColor_3D,e.bonds_materialShininess_3D)),g=0,h=this.bonds.length;h>g;g++)i=this.bonds[g],!i.a1.hetatm&&(-1===e.macro_atomToLigandDistance||void 0!==i.a1.closestDistance&&e.macro_atomToLigandDistance>=i.a1.closestDistance&&e.macro_atomToLigandDistance>=i.a2.closestDistance)&&i.render(a,this.residueSpecs?this.residueSpecs:e);if(e.macro_displayAtoms)for(0<this.atoms.length&&(a.sphereBuffer.bindBuffers(a),a.material.setTempColors(e.atoms_materialAmbientColor_3D,void 0,e.atoms_materialSpecularColor_3D,e.atoms_materialShininess_3D)),g=0,h=this.atoms.length;h>g;g++)i=this.atoms[g],!i.hetatm&&(-1===e.macro_atomToLigandDistance||void 0!==i.closestDistance&&e.macro_atomToLigandDistance>=i.closestDistance)&&i.render(a,this.residueSpecs?this.residueSpecs:e)}if(e.bonds_display){for(j=[],k=[],0<this.bonds.length&&(e.bonds_renderAsLines_3D?(a.lineWidth(e.bonds_width_2D),a.lineBuffer.bindBuffers(a)):a.cylinderBuffer.bindBuffers(a),a.material.setTempColors(e.bonds_materialAmbientColor_3D,void 0,e.bonds_materialSpecularColor_3D,e.bonds_materialShininess_3D)),g=0,h=this.bonds.length;h>g;g++)i=this.bonds[g],(!f||i.a1.hetatm)&&(e.bonds_showBondOrders_3D?0==i.bondOrder?k.push(i):.5==i.bondOrder?j.push(i):(1.5==i.bondOrder&&j.push(i),i.render(a,e)):i.render(a,e));if(0<j.length)for(e.bonds_renderAsLines_3D||a.pillBuffer.bindBuffers(a),g=0,h=j.length;h>g;g++)j[g].render(a,e,!0);if(0<k.length)for(e.bonds_renderAsLines_3D||a.sphereBuffer.bindBuffers(a),g=0,h=k.length;h>g;g++)k[g].render(a,e,!0)}if(e.atoms_display){for(g=0,h=this.atoms.length;h>g;g++)i=this.atoms[g],i.bondNumber=0,i.renderAsStar=!1;for(g=0,h=this.bonds.length;h>g;g++)i=this.bonds[g],i.a1.bondNumber++,i.a2.bondNumber++;for(0<this.atoms.length&&(a.sphereBuffer.bindBuffers(a),a.material.setTempColors(e.atoms_materialAmbientColor_3D,void 0,e.atoms_materialSpecularColor_3D,e.atoms_materialShininess_3D)),j=[],g=0,h=this.atoms.length;h>g;g++)i=this.atoms[g],(!f||i.hetatm&&(e.macro_showWater||!i.isWater))&&(e.atoms_nonBondedAsStars_3D&&0===i.bondNumber?(i.renderAsStar=!0,j.push(i)):i.render(a,e));if(0<j.length)for(a.starBuffer.bindBuffers(a),g=0,h=j.length;h>g;g++)j[g].render(a,e)}if(this.chains){if(a.setMatrixUniforms(a.modelViewMatrix),e.proteins_displayRibbon)for(a.material.setTempColors(e.proteins_materialAmbientColor_3D,void 0,e.proteins_materialSpecularColor_3D,e.proteins_materialShininess_3D),f=0,j=this.ribbons.length;j>f;f++)if(i=e.proteins_ribbonCartoonize?this.cartoons[f]:this.ribbons[f],"none"!==e.proteins_residueColor){for(i.front.bindBuffers(a),k="rainbow"===e.proteins_residueColor,g=0,h=i.front.segments.length;h>g;g++)k&&a.material.setDiffuseColor(b.rainbowAt(g,h,e.macro_rainbowColors)),i.front.segments[g].render(a,e);for(i.back.bindBuffers(a),g=0,h=i.back.segments.length;h>g;g++)k&&a.material.setDiffuseColor(b.rainbowAt(g,h,e.macro_rainbowColors)),i.back.segments[g].render(a,e)}else if(e.proteins_ribbonCartoonize){for(i.front.bindBuffers(a),g=0,h=i.front.cartoonSegments.length;h>g;g++)i.front.cartoonSegments[g].render(a,e);for(i.back.bindBuffers(a),g=0,h=i.back.cartoonSegments.length;h>g;g++)i.back.cartoonSegments[g].render(a,e)}else i.front.render(a,e),i.back.render(a,e);if(e.proteins_displayBackbone){if(!this.alphaCarbonTrace)for(this.alphaCarbonTrace={nodes:[],edges:[]},f=0,j=this.chains.length;j>f;f++)if(k=this.chains[f],!(2<k.length&&d[k[2].name]&&"#BEA06E"===d[k[2].name].aminoColor)&&0<k.length)for(g=1,h=k.length-2;h>g;g++)i=k[g].cp1,i.chainColor=k.chainColor,this.alphaCarbonTrace.nodes.push(i),i=new c.Bond(k[g].cp1,k[g+1].cp1),i.residueName=k[g].name,i.chainColor=k.chainColor,this.alphaCarbonTrace.edges.push(i),g===k.length-3&&(i=k[g+1].cp1,i.chainColor=k.chainColor,this.alphaCarbonTrace.nodes.push(i));if(0<this.alphaCarbonTrace.nodes.length){for(f=new c.VisualSpecifications,f.atoms_display=!0,f.bonds_display=!0,f.atoms_sphereDiameter_3D=e.proteins_backboneThickness,f.bonds_cylinderDiameter_3D=e.proteins_backboneThickness,f.bonds_useJMOLColors=!1,f.atoms_color=e.proteins_backboneColor,f.bonds_color=e.proteins_backboneColor,f.atoms_useVDWDiameters_3D=!1,a.material.setTempColors(e.proteins_materialAmbientColor_3D,void 0,e.proteins_materialSpecularColor_3D,e.proteins_materialShininess_3D),a.material.setDiffuseColor(e.proteins_backboneColor),g=0,h=this.alphaCarbonTrace.nodes.length;h>g;g++)i=this.alphaCarbonTrace.nodes[g],e.macro_colorByChain&&(f.atoms_color=i.chainColor),a.sphereBuffer.bindBuffers(a),i.render(a,f);for(g=0,h=this.alphaCarbonTrace.edges.length;h>g;g++)i=this.alphaCarbonTrace.edges[g],j=d[i.residueName]?d[i.residueName]:d["*"],e.macro_colorByChain?l=i.chainColor:"shapely"===e.proteins_residueColor?l=j.shapelyColor:"amino"===e.proteins_residueColor?l=j.aminoColor:"polarity"===e.proteins_residueColor?l=j.polar?"#C10000":"#FFFFFF":"acidity"===e.proteins_residueColor?l=1===j.acidity?"#0000FF":-1===j.acidity?"#FF0000":j.polar?"#FFFFFF":"#773300":"rainbow"===e.proteins_residueColor&&(l=b.rainbowAt(g,h,e.macro_rainbowColors)),l&&(f.bonds_color=l),a.cylinderBuffer.bindBuffers(a),i.render(a,f)}}if(e.nucleics_display)for(a.material.setTempColors(e.nucleics_materialAmbientColor_3D,void 0,e.nucleics_materialSpecularColor_3D,e.nucleics_materialShininess_3D),f=0,j=this.tubes.length;j>f;f++)a.setMatrixUniforms(a.modelViewMatrix),i=this.tubes[f],i.render(a,e)}if(e.crystals_displayUnitCell&&this.unitCell&&(a.setMatrixUniforms(a.modelViewMatrix),this.unitCell.bindBuffers(a),a.material.setDiffuseColor(e.crystals_unitCellColor),a.lineWidth(e.crystals_unitCellLineWidth),a.drawElements(a.LINES,this.unitCell.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0)),e.atoms_display){for(l=!1,g=0,h=this.atoms.length;h>g;g++)if(i=this.atoms[g],i.isHover||i.isSelected){l=!0;break}if(!l)for(g=0,h=this.bonds.length;h>g;g++)if(i=this.bonds[g],i.isHover||i.isSelected){l=!0;break}if(l){for(a.sphereBuffer.bindBuffers(a),a.blendFunc(a.SRC_ALPHA,a.ONE),a.material.setTempColors(e.atoms_materialAmbientColor_3D,void 0,"#000000",0),a.enable(a.BLEND),a.depthMask(!1),a.material.setAlpha(.4),a.sphereBuffer.bindBuffers(a),g=0,h=this.atoms.length;h>g;g++)i=this.atoms[g],(i.isHover||i.isSelected)&&i.renderHighlight(a,e);for(a.cylinderBuffer.bindBuffers(a),g=0,h=this.bonds.length;h>g;g++)i=this.bonds[g],(i.isHover||i.isSelected)&&i.renderHighlight(a,e);a.depthMask(!0),a.disable(a.BLEND),a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA)}}this.surface&&e.surfaces_display&&(a.setMatrixUniforms(a.modelViewMatrix),this.surface.bindBuffers(a),a.material.setTempColors(e.surfaces_materialAmbientColor_3D,e.surfaces_color,e.surfaces_materialSpecularColor_3D,e.surfaces_materialShininess_3D),"Dot"===e.surfaces_style?a.drawArrays(a.POINTS,0,this.surface.vertexPositionBuffer.numItems):a.drawElements(a.TRIANGLES,this.surface.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0))},f.renderPickFrame=function(a,c,d,e,f){var g,h,i;if(this.specs&&(c=this.specs),g=0<this.atoms.length&&void 0!==this.atoms[0].hetatm,f&&c.bonds_display)for(0<this.bonds.length&&(c.bonds_renderAsLines_3D?(a.lineWidth(c.bonds_width_2D),a.lineBuffer.bindBuffers(a)):a.cylinderBuffer.bindBuffers(a)),f=0,h=this.bonds.length;h>f;f++)i=this.bonds[f],(!g||i.a1.hetatm)&&(a.material.setDiffuseColor(b.idx2color(d.length)),i.renderPicker(a,c),d.push(i));if(e&&c.atoms_display){for(f=0,h=this.atoms.length;h>f;f++)e=this.atoms[f],e.bondNumber=0,e.renderAsStar=!1;for(f=0,h=this.bonds.length;h>f;f++)i=this.bonds[f],i.a1.bondNumber++,i.a2.bondNumber++;for(0<this.atoms.length&&a.sphereBuffer.bindBuffers(a),i=[],f=0,h=this.atoms.length;h>f;f++)e=this.atoms[f],(!g||e.hetatm&&(c.macro_showWater||!e.isWater))&&(c.atoms_nonBondedAsStars_3D&&0===e.bondNumber?(e.renderAsStar=!0,i.push(e)):(a.material.setDiffuseColor(b.idx2color(d.length)),e.render(a,c,!0),d.push(e)));if(0<i.length)for(a.starBuffer.bindBuffers(a),f=0,h=i.length;h>f;f++)e=i[f],a.material.setDiffuseColor(b.idx2color(d.length)),e.render(a,c,!0),d.push(e)}},f.getCenter3D=function(){var a,b,d,f,g,h,i,j,k,l,m,n;if(1===this.atoms.length)return new c.Atom("C",this.atoms[0].x,this.atoms[0].y,this.atoms[0].z);if(a=1/0,b=1/0,d=1/0,f=-1/0,g=-1/0,h=-1/0,this.chains)for(i=0,j=this.chains.length;j>i;i++)for(k=this.chains[i],l=0,m=k.length;m>l;l++)n=k[l],a=e.min(n.cp1.x,n.cp2.x,a),b=e.min(n.cp1.y,n.cp2.y,b),d=e.min(n.cp1.z,n.cp2.z,d),f=e.max(n.cp1.x,n.cp2.x,f),g=e.max(n.cp1.y,n.cp2.y,g),h=e.max(n.cp1.z,n.cp2.z,h);for(i=0,j=this.atoms.length;j>i;i++)a=e.min(this.atoms[i].x,a),b=e.min(this.atoms[i].y,b),d=e.min(this.atoms[i].z,d),f=e.max(this.atoms[i].x,f),g=e.max(this.atoms[i].y,g),h=e.max(this.atoms[i].z,h);return new c.Atom("C",(f+a)/2,(g+b)/2,(h+d)/2)},f.getCenter=function(){if(1===this.atoms.length)return new c.Point(this.atoms[0].x,this.atoms[0].y);for(var a=1/0,b=1/0,d=-1/0,f=-1/0,g=0,h=this.atoms.length;h>g;g++)a=e.min(this.atoms[g].x,a),b=e.min(this.atoms[g].y,b),d=e.max(this.atoms[g].x,d),f=e.max(this.atoms[g].y,f);return new c.Point((d+a)/2,(f+b)/2)},f.getDimension=function(){var a,b,d,f,g,h,i,j,k,l;if(1===this.atoms.length)return new c.Point(0,0);if(a=1/0,b=1/0,d=-1/0,f=-1/0,this.chains){for(g=0,h=this.chains.length;h>g;g++)for(i=this.chains[g],j=0,k=i.length;k>j;j++)l=i[j],a=e.min(l.cp1.x,l.cp2.x,a),b=e.min(l.cp1.y,l.cp2.y,b),d=e.max(l.cp1.x,l.cp2.x,d),f=e.max(l.cp1.y,l.cp2.y,f);a-=30,b-=30,d+=30,f+=30}for(g=0,h=this.atoms.length;h>g;g++)a=e.min(this.atoms[g].x,a),b=e.min(this.atoms[g].y,b),d=e.max(this.atoms[g].x,d),f=e.max(this.atoms[g].y,f);return new c.Point(d-a,f-b)},f.check=function(b){var c,d,e,f,g;if(b&&this.doChecks){if(this.findRings)if(this.bonds.length-this.atoms.length!==this.fjNumCache){for(this.rings=new a.informatics.SSSRFinder(this).rings,c=0,d=this.bonds.length;d>c;c++)this.bonds[c].ring=void 0;for(c=0,d=this.rings.length;d>c;c++)this.rings[c].setupBonds()}else for(c=0,d=this.rings.length;d>c;c++)e=this.rings[c],e.center=e.getCenter();for(c=0,d=this.atoms.length;d>c;c++)if(this.atoms[c].isLone=!1,"C"===this.atoms[c].label){for(f=e=0,g=this.bonds.length;g>f;f++)(this.bonds[f].a1===this.atoms[c]||this.bonds[f].a2===this.atoms[c])&&e++;0===e&&(this.atoms[c].isLone=!0)}for(e=!1,c=0,d=this.atoms.length;d>c;c++)0!==this.atoms[c].z&&(e=!0);e&&(this.sortAtomsByZ(),this.sortBondsByZ()),this.setupMetaData(),this.atomNumCache=this.atoms.length,this.bondNumCache=this.bonds.length,this.fjNumCache=this.bonds.length-this.atoms.length}this.doChecks=!b},f.getAngles=function(a){for(var b=[],c=0,d=this.bonds.length;d>c;c++)this.bonds[c].contains(a)&&b.push(a.angle(this.bonds[c].getNeighbor(a)));return b.sort(),b},f.getCoordinationNumber=function(a){for(var b=0,c=0,d=a.length;d>c;c++)b+=a[c].bondOrder;return b},f.getBonds=function(a){for(var b=[],c=0,d=this.bonds.length;d>c;c++)this.bonds[c].contains(a)&&b.push(this.bonds[c]);return b},f.sortAtomsByZ=function(){var a,b,c,d;for(a=1,b=this.atoms.length;b>a;a++)for(c=a;c>0&&this.atoms[c].z<this.atoms[c-1].z;)d=this.atoms[c],this.atoms[c]=this.atoms[c-1],this.atoms[c-1]=d,c--},f.sortBondsByZ=function(){var a,b,c,d;for(a=1,b=this.bonds.length;b>a;a++)for(c=a;c>0&&this.bonds[c].a1.z+this.bonds[c].a2.z<this.bonds[c-1].a1.z+this.bonds[c-1].a2.z;)d=this.bonds[c],this.bonds[c]=this.bonds[c-1],this.bonds[c-1]=d,c--},f.setupMetaData=function(){var a,c,d,f,g;for(a=this.getCenter(),c=0,d=this.atoms.length;d>c;c++)f=this.atoms[c],f.bonds=this.getBonds(f),f.angles=this.getAngles(f),f.isHidden=2===f.bonds.length&&e.abs(e.abs(f.angles[1]-f.angles[0])-e.PI)<e.PI/30&&f.bonds[0].bondOrder===f.bonds[1].bondOrder,g=b.angleBetweenLargest(f.angles),f.angleOfLeastInterference=g.angle%(2*e.PI),f.largestAngle=g.largest,f.coordinationNumber=this.getCoordinationNumber(f.bonds),f.bondNumber=f.bonds.length,f.molCenter=a;for(c=0,d=this.bonds.length;d>c;c++)this.bonds[c].molCenter=a},f.scaleToAverageBondLength=function(a){var c,b=this.getAverageBondLength();if(0!==b)for(a/=b,b=0,c=this.atoms.length;c>b;b++)this.atoms[b].x*=a,this.atoms[b].y*=a},f.getAverageBondLength=function(){if(0===this.bonds.length)return 0;for(var a=0,b=0,c=this.bonds.length;c>b;b++)a+=this.bonds[b].getLength();return a/=this.bonds.length},f.getBounds=function(){var a,c,d,e,f,g,h;for(a=new b.Bounds,c=0,d=this.atoms.length;d>c;c++)a.expand(this.atoms[c].getBounds());if(this.chains){for(c=0,d=this.chains.length;d>c;c++)for(e=this.chains[c],f=0,g=e.length;g>f;f++)h=e[f],a.expand(h.cp1.x,h.cp1.y),a.expand(h.cp2.x,h.cp2.y);a.minX-=30,a.minY-=30,a.maxX+=30,a.maxY+=30}return a},f.getBounds3D=function(){var a,c,d,e,f,g,h;for(a=new b.Bounds,c=0,d=this.atoms.length;d>c;c++)a.expand(this.atoms[c].getBounds3D());if(this.chains)for(c=0,d=this.chains.length;d>c;c++)for(e=this.chains[c],f=0,g=e.length;g>f;f++)h=e[f],a.expand3D(h.cp1.x,h.cp1.y,h.cp1.z),a.expand3D(h.cp2.x,h.cp2.y,h.cp2.z);return a}}(ChemDoodle,ChemDoodle.math,ChemDoodle.structures,ChemDoodle.RESIDUE,Math),function(a,b,c,d){var e,g,f=-1;a.Residue=function(a){this.resSeq=a},g=a.Residue.prototype,g.setup=function(b,c){this.horizontalResolution=c;var e=[b.x-this.cp1.x,b.y-this.cp1.y,b.z-this.cp1.z],f=d.cross(e,[this.cp2.x-this.cp1.x,this.cp2.y-this.cp1.y,this.cp2.z-this.cp1.z],[]);for(this.D=d.cross(f,e,[]),d.normalize(f),d.normalize(this.D),this.guidePointsSmall=[],this.guidePointsLarge=[],e=[(b.x+this.cp1.x)/2,(b.y+this.cp1.y)/2,(b.z+this.cp1.z)/2],this.helix&&(d.scale(f,1.5),d.add(e,f)),this.guidePointsSmall[0]=new a.Atom("",e[0]-this.D[0]/2,e[1]-this.D[1]/2,e[2]-this.D[2]/2),f=1;c>f;f++)this.guidePointsSmall[f]=new a.Atom("",this.guidePointsSmall[0].x+this.D[0]*f/c,this.guidePointsSmall[0].y+this.D[1]*f/c,this.guidePointsSmall[0].z+this.D[2]*f/c);for(d.scale(this.D,4),this.guidePointsLarge[0]=new a.Atom("",e[0]-this.D[0]/2,e[1]-this.D[1]/2,e[2]-this.D[2]/2),f=1;c>f;f++)this.guidePointsLarge[f]=new a.Atom("",this.guidePointsLarge[0].x+this.D[0]*f/c,this.guidePointsLarge[0].y+this.D[1]*f/c,this.guidePointsLarge[0].z+this.D[2]*f/c)},g.getGuidePointSet=function(a){return 0===a?this.helix||this.sheet?this.guidePointsLarge:this.guidePointsSmall:1===a?this.guidePointsSmall:2===a?this.guidePointsLarge:void 0},g.computeLineSegments=function(a,b,d,g,h){if(h!==f){var i=h*h,j=h*h*h;e=c.multiply([-1/6,.5,-.5,1/6,.5,-1,.5,0,-.5,0,.5,0,1/6,2/3,1/6,0],[6/j,0,0,0,6/j,2/i,0,0,1/j,1/i,1/h,0,0,0,0,1],[]),f=h}this.split=b.helix!==this.helix||b.sheet!==this.sheet,this.lineSegments=this.innerCompute(0,a,b,d,!1,h),g&&(this.lineSegmentsCartoon=this.innerCompute(b.helix||b.sheet?2:1,a,b,d,!0,h))},g.innerCompute=function(f,g,h,i,j,k){var n,o,p,q,r,s,l=[],m=this.getGuidePointSet(f);for(g=g.getGuidePointSet(f),h=h.getGuidePointSet(f),n=i.getGuidePointSet(f),o=0,p=this.guidePointsLarge.length;p>o;o++){for(q=c.multiply([g[o].x,g[o].y,g[o].z,1,m[o].x,m[o].y,m[o].z,1,h[o].x,h[o].y,h[o].z,1,n[o].x,n[o].y,n[o].z,1],e,[]),r=[],s=0;k>s;s++){for(f=3;f>0;f--)for(i=0;4>i;i++)q[4*f+i]+=q[4*(f-1)+i];r[s]=new a.Atom("",q[12]/q[15],q[13]/q[15],q[14]/q[15])}l[o]=r}if(j&&this.arrow)for(f=0;k>f;f++)for(j=1.5-1.3*f/k,m=b.floor(this.horizontalResolution/2),g=l[m],i=0,h=l.length;h>i;i++)i!==m&&(n=g[f],o=l[i][f],p=[o.x-n.x,o.y-n.y,o.z-n.z],d.scale(p,j),o.x=n.x+p[0],o.y=n.y+p[1],o.z=n.z+p[2]);return l}}(ChemDoodle.structures,Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3),function(a,b,c,d,e){b.Spectrum=function(){this.data=[],this.metadata=[],this.dataDisplay=[],this.memory={offsetTop:0,offsetLeft:0,offsetBottom:0,flipXAxis:!1,scale:1,width:0,height:0}},d=b.Spectrum.prototype,d.title=void 0,d.xUnit=void 0,d.yUnit=void 0,d.continuous=!0,d.integrationSensitivity=.01,d.draw=function(b,c,d,f){var g,h,i,j,k,l,m,n,o,p,q;for(this.specs&&(c=this.specs),g=5,h=0,i=0,b.fillStyle=c.text_color,b.textAlign="center",b.textBaseline="alphabetic",b.font=a.getFontString(c.text_font_size,c.text_font_families),this.xUnit&&(i+=c.text_font_size,b.fillText(this.xUnit,d/2,f-2)),this.yUnit&&c.plots_showYAxis&&(h+=c.text_font_size,b.save(),b.translate(c.text_font_size,f/2),b.rotate(-e.PI/2),b.fillText(this.yUnit,0,0),b.restore()),this.title&&(g+=c.text_font_size,b.fillText(this.title,d/2,c.text_font_size)),i+=5+c.text_font_size,c.plots_showYAxis&&(h+=5+b.measureText("1000").width),c.plots_showGrid&&(b.strokeStyle=c.plots_gridColor,b.lineWidth=c.plots_gridLineWidth,b.strokeRect(h,g,d-h,f-i-g)),b.textAlign="center",b.textBaseline="top",j=this.maxX-this.minX,k=j/100,l=.001;k>l||j/l>25;)l*=10;for(m=0,n=c.plots_flipXAxis?d:0,j=e.round(this.minX/l)*l;j<=this.maxX;j+=l/2){if(o=this.getTransformedX(j,c,d,h),o>h)if(b.strokeStyle="black",b.lineWidth=1,0===m%2){for(b.beginPath(),b.moveTo(o,f-i),b.lineTo(o,f-i+2),b.stroke(),k=j.toFixed(5);"0"===k.charAt(k.length-1);)k=k.substring(0,k.length-1);"."===k.charAt(k.length-1)&&(k=k.substring(0,k.length-1)),p=b.measureText(k).width,c.plots_flipXAxis&&(p*=-1),q=o-p/2,(c.plots_flipXAxis?n>q:q>n)&&(b.fillText(k,o,f-i+2),n=o+p/2),c.plots_showGrid&&(b.strokeStyle=c.plots_gridColor,b.lineWidth=c.plots_gridLineWidth,b.beginPath(),b.moveTo(o,f-i),b.lineTo(o,g),b.stroke())}else b.beginPath(),b.moveTo(o,f-i),b.lineTo(o,f-i+2),b.stroke();m++}if(c.plots_showYAxis||c.plots_showGrid)for(l=1/c.scale,b.textAlign="right",b.textBaseline="middle",j=0;10>=j;j++)if(k=l/10*j,m=g+(f-i-g)*(1-k*c.scale),c.plots_showGrid&&(b.strokeStyle=c.plots_gridColor,b.lineWidth=c.plots_gridLineWidth,b.beginPath(),b.moveTo(h,m),b.lineTo(d,m),b.stroke()),c.plots_showYAxis){if(b.strokeStyle="black",b.lineWidth=1,b.beginPath(),b.moveTo(h,m),b.lineTo(h-3,m),b.stroke(),k*=100,n=e.max(0,3-e.floor(k).toString().length),k=k.toFixed(n),n>0)for(;"0"===k.charAt(k.length-1);)k=k.substring(0,k.length-1);"."===k.charAt(k.length-1)&&(k=k.substring(0,k.length-1)),b.fillText(k,h-3,m)}if(b.strokeStyle="black",b.lineWidth=1,b.beginPath(),b.moveTo(d,f-i),b.lineTo(h,f-i),c.plots_showYAxis&&b.lineTo(h,g),b.stroke(),0<this.dataDisplay.length)for(b.textAlign="left",b.textBaseline="top",j=k=0,l=this.dataDisplay.length;l>j;j++)if(this.dataDisplay[j].value)b.fillText([this.dataDisplay[j].display,": ",this.dataDisplay[j].value].join(""),h+10,g+10+k*(c.text_font_size+5)),k++;else if(this.dataDisplay[j].tag)for(m=0,n=this.metadata.length;n>m;m++)if(a.stringStartsWith(this.metadata[m],this.dataDisplay[j].tag)){n=this.metadata[m],this.dataDisplay[j].display&&(n=this.metadata[m].indexOf("="),n=[this.dataDisplay[j].display,": ",n>-1?this.metadata[m].substring(n+2):this.metadata[m]].join("")),b.fillText(n,h+10,g+10+k*(c.text_font_size+5)),k++;break}this.drawPlot(b,c,d,f,g,h,i),this.memory.offsetTop=g,this.memory.offsetLeft=h,this.memory.offsetBottom=i,this.memory.flipXAxis=c.plots_flipXAxis,this.memory.scale=c.scale,this.memory.width=d,this.memory.height=f},d.drawPlot=function(a,c,d,f,g,h,i){var j,k,l,m,n,o,q,p,r;if(this.specs&&(c=this.specs),a.strokeStyle=c.plots_color,a.lineWidth=c.plots_width,j=[],a.beginPath(),this.continuous)for(k=!1,l=0,m=!1,n=0,o=this.data.length;o>n;n++)if(p=this.getTransformedX(this.data[n].x,c,d,h),o>n&&!k&&(q=this.getTransformedX(this.data[n+1].x,c,d,h)),p>=h&&d>p||void 0!==q&&q>=h&&d>q){if(r=this.getTransformedY(this.data[n].y,c,f,i,g),c.plots_showIntegration&&e.abs(this.data[n].y)>this.integrationSensitivity&&j.push(new b.Point(this.data[n].x,this.data[n].y)),k||(a.moveTo(p,r),k=!0),a.lineTo(p,r),l++,0===l%1e3&&(a.stroke(),a.beginPath(),a.moveTo(p,r)),m)break}else k&&(m=!0);else for(n=0,o=this.data.length;o>n;n++)p=this.getTransformedX(this.data[n].x,c,d,h),p>=h&&d>p&&(a.moveTo(p,f-i),a.lineTo(p,this.getTransformedY(this.data[n].y,c,f,i,g)));if(a.stroke(),c.plots_showIntegration&&1<j.length){if(a.strokeStyle=c.plots_integrationColor,a.lineWidth=c.plots_integrationLineWidth,a.beginPath(),n=j[1].x>j[0].x,this.flipXAxis&&!n||!this.flipXAxis&&n){for(n=j.length-2;n>=0;n--)j[n].y+=j[n+1].y;k=j[0].y}else{for(n=1,o=j.length;o>n;n++)j[n].y+=j[n-1].y;k=j[j.length-1].y}for(n=0,o=j.length;o>n;n++)p=this.getTransformedX(j[n].x,c,d,h),r=this.getTransformedY(j[n].y/c.scale/k,c,f,i,g),0===n?a.moveTo(p,r):a.lineTo(p,r);a.stroke()}},d.getTransformedY=function(a,b,c,d,e){return e+(c-d-e)*(1-a*b.scale)},d.getInverseTransformedY=function(a){return 100*((1-(a-this.memory.offsetTop)/(this.memory.height-this.memory.offsetBottom-this.memory.offsetTop))/this.memory.scale)},d.getTransformedX=function(a,b,c,d){return a=d+(a-this.minX)/(this.maxX-this.minX)*(c-d),b.plots_flipXAxis&&(a=c+d-a),a},d.getInverseTransformedX=function(a){return this.memory.flipXAxis&&(a=this.memory.width+this.memory.offsetLeft-a),(a-this.memory.offsetLeft)*(this.maxX-this.minX)/(this.memory.width-this.memory.offsetLeft)+this.minX},d.setup=function(){for(var a=Number.MAX_VALUE,b=Number.MIN_VALUE,c=Number.MIN_VALUE,d=0,f=this.data.length;f>d;d++)a=e.min(a,this.data[d].x),b=e.max(b,this.data[d].x),c=e.max(c,this.data[d].y);for(this.continuous?(this.minX=a,this.maxX=b):(this.minX=a-1,this.maxX=b+1),d=0,f=this.data.length;f>d;d++)this.data[d].y/=c},d.zoom=function(a,b,d,f){if(a=this.getInverseTransformedX(a),b=this.getInverseTransformedX(b),this.minX=e.min(a,b),this.maxX=e.max(a,b),f){for(f=Number.MIN_VALUE,b=0,a=this.data.length;a>b;b++)c.isBetween(this.data[b].x,this.minX,this.maxX)&&(f=e.max(f,this.data[b].y));return 1/f}},d.translate=function(a,b){var c=a/(b-this.memory.offsetLeft)*(this.maxX-this.minX)*(this.memory.flipXAxis?1:-1);this.minX+=c,this.maxX+=c},d.alertMetadata=function(){alert(this.metadata.join("\n"))},d.getInternalCoordinates=function(a,b){return new ChemDoodle.structures.Point(this.getInverseTransformedX(a),this.getInverseTransformedY(b))},d.getClosestPlotInternalCoordinates=function(a){var d,e,f,g,h,i,b=this.getInverseTransformedX(a-1);for(a=this.getInverseTransformedX(a+1),b>a&&(d=b,b=a,a=d),d=-1,e=-1/0,f=!1,g=0,h=this.data.length;h>g;g++)if(i=this.data[g],c.isBetween(i.x,b,a))i.y>e&&(f=!0,e=i.y,d=g);else if(f)break;return-1!==d?(i=this.data[d],new ChemDoodle.structures.Point(i.x,100*i.y)):void 0},d.getClosestPeakInternalCoordinates=function(a){var c,d,f,g,b=this.getInverseTransformedX(a);for(a=0,c=1/0,d=0,f=this.data.length;f>d&&(g=e.abs(this.data[d].x-b),c>=g);d++)c=g,a=d;for(b=highestRight=a,c=maxRight=this.data[a].y,d=a+1,f=this.data.length;f>d&&this.data[d].y+.05>maxRight;d++)maxRight=this.data[d].y,highestRight=d;for(d=a-1;d>=0&&this.data[d].y+.05>c;d--)c=this.data[d].y,b=d;return a=this.data[b-a>highestRight-a?highestRight:b],new ChemDoodle.structures.Point(a.x,100*a.y)}}(ChemDoodle.extensions,ChemDoodle.structures,ChemDoodle.math,ChemDoodle.lib.jQuery,Math),function(a,b,c){b._Shape=function(){},b=b._Shape.prototype,b.drawDecorations=function(a,b){var c,d,e,f;if(this.isHover)for(c=this.getPoints(),d=0,e=c.length;e>d;d++)f=c[d],this.drawAnchor(a,b,f,f===this.hoverPoint)},b.getBounds=function(){var b,c,d,e,f;for(b=new a.Bounds,c=this.getPoints(),d=0,e=c.length;e>d;d++)f=c[d],b.expand(f.x,f.y);return b},b.drawAnchor=function(a,b,d,e){a.save(),a.translate(d.x,d.y),a.rotate(c.PI/4),a.scale(1/b.scale,1/b.scale),a.beginPath(),a.moveTo(-4,-4),a.lineTo(4,-4),a.lineTo(4,4),a.lineTo(-4,4),a.closePath(),a.fillStyle=e?"#885110":"white",a.fill(),a.beginPath(),a.moveTo(-4,-2),a.lineTo(-4,-4),a.lineTo(-2,-4),a.moveTo(2,-4),a.lineTo(4,-4),a.lineTo(4,-2),a.moveTo(4,2),a.lineTo(4,4),a.lineTo(2,4),a.moveTo(-2,4),a.lineTo(-4,4),a.lineTo(-4,2),a.moveTo(-4,-2),a.strokeStyle="rgba(0,0,0,.2)",a.lineWidth=5,a.stroke(),a.strokeStyle="blue",a.lineWidth=1,a.stroke(),a.restore()}}(ChemDoodle.math,ChemDoodle.structures.d2,Math),function(a,b,c,d,e){d.Bracket=function(a,b){this.p1=a?a:new c.Point,this.p2=b?b:new c.Point},d=d.Bracket.prototype=new d._Shape,d.charge=0,d.mult=0,d.repeat=0,d.draw=function(b,c){var d=e.min(this.p1.x,this.p2.x),f=e.max(this.p1.x,this.p2.x),g=e.min(this.p1.y,this.p2.y),h=e.max(this.p1.y,this.p2.y),i=h-g,j=i/10;b.beginPath(),b.moveTo(d+j,g),b.lineTo(d,g),b.lineTo(d,h),b.lineTo(d+j,h),b.moveTo(f-j,h),b.lineTo(f,h),b.lineTo(f,g),b.lineTo(f-j,g),this.isLassoed&&(j=b.createLinearGradient(this.p1.x,this.p1.y,this.p2.x,this.p2.y),j.addColorStop(0,"rgba(212, 99, 0, 0)"),j.addColorStop(.5,"rgba(212, 99, 0, 0.8)"),j.addColorStop(1,"rgba(212, 99, 0, 0)"),b.lineWidth=c.shapes_lineWidth_2D+5,b.strokeStyle=j,b.lineJoin="miter",b.lineCap="square",b.stroke()),b.strokeStyle=c.shapes_color,b.lineWidth=c.shapes_lineWidth_2D,b.lineJoin="miter",b.lineCap="butt",b.stroke(),0!==this.charge&&(b.fillStyle=c.text_color,b.textAlign="left",b.textBaseline="alphabetic",b.font=a.getFontString(c.text_font_size,c.text_font_families),j=this.charge.toFixed(0),j="1"===j?"+":"-1"===j?"C":a.stringStartsWith(j,"-")?j.substring(1)+"C":j+"+",b.fillText(j,f+5,g+5)),0!==this.mult&&(b.fillStyle=c.text_color,b.textAlign="right",b.textBaseline="middle",b.font=a.getFontString(c.text_font_size,c.text_font_families),b.fillText(this.mult.toFixed(0),d-5,g+i/2)),0!==this.repeat&&(b.fillStyle=c.text_color,b.textAlign="left",b.textBaseline="top",b.font=a.getFontString(c.text_font_size,c.text_font_families),j=this.repeat.toFixed(0),b.fillText(j,f+5,h-5))},d.getPoints=function(){return[this.p1,this.p2]},d.isOver=function(a){return b.isBetween(a.x,this.p1.x,this.p2.x)&&b.isBetween(a.y,this.p1.y,this.p2.y)}}(ChemDoodle.extensions,ChemDoodle.math,ChemDoodle.structures,ChemDoodle.structures.d2,Math),function(a,b,c,d){c.Line=function(a,c){this.p1=a?a:new b.Point,this.p2=c?c:new b.Point},c.Line.ARROW_SYNTHETIC="synthetic",c.Line.ARROW_RETROSYNTHETIC="retrosynthetic",c.Line.ARROW_RESONANCE="resonance",c.Line.ARROW_EQUILIBRIUM="equilibrium";var e=c.Line.prototype=new c._Shape;e.arrowType=void 0,e.topText=void 0,e.bottomText=void 0,e.draw=function(a,b){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u;this.isLassoed&&(e=a.createLinearGradient(this.p1.x,this.p1.y,this.p2.x,this.p2.y),e.addColorStop(0,"rgba(212, 99, 0, 0)"),e.addColorStop(.5,"rgba(212, 99, 0, 0.8)"),e.addColorStop(1,"rgba(212, 99, 0, 0)"),f=2.5,g=this.p1.angle(this.p2)+d.PI/2,h=d.cos(g),g=d.sin(g),i=this.p1.x-h*f,j=this.p1.y+g*f,k=this.p1.x+h*f,l=this.p1.y-g*f,m=this.p2.x+h*f,n=this.p2.y-g*f,o=this.p2.x-h*f,p=this.p2.y+g*f,a.fillStyle=e,a.beginPath(),a.moveTo(i,j),a.lineTo(k,l),a.lineTo(m,n),a.lineTo(o,p),a.closePath(),a.fill()),a.strokeStyle=b.shapes_color,a.fillStyle=b.shapes_color,a.lineWidth=b.shapes_lineWidth_2D,a.lineJoin="miter",a.lineCap="butt",(this.p1.x!==this.p2.x||this.p1.y!==this.p2.y)&&(this.arrowType===c.Line.ARROW_RETROSYNTHETIC?(e=2*d.sqrt(2),f=b.shapes_arrowLength_2D/e,h=this.p1.angle(this.p2),g=h+d.PI/2,e=b.shapes_arrowLength_2D/e,q=d.cos(h),r=d.sin(h),h=d.cos(g),g=d.sin(g),i=this.p1.x-h*f,j=this.p1.y+g*f,k=this.p1.x+h*f,l=this.p1.y-g*f,m=this.p2.x+h*f-q*e,n=this.p2.y-g*f+r*e,o=this.p2.x-h*f-q*e,p=this.p2.y+g*f+r*e,s=this.p2.x+2*h*f-2*q*e,t=this.p2.y-2*g*f+2*r*e,u=this.p2.x-2*h*f-2*q*e,f=this.p2.y+2*g*f+2*r*e,a.beginPath(),a.moveTo(k,l),a.lineTo(m,n),a.moveTo(s,t),a.lineTo(this.p2.x,this.p2.y),a.lineTo(u,f),a.moveTo(o,p),a.lineTo(i,j)):this.arrowType===c.Line.ARROW_EQUILIBRIUM?(e=2*d.sqrt(2),f=b.shapes_arrowLength_2D/e/2,h=this.p1.angle(this.p2),g=h+d.PI/2,e=2*b.shapes_arrowLength_2D/d.sqrt(3),q=d.cos(h),r=d.sin(h),h=d.cos(g),g=d.sin(g),i=this.p1.x-h*f,j=this.p1.y+g*f,k=this.p1.x+h*f,l=this.p1.y-g*f,m=this.p2.x+h*f,n=this.p2.y-g*f,o=this.p2.x-h*f,p=this.p2.y+g*f,a.beginPath(),a.moveTo(k,l),a.lineTo(m,n),a.moveTo(o,p),a.lineTo(i,j),a.stroke(),k=m-.8*q*e,l=n+.8*r*e,s=m+h*b.shapes_arrowLength_2D/3-q*e,t=n-g*b.shapes_arrowLength_2D/3+r*e,a.beginPath(),a.moveTo(m,n),a.lineTo(s,t),a.lineTo(k,l),a.closePath(),a.fill(),a.stroke(),k=i+.8*q*e,l=j-.8*r*e,s=i-h*b.shapes_arrowLength_2D/3+q*e,t=j+g*b.shapes_arrowLength_2D/3-r*e,a.beginPath(),a.moveTo(i,j),a.lineTo(s,t),a.lineTo(k,l),a.closePath(),a.fill()):this.arrowType===c.Line.ARROW_SYNTHETIC?(h=this.p1.angle(this.p2),g=h+d.PI/2,e=2*b.shapes_arrowLength_2D/d.sqrt(3),q=d.cos(h),r=d.sin(h),h=d.cos(g),g=d.sin(g),a.beginPath(),a.moveTo(this.p1.x,this.p1.y),a.lineTo(this.p2.x-q*e/2,this.p2.y+r*e/2),a.stroke(),k=this.p2.x-.8*q*e,l=this.p2.y+.8*r*e,s=this.p2.x+h*b.shapes_arrowLength_2D/3-q*e,t=this.p2.y-g*b.shapes_arrowLength_2D/3+r*e,u=this.p2.x-h*b.shapes_arrowLength_2D/3-q*e,f=this.p2.y+g*b.shapes_arrowLength_2D/3+r*e,a.beginPath(),a.moveTo(this.p2.x,this.p2.y),a.lineTo(u,f),a.lineTo(k,l),a.lineTo(s,t),a.closePath(),a.fill()):this.arrowType===c.Line.ARROW_RESONANCE?(h=this.p1.angle(this.p2),g=h+d.PI/2,e=2*b.shapes_arrowLength_2D/d.sqrt(3),q=d.cos(h),r=d.sin(h),h=d.cos(g),g=d.sin(g),a.beginPath(),a.moveTo(this.p1.x+q*e/2,this.p1.y-r*e/2),a.lineTo(this.p2.x-q*e/2,this.p2.y+r*e/2),a.stroke(),k=this.p2.x-.8*q*e,l=this.p2.y+.8*r*e,s=this.p2.x+h*b.shapes_arrowLength_2D/3-q*e,t=this.p2.y-g*b.shapes_arrowLength_2D/3+r*e,u=this.p2.x-h*b.shapes_arrowLength_2D/3-q*e,f=this.p2.y+g*b.shapes_arrowLength_2D/3+r*e,a.beginPath(),a.moveTo(this.p2.x,this.p2.y),a.lineTo(u,f),a.lineTo(k,l),a.lineTo(s,t),a.closePath(),a.fill(),a.stroke(),k=this.p1.x+.8*q*e,l=this.p1.y-.8*r*e,s=this.p1.x-h*b.shapes_arrowLength_2D/3+q*e,t=this.p1.y+g*b.shapes_arrowLength_2D/3-r*e,u=this.p1.x+h*b.shapes_arrowLength_2D/3+q*e,f=this.p1.y-g*b.shapes_arrowLength_2D/3-r*e,a.beginPath(),a.moveTo(this.p1.x,this.p1.y),a.lineTo(u,f),a.lineTo(k,l),a.lineTo(s,t),a.closePath(),a.fill()):(a.beginPath(),a.moveTo(this.p1.x,this.p1.y),a.lineTo(this.p2.x,this.p2.y)),a.stroke(),this.topText&&(a.textAlign="center",a.textBaseline="bottom",a.fillText(this.topText,(this.p1.x+this.p2.x)/2,this.p1.y-5)),this.bottomText&&(a.textAlign="center",a.textBaseline="top",a.fillText(this.bottomText,(this.p1.x+this.p2.x)/2,this.p1.y+5)))
},e.getPoints=function(){return[this.p1,this.p2]},e.isOver=function(b,c){var d=a.distanceFromPointToLineInclusive(b,this.p1,this.p2);return-1!==d&&c>d}}(ChemDoodle.math,ChemDoodle.structures,ChemDoodle.structures.d2,Math),function(a,b,c,d,e){var f=function(a){var d,f,g,b=[];if(a instanceof c.Atom){if(0===a.bondNumber)b.push(e.PI);else if(a.angles){if(1===a.angles.length)b.push(a.angles[0]+e.PI);else{for(d=1,f=a.angles.length;f>d;d++)b.push(a.angles[d-1]+(a.angles[d]-a.angles[d-1])/2);d=a.angles[a.angles.length-1],b.push(d+(a.angles[0]+2*e.PI-d)/2)}if(a.largestAngle>e.PI&&(b=[a.angleOfLeastInterference]),a.bonds)for(d=0,f=a.bonds.length;f>d;d++)if(g=a.bonds[d],2===g.bondOrder&&(g=g.getNeighbor(a),"O"===g.label)){b=[g.angle(a)];break}}}else a=a.a1.angle(a.a2),b.push(a+e.PI/2),b.push(a+3*e.PI/2);for(d=0,f=b.length;f>d;d++){for(;b[d]>2*e.PI;)b[d]-=2*e.PI;for(;0>b[d];)b[d]+=2*e.PI}return b},g=function(a,b){var d=3;return a instanceof c.Atom?(a.isLabelVisible(b)&&(d=8),(0!==a.charge||0!==a.numRadical||0!==a.numLonePair)&&(d=13)):a instanceof c.Point?d=0:1<a.bondOrder&&(d=5),d},h=function(a,b,d,f,h,i,j,k,l,m){var q,r,s,t,n=i.angle(h),o=j.angle(k),p=e.cos(n);n=e.sin(n),q=g(d,b),h.x-=p*q,h.y+=n*q,q=o+e.PI/2,d=2*b.shapes_arrowLength_2D/e.sqrt(3),p=e.cos(o),n=e.sin(o),r=e.cos(q),s=e.sin(q),k.x-=5*p,k.y+=5*n,o=new c.Point(k.x,k.y),q=g(f,b)/3,o.x-=p*q,o.y+=n*q,k.x-=p*(.8*d+q),k.y+=n*(.8*d+q),f=o.x-.8*p*d,q=o.y+.8*n*d,t=new c.Point(o.x+r*b.shapes_arrowLength_2D/3-p*d,o.y-s*b.shapes_arrowLength_2D/3+n*d),b=new c.Point(o.x-r*b.shapes_arrowLength_2D/3-p*d,o.y+s*b.shapes_arrowLength_2D/3+n*d),n=p=!0,1===l&&(t.distance(i)>b.distance(i)?n=!1:p=!1),a.beginPath(),a.moveTo(o.x,o.y),n&&a.lineTo(b.x,b.y),a.lineTo(f,q),p&&a.lineTo(t.x,t.y),a.closePath(),a.fill(),a.stroke(),a.beginPath(),a.moveTo(h.x,h.y),a.bezierCurveTo(i.x,i.y,j.x,j.y,k.x,k.y),a.stroke(),m.push([h,i,j,k])};d.Pusher=function(a,b,c){this.o1=a,this.o2=b,this.numElectron=c?c:1},d=d.Pusher.prototype=new d._Shape,d.drawDecorations=function(a,b){var d,e,f,g;if(this.isHover)for(d=this.o1 instanceof c.Atom?new c.Point(this.o1.x,this.o1.y):this.o1.getCenter(),e=this.o2 instanceof c.Atom?new c.Point(this.o2.x,this.o2.y):this.o2.getCenter(),d=[d,e],e=0,f=d.length;f>e;e++)g=d[e],this.drawAnchor(a,b,g,g===this.hoverPoint)},d.draw=function(b,d){var l,m,g,i,j,k,n,o,p,q,r,s,t,u;if(this.o1&&this.o2){for(b.strokeStyle=d.shapes_color,b.fillStyle=d.shapes_color,b.lineWidth=d.shapes_lineWidth_2D,b.lineJoin="miter",b.lineCap="butt",g=this.o1 instanceof c.Atom?new c.Point(this.o1.x,this.o1.y):this.o1.getCenter(),i=this.o2 instanceof c.Atom?new c.Point(this.o2.x,this.o2.y):this.o2.getCenter(),j=f(this.o1),k=f(this.o2),n=1/0,o=0,p=j.length;p>o;o++)for(q=0,r=k.length;r>q;q++)s=new c.Point(g.x+35*e.cos(j[o]),g.y-35*e.sin(j[o])),t=new c.Point(i.x+35*e.cos(k[q]),i.y-35*e.sin(k[q])),u=s.distance(t),n>u&&(n=u,l=s,m=t);this.caches=[],-1===this.numElectron?(o=g.distance(i)/2,k=g.angle(i),j=k+e.PI/2,p=e.cos(k),q=e.sin(k),k=new c.Point(g.x+(o-1)*p,g.y-(o-1)*q),n=new c.Point(k.x+35*e.cos(j+e.PI/6),k.y-35*e.sin(j+e.PI/6)),o=new c.Point(g.x+(o+1)*p,g.y-(o+1)*q),j=new c.Point(o.x+35*e.cos(j-e.PI/6),o.y-35*e.sin(j-e.PI/6)),h(b,d,this.o1,k,g,l,n,k,1,this.caches),h(b,d,this.o2,o,i,m,j,o,1,this.caches)):(a.intersectLines(g.x,g.y,l.x,l.y,i.x,i.y,m.x,m.y)&&(j=l,l=m,m=j),j=l.angle(g),k=m.angle(i),n=e.max(j,k)-e.min(j,k),.001>e.abs(n-e.PI)&&this.o1.molCenter===this.o2.molCenter&&(j+=e.PI/2,k-=e.PI/2,l.x=g.x+35*e.cos(j+e.PI),l.y=g.y-35*e.sin(j+e.PI),m.x=i.x+35*e.cos(k+e.PI),m.y=i.y-35*e.sin(k+e.PI)),h(b,d,this.o1,this.o2,g,l,m,i,this.numElectron,this.caches))}},d.getPoints=function(){return[]},d.isOver=function(a,c){for(var d=0,e=this.caches.length;e>d;d++)if(b.distanceFromCurve(a,this.caches[d]).distance<c)return!0;return!1}}(ChemDoodle.math,ChemDoodle.math.jsBezier,ChemDoodle.structures,ChemDoodle.structures.d2,Math),function(a){a._Mesh=function(){},a=a._Mesh.prototype,a.storeData=function(a,b,c){this.positionData=a,this.normalData=b,this.indexData=c},a.setupBuffers=function(a){var b,c,d,e;if(this.vertexPositionBuffer=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,this.vertexPositionBuffer),a.bufferData(a.ARRAY_BUFFER,new Float32Array(this.positionData),a.STATIC_DRAW),this.vertexPositionBuffer.itemSize=3,this.vertexPositionBuffer.numItems=this.positionData.length/3,this.vertexNormalBuffer=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,this.vertexNormalBuffer),a.bufferData(a.ARRAY_BUFFER,new Float32Array(this.normalData),a.STATIC_DRAW),this.vertexNormalBuffer.itemSize=3,this.vertexNormalBuffer.numItems=this.normalData.length/3,this.indexData&&(this.vertexIndexBuffer=a.createBuffer(),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer),a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.indexData),a.STATIC_DRAW),this.vertexIndexBuffer.itemSize=1,this.vertexIndexBuffer.numItems=this.indexData.length),this.partitions)for(b=0,c=this.partitions.length;c>b;b++)d=this.partitions[b],e=this.generateBuffers(a,d.positionData,d.normalData,d.indexData),d.vertexPositionBuffer=e[0],d.vertexNormalBuffer=e[1],d.vertexIndexBuffer=e[2]},a.generateBuffers=function(a,b,c,d){var f,e=a.createBuffer();return a.bindBuffer(a.ARRAY_BUFFER,e),a.bufferData(a.ARRAY_BUFFER,new Float32Array(b),a.STATIC_DRAW),e.itemSize=3,e.numItems=b.length/3,b=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,b),a.bufferData(a.ARRAY_BUFFER,new Float32Array(c),a.STATIC_DRAW),b.itemSize=3,b.numItems=c.length/3,d&&(f=a.createBuffer(),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,f),a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array(d),a.STATIC_DRAW),f.itemSize=1,f.numItems=d.length),[e,b,f]},a.bindBuffers=function(a){this.vertexPositionBuffer||this.setupBuffers(a),a.bindBuffer(a.ARRAY_BUFFER,this.vertexPositionBuffer),a.vertexAttribPointer(a.shader.vertexPositionAttribute,this.vertexPositionBuffer.itemSize,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,this.vertexNormalBuffer),a.vertexAttribPointer(a.shader.vertexNormalAttribute,this.vertexNormalBuffer.itemSize,a.FLOAT,!1,0,0),this.vertexIndexBuffer&&a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer)}}(ChemDoodle.structures.d3,Math),function(a){a._Measurement=function(){},(a._Measurement.prototype=new a._Mesh).render=function(a,b){if(a.setMatrixUniforms(a.modelViewMatrix),b.measurement_update_3D&&(this.text=this.vertexPositionBuffer=void 0),this.vertexPositionBuffer||this.calculateData(b),this.bindBuffers(a),a.material.setDiffuseColor(b.shapes_color),a.lineWidth(1),a.drawElements(a.LINES,this.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0),b.measurement_displayText_3D){this.text||(this.text=this.getText(b));var c={position:[],texCoord:[],translation:[]};a.textImage.pushVertexData(this.text.value,this.text.pos,1,c),a.textMesh.storeData(a,c.position,c.texCoord,c.translation),a.enable(a.BLEND),a.depthMask(!1),a.enableVertexAttribArray(a.shader.vertexTexCoordAttribute),a.textImage.useTexture(a),a.textMesh.render(a),a.disableVertexAttribArray(a.shader.vertexTexCoordAttribute),a.disable(a.BLEND),a.depthMask(!0)}}}(ChemDoodle.structures.d3),function(a,b,c,d,e,f,g){c.Angle=function(a,b,c){this.a1=a,this.a2=b,this.a3=c},a=c.Angle.prototype=new c._Measurement,a.calculateData=function(a){var j,k,c=[],d=[],f=[],h=this.a2.distance3D(this.a1),i=this.a2.distance3D(this.a3);for(this.distUse=e.min(h,i)/2,this.vec1=g.normalize([this.a1.x-this.a2.x,this.a1.y-this.a2.y,this.a1.z-this.a2.z]),this.vec2=g.normalize([this.a3.x-this.a2.x,this.a3.y-this.a2.y,this.a3.z-this.a2.z]),this.angle=b.vec3AngleFrom(this.vec1,this.vec2),h=g.normalize(g.cross(this.vec1,this.vec2,[])),h=g.normalize(g.cross(h,this.vec1,[])),a=a.measurement_angleBands_3D,i=0;a>=i;++i)j=this.angle*i/a,k=g.scale(this.vec1,e.cos(j),[]),j=g.scale(h,e.sin(j),[]),k=g.scale(g.normalize(g.add(k,j,[])),this.distUse),c.push(this.a2.x+k[0],this.a2.y+k[1],this.a2.z+k[2]),d.push(0,0,0),a>i&&f.push(i,i+1);this.storeData(c,d,f)},a.getText=function(){var a=g.scale(g.normalize(g.add(this.vec1,this.vec2,[])),this.distUse+.3);return{pos:[this.a2.x+a[0],this.a2.y+a[1],this.a2.z+a[2]],value:[d.angleBounds(this.angle,!0).toFixed(2)," "].join("")}}}(ChemDoodle.ELEMENT,ChemDoodle.extensions,ChemDoodle.structures.d3,ChemDoodle.math,Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3),function(a,b){a.Arrow=function(a,c){var d,e,f,g,h,i,j,k;for(d=[],e=[],f=0;c>=f;f++)g=2*f*b.PI/c,h=b.sin(g),g=b.cos(g),e.push(0,0,-1,0,0,-1,g,h,0,g,h,0,0,0,-1,0,0,-1,g,h,1,g,h,1),d.push(0,0,0,a*g,a*h,0,a*g,a*h,0,a*g,a*h,2,a*g,a*h,2,2*a*g,2*a*h,2,2*a*g,2*a*h,2,0,0,3);for(f=[],h=0;c>h;h++)for(g=8*h,i=0;7>i;i++)j=i+g,k=j+7+2,f.push(j,k,j+1,k,j,k-1);this.storeData(d,e,f)},a.Arrow.prototype=new a._Mesh}(ChemDoodle.structures.d3,Math),function(a,b,c){a.LineArrow=function(){this.storeData([0,0,-3,.1,0,-2.8,0,0,-3,-.1,0,-2.8,0,0,-3,0,0,3,0,0,3,.1,0,2.8,0,0,3,-.1,0,2.8],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])},a.LineArrow.prototype=new a._Mesh,a.Compass=function(d,e){var k,l,f,g,h,i,j,m,n,o;this.textImage=new a.TextImage,this.textImage.init(d),this.textImage.updateFont(d,e.text_font_size,e.text_font_families,e.text_font_bold,e.text_font_italic,e.text_font_stroke_3D),this.textMesh=new a.TextMesh,this.textMesh.init(d),f=3/(e.compass_size_3D/d.canvas.clientHeight),g=b.tan(e.projectionPerspectiveVerticalFieldOfView_3D/360*b.PI),h=f/g,i=b.max(h-f,.1),j=d.canvas.clientWidth/d.canvas.clientHeight,e.projectionPerspective_3D?(l=i,k=c.frustum):(l=h,k=c.ortho),m=2*(l/d.canvas.clientHeight)*g,g*=l,l=-g,n=j*l,j*=g,0===e.compass_type_3D&&(o=(-(d.canvas.clientWidth-e.compass_size_3D)/2+this.textImage.charHeight)*m,m=(-(d.canvas.clientHeight-e.compass_size_3D)/2+this.textImage.charHeight)*m,n-=o,j-=o,l-=m,g-=m),this.projectionMatrix=k(n,j,l,g,i,h+f),this.translationMatrix=c.translate(c.identity([]),[0,0,-h]),f={position:[],texCoord:[],translation:[]},this.textImage.pushVertexData("X",[3.5,0,0],0,f),this.textImage.pushVertexData("Y",[0,3.5,0],0,f),this.textImage.pushVertexData("Z",[0,0,3.5],0,f),this.textMesh.storeData(d,f.position,f.texCoord,f.translation)};var d=a.Compass.prototype;d.renderArrow=function(a,b,c,d){a.material.setDiffuseColor(c),a.setMatrixUniforms(d),1===b?a.drawArrays(a.LINES,0,a.lineArrowBuffer.vertexPositionBuffer.numItems):a.drawElements(a.TRIANGLES,a.arrowBuffer.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0)},d.render=function(a,d){1===d.compass_type_3D?a.lineArrowBuffer.bindBuffers(a):a.arrowBuffer.bindBuffers(a),a.material.setTempColors(d.bonds_materialAmbientColor_3D,void 0,d.bonds_materialSpecularColor_3D,d.bonds_materialShininess_3D);var e=c.multiply(this.translationMatrix,a.rotationMatrix,[]),f=b.PI/2;a.fogging.setMode(0),this.renderArrow(a,d.compass_type_3D,d.compass_axisXColor_3D,c.rotateY(e,f,[])),this.renderArrow(a,d.compass_type_3D,d.compass_axisYColor_3D,c.rotateX(e,-f,[])),this.renderArrow(a,d.compass_type_3D,d.compass_axisZColor_3D,e)},d.renderAxis=function(a){var b=c.multiply(this.translationMatrix,a.rotationMatrix,[]);a.setMatrixUniforms(b),this.textImage.useTexture(a),this.textMesh.render(a)}}(ChemDoodle.structures.d3,Math,ChemDoodle.lib.mat4),function(a,b){a.Cylinder=function(a,c,d){var e,f,g,h,i;for(e=[],f=[],g=0;d>g;g++)h=2*g*b.PI/d,i=b.cos(h),h=b.sin(h),f.push(i,0,h),e.push(a*i,0,a*h),f.push(i,0,h),e.push(a*i,c,a*h);f.push(1,0,0),e.push(a,0,0),f.push(1,0,0),e.push(a,c,0),this.storeData(e,f)},a.Cylinder.prototype=new a._Mesh}(ChemDoodle.structures.d3,Math),function(a,b,c,d){b.Distance=function(a,b,c,d){this.a1=a,this.a2=b,this.node=c,this.offset=d?d:0},b=b.Distance.prototype=new b._Measurement,b.calculateData=function(b){var e=[this.a1.x,this.a1.y,this.a1.z,this.a2.x,this.a2.y,this.a2.z];this.node&&(this.move=this.offset+c.max(b.atoms_useVDWDiameters_3D?a[this.a1.label].vdWRadius*b.atoms_vdwMultiplier_3D:b.atoms_sphereDiameter_3D/2,b.atoms_useVDWDiameters_3D?a[this.a2.label].vdWRadius*b.atoms_vdwMultiplier_3D:b.atoms_sphereDiameter_3D/2),this.displacement=[(this.a1.x+this.a2.x)/2-this.node.x,(this.a1.y+this.a2.y)/2-this.node.y,(this.a1.z+this.a2.z)/2-this.node.z],d.normalize(this.displacement),b=d.scale(this.displacement,this.move,[]),e[0]+=b[0],e[1]+=b[1],e[2]+=b[2],e[3]+=b[0],e[4]+=b[1],e[5]+=b[2]),this.storeData(e,[0,0,0,0,0,0],[0,1])},b.getText=function(){var c,a=this.a1.distance3D(this.a2),b=[(this.a1.x+this.a2.x)/2,(this.a1.y+this.a2.y)/2,(this.a1.z+this.a2.z)/2];return this.node&&(c=d.scale(this.displacement,this.move+.1,[]),b[0]+=c[0],b[1]+=c[1],b[2]+=c[2]),{pos:b,value:[a.toFixed(2)," ?"].join("")}}}(ChemDoodle.ELEMENT,ChemDoodle.structures.d3,Math,ChemDoodle.lib.vec3),function(a,b){b.Fog=function(a){this.gl=a,this.mUL=a.getUniformLocation(a.program,"u_fog_mode"),this.cUL=a.getUniformLocation(a.program,"u_fog_color"),this.sUL=a.getUniformLocation(a.program,"u_fog_start"),this.eUL=a.getUniformLocation(a.program,"u_fog_end"),this.dUL=a.getUniformLocation(a.program,"u_fog_density")};var c=b.Fog.prototype;c.setTempParameter=function(b,c,d,e){this.cCache&&this.cCache===b||(this.cCache=b,b=a.getRGB(b,1),this.gl.uniform3f(this.cUL,b[0],b[1],b[2])),this.sCache&&this.sCache===c||(this.sCache=c,this.gl.uniform1f(this.sUL,c)),this.eCache&&this.eCache===d||(this.eCache=d,this.gl.uniform1f(this.eUL,d)),this.dCache&&this.dCache===e||(this.dCache=e,this.gl.uniform1f(this.dUL,e))},c.setMode=function(a){this.mCache&&this.mCache===a||(this.mCache=a,this.gl.uniform1i(this.mUL,a))}}(ChemDoodle.math,ChemDoodle.structures.d3,ChemDoodle.lib.vec3),function(a,b){b.Label=function(){this.textImage=new b.TextImage};var c=b.Label.prototype;c.init=function(a,b){this.textImage.init(a),this.textImage.updateFont(a,b.atoms_font_size_2D,b.atoms_font_families_2D,b.atoms_font_bold_2D,b.atoms_font_italic_2D,b.text_font_stroke_3D)},c.updateVerticesBuffer=function(b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r;for(e=0,f=c.length;f>e;e++){for(g=c[e],h=g.labelMesh,i=g.atoms,j=this.textImage,k={position:[],texCoord:[],translation:[]},l=0<i.length&&void 0!=i[0].hetatm,m=0,n=i.length;n>m;m++){if(o=i[m],p=o.label,q=.05,d.atoms_useVDWDiameters_3D?(r=a[p].vdWRadius*d.atoms_vdwMultiplier_3D,0===r&&(r=1),q+=r):d.atoms_sphereDiameter_3D&&(q+=1.5*(d.atoms_sphereDiameter_3D/2)),l)if(o.hetatm){if(o.isWater&&!d.macro_showWaters)continue}else if(!d.macro_displayAtoms)continue;j.pushVertexData(p,[o.x,o.y,o.z],q,k)}if((g=g.chains)&&(d.proteins_displayRibbon||d.proteins_displayBackbone))for(m=0,n=g.length;n>m;m++)for(i=g[m],l=0,p=i.length;p>l;l++)q=i[l],q.name&&(o=q.cp1,j.pushVertexData(q.name,[o.x,o.y,o.z],2,k));h.storeData(b,k.position,k.texCoord,k.translation,k.zDepth)}},c.render=function(a,b,c){a.setMatrixUniforms(a.modelViewMatrix),this.textImage.useTexture(a),b=0;for(var d=c.length;d>b;b++)c[b].labelMesh&&c[b].labelMesh.render(a)}}(ChemDoodle.ELEMENT,ChemDoodle.structures.d3),function(a,b){a.Sphere=function(a,c,d){var e,f,g,h,i,j,k,l,m;for(e=[],f=[],g=0;c>=g;g++)for(h=g*b.PI/c,i=b.sin(h),j=b.cos(h),h=0;d>=h;h++)k=2*h*b.PI/d,l=b.sin(k),k=b.cos(k)*i,m=j,l*=i,f.push(k,m,l),e.push(a*k,a*m,a*l);for(a=[],d+=1,g=0;c>g;g++)for(h=0;d>h;h++)i=g*d+h%d,j=i+d,a.push(i,i+1,j),d-1>h&&a.push(j,i+1,j+1);this.storeData(e,f,a)},a.Sphere.prototype=new a._Mesh}(ChemDoodle.structures.d3,Math),function(a,b,c,d){function e(a,b,c,d){this.entire=a,this.name=b,this.indexes=c,this.pi=d}var f=function(a,b){a.bindBuffer(a.ARRAY_BUFFER,b.vertexPositionBuffer),a.vertexAttribPointer(a.shader.vertexPositionAttribute,b.vertexPositionBuffer.itemSize,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,b.vertexNormalBuffer),a.vertexAttribPointer(a.shader.vertexNormalAttribute,b.vertexNormalBuffer.itemSize,a.FLOAT,!1,0,0),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,b.vertexIndexBuffer)},g=e.prototype;g.getColor=function(b){return b.macro_colorByChain?this.chainColor:this.name?this.getResidueColor(a[this.name]?this.name:"*",b):this.helix?this.entire.front?b.proteins_ribbonCartoonHelixPrimaryColor:b.proteins_ribbonCartoonHelixSecondaryColor:this.sheet?b.proteins_ribbonCartoonSheetColor:this.entire.front?b.proteins_primaryColor:b.proteins_secondaryColor},g.getResidueColor=function(b,c){var d=a[b];if("shapely"===c.proteins_residueColor)return d.shapelyColor;if("amino"===c.proteins_residueColor)return d.aminoColor;if("polarity"===c.proteins_residueColor){if(d.polar)return"#C10000"}else if("acidity"===c.proteins_residueColor){if(1===d.acidity)return"#0000FF";if(-1===d.acidity)return"#FF0000";if(!d.polar)return"#773300"}return"#FFFFFF"},g.render=function(a,b,c){this.entire.partitions&&this.pi!==this.entire.partitions.lastRender&&(f(a,this.entire.partitions[this.pi]),this.entire.partitions.lastRender=this.pi),this.vertexIndexBuffer||(this.vertexIndexBuffer=a.createBuffer(),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer),a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.indexes),a.STATIC_DRAW),this.vertexIndexBuffer.itemSize=1,this.vertexIndexBuffer.numItems=this.indexes.length),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer),!c&&"rainbow"!==b.proteins_residueColor&&a.material.setDiffuseColor(this.getColor(b)),a.drawElements(a.TRIANGLES,this.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0)},b.Ribbon=function(a,b,f){var i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,g=a[0].lineSegments.length,h=a[0].lineSegments[0].length;for(this.partitions=[],this.partitions.lastRender=0,this.front=b>0,j=0,k=a.length-1;k>j;j++)for((!i||65e3<i.positionData.length)&&(0<this.partitions.length&&j--,i={count:0,positionData:[],normalData:[],indexData:[]},this.partitions.push(i)),l=a[j],i.count++,m=0;g>m;m++)for(n=f?l.lineSegmentsCartoon[m]:l.lineSegments[m],o=0===m,p=!1,q=0;h>q;q++)r=n[q],s=j,t=q+1,j===a.length-2&&q===h-1?t--:q===h-1&&(s++,t=0),t=f?a[s].lineSegmentsCartoon[m][t]:a[s].lineSegments[m][t],s=!1,u=m+1,m===g-1&&(u-=2,s=!0),u=f?l.lineSegmentsCartoon[u][q]:l.lineSegments[u][q],t=[t.x-r.x,t.y-r.y,t.z-r.z],u=[u.x-r.x,u.y-r.y,u.z-r.z],v=d.cross(t,u,[]),0===q&&(d.normalize(t),d.scale(t,-1),i.normalData.push(t[0],t[1],t[2]),i.positionData.push(r.x,r.y,r.z)),o||p?(d.normalize(u),d.scale(u,-1),i.normalData.push(u[0],u[1],u[2]),i.positionData.push(r.x,r.y,r.z),o&&q===h-1&&(o=!1,q=-1)):(d.normalize(v),(s&&!this.front||!s&&this.front)&&d.scale(v,-1),i.normalData.push(v[0],v[1],v[2]),d.scale(v,c.abs(b)),i.positionData.push(r.x+v[0],r.y+v[1],r.z+v[2]),m===g-1&&q===h-1&&(p=!0,q=-1)),(-1===q||q===h-1)&&(d.normalize(t),i.normalData.push(t[0],t[1],t[2]),i.positionData.push(r.x,r.y,r.z));for(g+=2,h+=2,f&&(this.cartoonSegments=[]),this.segments=[],b=0,l=this.partitions.length;l>b;b++){for(i=this.partitions[b],f&&(w=[]),j=0,k=i.count-1;k>j;j++){for(n=j,m=0;b>m;m++)n+=this.partitions[m].count-1;for(m=a[n],j>0&&f&&m.split&&(q=new e(this,void 0,w,b),m.helix&&(q.helix=!0),m.sheet&&(q.sheet=!0),this.cartoonSegments.push(q),w=[]),o=j*g*h,p=[],m=0,r=g-1;r>m;m++)for(s=o+m*h,q=0;h>q;q++)t=1,j===i.count-1?t=0:q===h-1&&(t=g*h-q),t=[s+q,s+h+q,s+h+q+t,s+q,s+q+t,s+h+q+t],q!==h-1&&(this.front?p.push(t[0],t[1],t[2],t[3],t[5],t[4]):p.push(t[0],t[2],t[1],t[3],t[4],t[5])),q===h-2&&j<i.count-1&&(u=g*h-q,t[2]+=u,t[4]+=u,t[5]+=u),this.front?i.indexData.push(t[0],t[1],t[2],t[3],t[5],t[4]):i.indexData.push(t[0],t[2],t[1],t[3],t[4],t[5]),f&&(this.front?w.push(t[0],t[1],t[2],t[3],t[5],t[4]):w.push(t[0],t[2],t[1],t[3],t[4],t[5]));this.segments.push(new e(this,a[n+1].name,p,b))}if(f){for(q=new e(this,void 0,w,b),n=i.count-1,m=0;b>m;m++)n+=this.partitions[m].count-1;m=a[n],m.helix&&(q.helix=!0),m.sheet&&(q.sheet=!0),this.cartoonSegments.push(q)}}this.storeData(this.partitions[0].positionData,this.partitions[0].normalData,this.partitions[0].indexData),1===this.partitions.length&&(this.partitions=void 0)},(b.Ribbon.prototype=new b._Mesh).render=function(a,b){var c,d,e;if(this.bindBuffers(a),c=b.macro_colorByChain?this.chainColor:void 0,c||(c=this.front?b.proteins_primaryColor:b.proteins_secondaryColor),a.material.setDiffuseColor(c),a.drawElements(a.TRIANGLES,this.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0),this.partitions)for(c=1,d=this.partitions.length;d>c;c++)e=this.partitions[c],f(a,e),a.drawElements(a.TRIANGLES,e.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0)}}(ChemDoodle.RESIDUE,ChemDoodle.structures.d3,Math,ChemDoodle.lib.vec3),function(a,b,c){b.Light=function(b,c,d){this.diffuseRGB=a.getRGB(b,1),this.specularRGB=a.getRGB(c,1),this.direction=d},b.Light.prototype.lightScene=function(a){var b,d;a.uniform3f(a.getUniformLocation(a.program,"u_light_diffuse_color"),this.diffuseRGB[0],this.diffuseRGB[1],this.diffuseRGB[2]),a.uniform3f(a.getUniformLocation(a.program,"u_light_specular_color"),this.specularRGB[0],this.specularRGB[1],this.specularRGB[2]),b=c.create(this.direction),c.normalize(b),c.negate(b),a.uniform3f(a.getUniformLocation(a.program,"u_light_direction"),b[0],b[1],b[2]),d=[0,0,0],b=[d[0]+b[0],d[1]+b[1],d[2]+b[2]],d=c.length(b),0===d?b=[0,0,1]:c.scale(1/d),a.uniform3f(a.getUniformLocation(a.program,"u_light_half_vector"),b[0],b[1],b[2])}}(ChemDoodle.math,ChemDoodle.structures.d3,ChemDoodle.lib.vec3),function(a){a.Line=function(){this.storeData([0,0,0,0,1,0],[0,0,0,0,0,0])},a.Line.prototype=new a._Mesh}(ChemDoodle.structures.d3),function(a,b){b.Material=function(a){this.gl=a,this.aUL=a.getUniformLocation(a.program,"u_material_ambient_color"),this.dUL=a.getUniformLocation(a.program,"u_material_diffuse_color"),this.sUL=a.getUniformLocation(a.program,"u_material_specular_color"),this.snUL=a.getUniformLocation(a.program,"u_material_shininess"),this.alUL=a.getUniformLocation(a.program,"u_material_alpha")};var c=b.Material.prototype;c.setTempColors=function(b,c,d,e){this.aCache&&this.aCache===b||(this.aCache=b,b=a.getRGB(b,1),this.gl.uniform3f(this.aUL,b[0],b[1],b[2])),!c||this.dCache&&this.dCache===c||(this.dCache=c,b=a.getRGB(c,1),this.gl.uniform3f(this.dUL,b[0],b[1],b[2])),this.sCache&&this.sCache===d||(this.sCache=d,b=a.getRGB(d,1),this.gl.uniform3f(this.sUL,b[0],b[1],b[2])),this.snCache&&this.snCache===e||(this.snCache=e,this.gl.uniform1f(this.snUL,e)),this.alCache=1,this.gl.uniform1f(this.alUL,1)},c.setDiffuseColor=function(b){this.dCache&&this.dCache===b||(this.dCache=b,b=a.getRGB(b,1),this.gl.uniform3f(this.dUL,b[0],b[1],b[2]))},c.setAlpha=function(a){this.alCache&&this.alCache===a||(this.alCache=a,this.gl.uniform1f(this.alUL,a))}}(ChemDoodle.math,ChemDoodle.structures.d3),function(a,b,c,d){b.MolecularSurface=function(b,e,f,g,h){function i(a,b,c,d){var f,g,h,i,j,k,l,m,e=a.index;if(a.contained)for(e=-1,f=1/0,g=0,h=b.length;h>g;g++)for(i=b[g],j=0,k=i.length;k>j;j++)l=i[j],l.contained||l.index===c||l.index===d||(m=l.distance3D(a),f>m&&(e=l.index,f=m));return e}var j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z;for(j=[],k=[],l=[],m=[],n=0;e>=n;n++)for(o=n*d.PI/e,p=d.sin(o),q=d.cos(o),o=0;f>=o;o++)r=2*o*d.PI/f,m.push(d.cos(r)*p,q,d.sin(r)*p);for(p=[],n=0,o=b.atoms.length;o>n;n++){for(q=[],s=b.atoms[n],t=c[s.label][h]+g,u=[],r=0,v=b.atoms.length;v>r;r++)r!==n&&(w=b.atoms[r],w.index=r,s.distance3D(w)<t+c[w.label][h]+g&&u.push(w));for(r=0,v=m.length;v>r;r+=3){for(x=new a.Atom("C",s.x+t*m[r],s.y+t*m[r+1],s.z+t*m[r+2]),y=0,z=u.length;z>y;y++)if(w=u[y],x.distance3D(w)<c[w.label][h]+g){x.contained=!0;break}q.push(x)}p.push(q)}for(b=[],f++,n=0;e>n;n++)for(o=0;f>o;o++)h=n*f+o%f,g=h+f,b.push(h),b.push(g),b.push(h+1),f-1>o&&(b.push(g),b.push(g+1),b.push(h+1));for(n=y=0,o=p.length;o>n;n++){for(q=p[n],r=0,v=q.length;v>r;r++)x=q[r],x.contained||(x.index=y,y++,j.push(x.x,x.y,x.z),k.push(m[3*r],m[3*r+1],m[3*r+2]));for(r=0,v=b.length;v>r;r+=3)h=q[b[r]],g=q[b[r+1]],x=q[b[r+2]],!h.contained&&!g.contained&&!x.contained&&l.push(h.index,g.index,x.index)}for(m=[],n=0,o=p.length;o>n;n++)for(q=p[n],r=0,v=b.length;v>r;r+=3){for(h=q[b[r]],g=q[b[r+1]],x=q[b[r+2]],u=[],y=0,z=p.length;z>y;y++)y!==n&&u.push(p[y]);if(!(h.contained&&g.contained&&x.contained||!(h.contained||g.contained||x.contained))&&(e=i(h,u,-1,-1),f=i(g,u,e,-1),u=i(x,u,e,f),-1!==e&&-1!==f&&-1!==u)){for(g=!1,y=0,z=m.length;z>y;y+=3)if(h=m[y],x=m[y+1],s=m[y+2],t=f===h||f===x||f===s,w=u===h||u===x||u===s,(e===h||e===x||e===s)&&t&&w){g=!0;break}g||m.push(e,f,u)}}l=l.concat(m),this.storeData(j,k,l)},b.MolecularSurface.prototype=new b._Mesh}(ChemDoodle.structures,ChemDoodle.structures.d3,ChemDoodle.ELEMENT,Math),function(a){a.Picker=function(){},a=a.Picker.prototype,a.init=function(a){this.framebuffer=a.createFramebuffer();var b=a.createTexture(),c=a.createRenderbuffer();a.bindTexture(a.TEXTURE_2D,b),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.bindRenderbuffer(a.RENDERBUFFER,c),a.bindFramebuffer(a.FRAMEBUFFER,this.framebuffer),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,b,0),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,c),a.bindTexture(a.TEXTURE_2D,null),a.bindRenderbuffer(a.RENDERBUFFER,null),a.bindFramebuffer(a.FRAMEBUFFER,null)},a.setDimension=function(a,b,c){a.bindFramebuffer(a.FRAMEBUFFER,this.framebuffer);var d=a.getFramebufferAttachmentParameter(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME);a.isRenderbuffer(d)&&(a.bindRenderbuffer(a.RENDERBUFFER,d),a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_COMPONENT16,b,c),a.bindRenderbuffer(a.RENDERBUFFER,null)),d=a.getFramebufferAttachmentParameter(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME),a.isTexture(d)&&(a.bindTexture(a.TEXTURE_2D,d),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,b,c,0,a.RGBA,a.UNSIGNED_BYTE,null),a.bindTexture(a.TEXTURE_2D,null)),a.bindFramebuffer(a.FRAMEBUFFER,null)},a.pick=function(a,b,c,d,e,f,g){var j,k,l,h=void 0,i=a.getParameter(a.COLOR_CLEAR_VALUE);for(a.bindFramebuffer(a.FRAMEBUFFER,this.framebuffer),a.clearColor(1,1,1,0),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),a.fogging.setMode(0),a.disableVertexAttribArray(a.shader.vertexNormalAttribute),j=[],a.material.setAlpha(255),k=0,l=b.length;l>k;k++)b[k].renderPickFrame(a,c,j,f,g);return a.flush(),b=new Uint8Array(4),a.readPixels(d-2,e+2,1,1,a.RGBA,a.UNSIGNED_BYTE,b),0<b[3]&&(h=j[b[2]|b[1]<<8|b[0]<<16]),a.enableVertexAttribArray(a.shader.vertexNormalAttribute),a.fogging.setMode(c.fog_mode_3D),a.bindFramebuffer(a.FRAMEBUFFER,null),a.clearColor(i[0],i[1],i[2],i[3]),h}}(ChemDoodle.structures.d3,ChemDoodle.math,document),function(a,b){a.Pill=function(a,c,d,e){var h,i,j,k,l,m,n,o,f=1,g=2*a;for(c-=g,0>c?(f=0,c+=g):g>c&&(f=c/g,c=g),g=[],h=[],i=0;d>=i;i++)for(j=i*b.PI/d,k=b.sin(j),l=b.cos(j)*f,j=0;e>=j;j++)m=2*j*b.PI/e,n=b.sin(m),m=b.cos(m)*k,o=l,n*=k,h.push(m,o,n),g.push(a*m,a*o+(d/2>i?c:0),a*n);for(a=[],e+=1,i=0;d>i;i++)for(j=0;e>j;j++)c=i*e+j%e,f=c+e,a.push(c,c+1,f),e-1>j&&a.push(f,c+1,f+1);this.storeData(g,h,a)},a.Pill.prototype=new a._Mesh}(ChemDoodle.structures.d3,Math),function(a,b){a.Shader=function(){};var c=a.Shader.prototype;c.init=function(a){var c,b=this.getShader(a,"vertex-shader");b||(b=this.loadDefaultVertexShader(a)),c=this.getShader(a,"fragment-shader"),c||(c=this.loadDefaultFragmentShader(a)),a.attachShader(a.program,b),a.attachShader(a.program,c),this.vertexPositionAttribute=0,a.bindAttribLocation(a.program,this.vertexPositionAttribute,"a_vertex_position"),a.linkProgram(a.program),a.getProgramParameter(a.program,a.LINK_STATUS)||alert("Could not initialize shaders: "+a.getProgramInfoLog(a.program)),a.useProgram(a.program),a.enableVertexAttribArray(this.vertexPositionAttribute),this.vertexTexCoordAttribute=a.getAttribLocation(a.program,"a_vertex_texcoord"),this.vertexNormalAttribute=a.getAttribLocation(a.program,"a_vertex_normal"),a.enableVertexAttribArray(this.vertexNormalAttribute),this.dimensionUniform=a.getUniformLocation(a.program,"u_dimension")},c.getShader=function(a,c){var e,f,d=b.getElementById(c);if(d){for(e=[],f=d.firstChild;f;)3===f.nodeType&&e.push(f.textContent),f=f.nextSibling;if("x-shader/x-fragment"===d.type)f=a.createShader(a.FRAGMENT_SHADER);else{if("x-shader/x-vertex"!==d.type)return;f=a.createShader(a.VERTEX_SHADER)}if(a.shaderSource(f,e.join("")),a.compileShader(f),a.getShaderParameter(f,a.COMPILE_STATUS))return f;alert(d.type+" "+a.getShaderInfoLog(f))}},c.loadDefaultVertexShader=function(a){var b=a.createShader(a.VERTEX_SHADER);return a.shaderSource(b,"precision mediump float;attribute vec3 a_vertex_position;attribute vec3 a_vertex_normal;attribute vec2 a_vertex_texcoord;uniform vec3 u_light_diffuse_color;uniform vec3 u_material_ambient_color;uniform vec3 u_material_diffuse_color;uniform mat4 u_model_view_matrix;uniform mat4 u_projection_matrix;uniform mat3 u_normal_matrix;uniform vec2 u_dimension;varying vec2 v_texcoord;varying vec3 v_diffuse;varying vec4 v_ambient;varying vec3 v_normal;void main() {v_texcoord = a_vertex_texcoord;if(length(a_vertex_texcoord) != 0.) {gl_Position = u_model_view_matrix * vec4(a_vertex_position, 1.);vec4 depth_pos = vec4(gl_Position);depth_pos.z += a_vertex_normal.z;gl_Position = u_projection_matrix * gl_Position;depth_pos = u_projection_matrix * depth_pos;gl_Position /= gl_Position.w;gl_Position.xy += a_vertex_normal.xy / u_dimension * 2.;gl_Position.z = depth_pos.z / depth_pos.w;} else {v_normal = length(a_vertex_normal)==0. ? a_vertex_normal : normalize(u_normal_matrix * a_vertex_normal);v_ambient = vec4(u_material_ambient_color, 1.);v_diffuse = u_material_diffuse_color * u_light_diffuse_color;gl_Position = u_projection_matrix * u_model_view_matrix * vec4(a_vertex_position, 1.);gl_Position /= gl_Position.w;gl_PointSize = 2.;}}"),a.compileShader(b),a.getShaderParameter(b,a.COMPILE_STATUS)?b:(alert("Vertex shader failed to compile: "+a.getShaderInfoLog(b)),void 0)},c.loadDefaultFragmentShader=function(a){var b=a.createShader(a.FRAGMENT_SHADER);return a.shaderSource(b,"precision mediump float;\nuniform vec3 u_light_specular_color;uniform vec3 u_light_direction;uniform vec3 u_light_half_vector;uniform vec3 u_material_specular_color;uniform float u_material_shininess;uniform float u_material_alpha;uniform int u_fog_mode;uniform vec3 u_fog_color;uniform float u_fog_density;uniform float u_fog_start;uniform float u_fog_end;uniform sampler2D u_image;varying vec2 v_texcoord;varying vec3 v_diffuse;varying vec4 v_ambient;varying vec3 v_normal;void main(void){if(length(v_texcoord)!=0.) {gl_FragColor = texture2D(u_image, v_texcoord);}else if(length(v_normal)==0.){gl_FragColor = vec4(v_diffuse, u_material_alpha);}else{float nDotL = max(dot(v_normal, u_light_direction), 0.);vec4 color = vec4(v_diffuse*nDotL, 1.);float nDotHV = max(dot(v_normal, u_light_half_vector), 0.);vec3 specular = u_material_specular_color * u_light_specular_color;color+=vec4(specular * pow(nDotHV, u_material_shininess), 1.);gl_FragColor = color+v_ambient;gl_FragColor.a*=u_material_alpha;float fogCoord = gl_FragCoord.z/gl_FragCoord.w;float fogFactor = 1.;if(u_fog_mode == 1){if(fogCoord < u_fog_start){fogFactor = 1.;}else if(fogCoord > u_fog_end){fogFactor = 0.;}else{fogFactor = clamp((u_fog_end - fogCoord) / (u_fog_end - u_fog_start), 0., 1.);}}else if(u_fog_mode == 2) {fogFactor = clamp(exp(-u_fog_density*fogCoord), 0., 1.);}else if(u_fog_mode == 3) {fogFactor = clamp(exp(-pow(u_fog_density*fogCoord, 2.)), 0., 1.);}gl_FragColor = mix(vec4(u_fog_color, 1.), gl_FragColor, fogFactor);}}"),a.compileShader(b),a.getShaderParameter(b,a.COMPILE_STATUS)?b:(alert("Fragment shader failed to compile: "+a.getShaderInfoLog(b)),void 0)}}(ChemDoodle.structures.d3,document),function(a,b,c){b.Shape=function(b,d){var e,f,g,h,i,j,k,l,m,n;for(e=b.length,f=[],g=[],h=new a.Point,i=0,j=e;j>i;i++){for(k=i+1,i===j-1&&(k=0),l=b[i],k=b[k],m=c.cross([0,0,1],[k.x-l.x,k.y-l.y,0]),n=0;2>n;n++)f.push(l.x,l.y,d/2),f.push(l.x,l.y,-d/2),f.push(k.x,k.y,d/2),f.push(k.x,k.y,-d/2);for(n=0;4>n;n++)g.push(m[0],m[1],m[2]);g.push(0,0,1),g.push(0,0,-1),g.push(0,0,1),g.push(0,0,-1),h.add(l)}for(h.x/=e,h.y/=e,g.push(0,0,1),f.push(h.x,h.y,d/2),g.push(0,0,-1),f.push(h.x,h.y,-d/2),h=[],l=8*e,i=0,j=e;j>i;i++)e=8*i,h.push(e),h.push(e+3),h.push(e+1),h.push(e),h.push(e+2),h.push(e+3),h.push(e+4),h.push(l),h.push(e+6),h.push(e+5),h.push(e+7),h.push(l+1);this.storeData(f,g,h)},b.Shape.prototype=new b._Mesh
}(ChemDoodle.structures,ChemDoodle.structures.d3,ChemDoodle.lib.vec3),function(a,b,c){a.Star=function(){var a,b,d,e,f,g,h,i,j,k,l;for(a=[.8944,.4472,0,.2764,.4472,.8506,.2764,.4472,-.8506,-.7236,.4472,.5257,-.7236,.4472,-.5257,-.3416,.4472,0,-.1056,.4472,.3249,-.1056,.4472,-.3249,.2764,.4472,.2008,.2764,.4472,-.2008,-.8944,-.4472,0,-.2764,-.4472,.8506,-.2764,-.4472,-.8506,.7236,-.4472,.5257,.7236,-.4472,-.5257,.3416,-.4472,0,.1056,-.4472,.3249,.1056,-.4472,-.3249,-.2764,-.4472,.2008,-.2764,-.4472,-.2008,-.5527,.1058,0,-.1708,.1058,.5527,-.1708,.1058,-.5527,.4471,.1058,.3249,.4471,.1058,-.3249,.5527,-.1058,0,.1708,-.1058,.5527,.1708,-.1058,-.5527,-.4471,-.1058,.3249,-.4471,-.1058,-.3249,0,1,0,0,-1,0],b=[0,9,8,2,7,9,4,5,7,3,6,5,1,8,6,0,8,23,30,6,8,3,21,6,11,26,21,13,23,26,2,9,24,30,8,9,1,23,8,13,25,23,14,24,25,4,7,22,30,9,7,0,24,9,14,27,24,12,22,27,3,5,20,30,7,5,2,22,7,12,29,22,10,20,29,1,6,21,30,5,6,4,20,5,10,28,20,11,21,28,10,19,18,12,17,19,14,15,17,13,16,15,11,18,16,31,19,17,14,17,27,2,27,22,4,22,29,10,29,19,31,18,19,12,19,29,4,29,20,3,20,28,11,28,18,31,16,18,10,18,28,3,28,21,1,21,26,13,26,16,31,15,16,11,16,26,1,26,23,0,23,25,14,25,15,31,17,15,13,15,25,0,25,24,2,24,27,12,27,17],d=[],e=[],f=[],g=0,h=b.length;h>g;g+=3)i=3*b[g],j=3*b[g+1],k=3*b[g+2],i=[a[i],a[i+1],a[i+2]],j=[a[j],a[j+1],a[j+2]],k=[a[k],a[k+1],a[k+2]],l=c.cross([k[0]-j[0],k[1]-j[1],k[2]-j[2]],[i[0]-j[0],i[1]-j[1],i[2]-j[2]],[]),c.normalize(l),d.push(i[0],i[1],i[2],j[0],j[1],j[2],k[0],k[1],k[2]),e.push(l[0],l[1],l[2],l[0],l[1],l[2],l[0],l[1],l[2]),f.push(g,g+1,g+2);this.storeData(d,e,f)},a.Star.prototype=new a._Mesh}(ChemDoodle.structures.d3,Math,ChemDoodle.lib.vec3),function(a,b,c){a.TextImage=function(){this.ctx=c.createElement("canvas").getContext("2d"),this.data=[],this.text="",this.charHeight=0},a=a.TextImage.prototype,a.init=function(a){this.textureImage=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.textureImage),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,!1),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST),a.bindTexture(a.TEXTURE_2D,null),this.updateFont(a,12,["Sans-serif"],!1,!1,!1)},a.charData=function(a){return a=this.text.indexOf(a),a>=0?this.data[a]:null},a.updateFont=function(a,c,d,e,f,g){var l,m,n,o,p,q,h=this.ctx,i=this.ctx.canvas,j=[],k="";for(f=b.getFontString(c,d,e,f),h.font=f,h.save(),l=0,c*=1.5,d=32,e=127;e>d;d++)m=String.fromCharCode(d),n=h.measureText(m).width,j.push({text:m,width:n,height:c}),l+=2*n;for(o=["","?","?"],d=0,e=o.length;e>d;d++)m=o[d],n=h.measureText(m).width,j.push({text:m,width:n,height:c}),l+=2*n;for(d=Math.sqrt(l*c),d=Math.ceil(d/c),l=Math.ceil(l/(d-1)),i.width=l,i.height=d*c,h.font=f,h.textAlign="left",h.textBaseline="middle",h.strokeStyle="#000",h.lineWidth=1.4,h.fillStyle="#fff",d=m=f=0,e=j.length;e>d;d++)n=j[d],o=2*n.width,c=n.height,p=n.text,m+o>l&&(f++,m=0),q=f*c,g&&h.strokeText(p,m,q+c/2),h.fillText(p,m,q+c/2),n.x=m,n.y=q,k+=p,m+=o;this.text=k,this.data=j,this.charHeight=c,a.bindTexture(a.TEXTURE_2D,this.textureImage),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,i),a.bindTexture(a.TEXTURE_2D,null)},a.pushVertexData=function(a,b,c,d){var h,i,j,k,l,m,n,o,p,q,e=a.toString().split(""),f=this.getHeight(),g=this.getWidth();for(a=-this.textWidth(a)/2,h=-this.charHeight/2,i=0,j=e.length;j>i;i++)k=this.charData(e[i]),l=k.width,m=k.x/g,n=m+1.8*k.width/g,o=k.y/f,k=o+k.height/f,p=a+1.8*l,q=this.charHeight/2,d.position.push(b[0],b[1],b[2],b[0],b[1],b[2],b[0],b[1],b[2],b[0],b[1],b[2],b[0],b[1],b[2],b[0],b[1],b[2]),d.texCoord.push(m,o,n,k,n,o,m,o,m,k,n,k),d.translation.push(a,q,c,p,h,c,p,q,c,a,q,c,a,h,c,p,h,c),a=p+l-1.8*l},a.getCanvas=function(){return this.ctx.canvas},a.getHeight=function(){return this.getCanvas().height},a.getWidth=function(){return this.getCanvas().width},a.textWidth=function(a){return this.ctx.measureText(a).width},a.test=function(){c.body.appendChild(this.getCanvas())},a.useTexture=function(a){a.bindTexture(a.TEXTURE_2D,this.textureImage)}}(ChemDoodle.structures.d3,ChemDoodle.extensions,document),function(a){a.TextMesh=function(){},a=a.TextMesh.prototype,a.init=function(a){this.vertexPositionBuffer=a.createBuffer(),this.vertexTexCoordBuffer=a.createBuffer(),this.vertexTranslationBuffer=a.createBuffer()},a.setVertexData=function(a,b,c,d){a.bindBuffer(a.ARRAY_BUFFER,b),a.bufferData(a.ARRAY_BUFFER,new Float32Array(c),a.STATIC_DRAW),b.itemSize=d,b.numItems=c.length/d},a.storeData=function(a,b,c,d){this.setVertexData(a,this.vertexPositionBuffer,b,3),this.setVertexData(a,this.vertexTexCoordBuffer,c,2),this.setVertexData(a,this.vertexTranslationBuffer,d,3)},a.bindBuffers=function(a){a.bindBuffer(a.ARRAY_BUFFER,this.vertexPositionBuffer),a.vertexAttribPointer(a.shader.vertexPositionAttribute,this.vertexPositionBuffer.itemSize,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,this.vertexTexCoordBuffer),a.vertexAttribPointer(a.shader.vertexTexCoordAttribute,this.vertexTexCoordBuffer.itemSize,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,this.vertexTranslationBuffer),a.vertexAttribPointer(a.shader.vertexNormalAttribute,this.vertexTranslationBuffer.itemSize,a.FLOAT,!1,0,0)},a.render=function(a){var b=this.vertexPositionBuffer.numItems;b&&(this.bindBuffers(a),a.drawArrays(a.TRIANGLES,0,b))}}(ChemDoodle.structures.d3,Math),function(a,b,c,d,e,f,g){d.Torsion=function(a,b,c,d){this.a1=a,this.a2=b,this.a3=c,this.a4=d},a=d.Torsion.prototype=new d._Measurement,a.calculateData=function(a){var i,j,k,l,m,b=[],c=[],d=[],f=this.a2.distance3D(this.a1),h=this.a2.distance3D(this.a3);for(this.distUse=e.min(f,h)/2,h=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z],f=[this.a3.x-this.a2.x,this.a3.y-this.a2.y,this.a3.z-this.a2.z],i=[this.a4.x-this.a3.x,this.a4.y-this.a3.y,this.a4.z-this.a3.z],j=g.cross(h,f,[]),i=g.cross(f,i,[]),g.scale(h,g.length(f)),this.torsion=e.atan2(g.dot(h,i),g.dot(j,i)),h=g.normalize(g.cross(j,f,[])),j=g.normalize(g.cross(f,h,[])),this.pos=g.add([this.a2.x,this.a2.y,this.a2.z],g.scale(g.normalize(f,[]),this.distUse)),i=[],k=a.measurement_angleBands_3D,a=0;k>=a;++a)l=this.torsion*a/k,m=g.scale(h,e.cos(l),[]),l=g.scale(j,e.sin(l),[]),m=g.scale(g.normalize(g.add(m,l,[])),this.distUse),0==a&&(i=m),b.push(this.pos[0]+m[0],this.pos[1]+m[1],this.pos[2]+m[2]),c.push(0,0,0),k>a&&d.push(a,a+1);this.vecText=g.normalize(g.add(i,m,[])),f=g.normalize(f,[]),g.scale(f,.0625),l=this.torsion-2*e.asin(.125)*this.torsion/e.abs(this.torsion),m=g.scale(h,e.cos(l),[]),l=g.scale(j,e.sin(l),[]),m=g.scale(g.normalize(g.add(m,l,[])),this.distUse),b.push(this.pos[0]+f[0]+m[0],this.pos[1]+f[1]+m[1],this.pos[2]+f[2]+m[2]),c.push(0,0,0),b.push(this.pos[0]-f[0]+m[0],this.pos[1]-f[1]+m[1],this.pos[2]-f[2]+m[2]),c.push(0,0,0),d.push(--a,a+1,a,a+2),this.storeData(b,c,d)},a.getText=function(){return g.add(this.pos,g.scale(this.vecText,this.distUse+.3,[])),{pos:this.pos,value:[b.angleBounds(this.torsion,!0,!0).toFixed(2)," "].join("")}}}(ChemDoodle.ELEMENT,ChemDoodle.math,ChemDoodle.extensions,ChemDoodle.structures.d3,Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3),function(a,b,c,d,e,f,g,h){var i=function(a,b,c){var j,d=e.sqrt(b[1]*b[1]+b[2]*b[2]),g=[1,0,0,0,0,b[2]/d,-b[1]/d,0,0,b[1]/d,b[2]/d,0,0,0,0,1],h=[1,0,0,0,0,b[2]/d,b[1]/d,0,0,-b[1]/d,b[2]/d,0,0,0,0,1],i=[d,0,-b[0],0,0,1,0,0,b[0],0,d,0,0,0,0,1];b=[d,0,b[0],0,0,1,0,0,-b[0],0,d,0,0,0,0,1],c=[e.cos(c),-e.sin(c),0,0,e.sin(c),e.cos(c),0,0,0,0,1,0,0,0,0,1],j=f.multiply(g,f.multiply(i,f.multiply(c,f.multiply(b,h,[])))),this.rotate=function(){return f.multiplyVec3(j,a)}};d.Tube=function(d,j,k){var m,n,o,p,q,r,s,t,v,u,w,x,y,z,l=d[0].lineSegments[0].length;for(this.partitions=[],this.ends=[],this.ends.push(d[0].lineSegments[0][0]),this.ends.push(d[d.length-2].lineSegments[0][0]),n=[1,0,0],o=0,p=d.length-1;p>o;o++)for((!m||65e3<m.positionData.length)&&(0<this.partitions.length&&o--,m={count:0,positionData:[],normalData:[],indexData:[]},this.partitions.push(m)),q=d[o],m.count++,r=1/0,s=new c.Atom("",d[o+1].cp1.x,d[o+1].cp1.y,d[o+1].cp1.z),t=0;l>t;t++){for(u=q.lineSegments[0][t],v=t===l-1?o===d.length-2?q.lineSegments[0][t-1]:d[o+1].lineSegments[0][0]:q.lineSegments[0][t+1],v=[v.x-u.x,v.y-u.y,v.z-u.z],g.normalize(v),o===d.length-2&&t===l-1&&g.scale(v,-1),w=g.cross(v,n,[]),g.normalize(w),g.scale(w,j/2),w=new i(w,v,2*Math.PI/k),v=0,x=k;x>v;v++)y=w.rotate(),v===e.floor(k/4)&&(n=[y[0],y[1],y[2]]),m.normalData.push(y[0],y[1],y[2]),m.positionData.push(u.x+y[0],u.y+y[1],u.z+y[2]);s&&(v=u.distance3D(s),r>v&&(r=v,d[o+1].pPoint=u))}for(n=0,q=this.partitions.length;q>n;n++)for(m=this.partitions[n],o=0,p=m.count-1;p>o;o++)for(r=o*l*k,t=0,s=l;s>t;t++)for(u=r+t*k,v=0;k>v;v++)w=u+v,m.indexData.push(w),m.indexData.push(w+k),m.indexData.push(w+k+1),m.indexData.push(w),m.indexData.push(w+k+1),m.indexData.push(w+1);for(this.storeData(this.partitions[0].positionData,this.partitions[0].normalData,this.partitions[0].indexData),k=[new c.Point(2,0)],o=0;60>o;o++)l=o/60*e.PI,k.push(new c.Point(2*e.cos(l),-2*e.sin(l)));k.push(new c.Point(-2,0),new c.Point(-2,4),new c.Point(2,4)),z=new c.d3.Shape(k,1),this.render=function(i,k){var l,m,n,o,p,q,r,s,t;if(this.bindBuffers(i),i.material.setDiffuseColor(k.macro_colorByChain?this.chainColor:k.nucleics_tubeColor),i.drawElements(i.TRIANGLES,this.vertexIndexBuffer.numItems,i.UNSIGNED_SHORT,0),this.partitions)for(l=1,m=this.partitions.length;m>l;l++)n=this.partitions[l],o=i,p=n,o.bindBuffer(o.ARRAY_BUFFER,p.vertexPositionBuffer),o.vertexAttribPointer(o.shader.vertexPositionAttribute,p.vertexPositionBuffer.itemSize,o.FLOAT,!1,0,0),o.bindBuffer(o.ARRAY_BUFFER,p.vertexNormalBuffer),o.vertexAttribPointer(o.shader.vertexNormalAttribute,p.vertexNormalBuffer.itemSize,o.FLOAT,!1,0,0),o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,p.vertexIndexBuffer),i.drawElements(i.TRIANGLES,n.vertexIndexBuffer.numItems,i.UNSIGNED_SHORT,0);for(i.sphereBuffer.bindBuffers(i),l=0;2>l;l++)n=this.ends[l],n=f.translate(i.modelViewMatrix,[n.x,n.y,n.z],[]),m=j/2,f.scale(n,[m,m,m]),i.setMatrixUniforms(n),i.drawElements(i.TRIANGLES,i.sphereBuffer.vertexIndexBuffer.numItems,i.UNSIGNED_SHORT,0);for(i.cylinderBuffer.bindBuffers(i),l=1,m=d.length-1;m>l;l++)p=d[l],q=p.pPoint,r=new c.Atom("",p.cp2.x,p.cp2.y,p.cp2.z),n=1.001*q.distance3D(r),p=[j/4,n,j/4],n=f.translate(i.modelViewMatrix,[q.x,q.y,q.z],[]),s=[0,1,0],t=0,o=[r.x-q.x,r.y-q.y,r.z-q.z],q.x===r.x&&q.z===r.z?(s=[0,0,1],q.y<q.y&&(t=e.PI)):(t=a.vec3AngleFrom(s,o),s=g.cross(s,o,[])),0!==t&&f.rotate(n,t,s),f.scale(n,p),i.setMatrixUniforms(n),i.drawArrays(i.TRIANGLE_STRIP,0,i.cylinderBuffer.vertexPositionBuffer.numItems);for(z.bindBuffers(i),"none"===k.nucleics_residueColor&&!k.macro_colorByChain&&i.material.setDiffuseColor(k.nucleics_baseColor),l=1,m=d.length-1;m>l;l++)p=d[l],r=p.cp2,n=f.translate(i.modelViewMatrix,[r.x,r.y,r.z],[]),s=[0,1,0],t=0,q=p.cp3,o=[q.x-r.x,q.y-r.y,q.z-r.z],r.x===q.x&&r.z===q.z?(s=[0,0,1],r.y<r.y&&(t=e.PI)):(t=a.vec3AngleFrom(s,o),s=g.cross(s,o,[])),0!==t&&f.rotate(n,t,s),r=[1,0,0],t=f.rotate(f.identity([]),t,s),f.multiplyVec3(t,r),t=p.cp4,q=p.cp5,t.y===q.y&&t.z===q.z||(t=[q.x-t.x,q.y-t.y,q.z-t.z],q=a.vec3AngleFrom(r,t),0>g.dot(o,g.cross(r,t))&&(q*=-1),f.rotateY(n,q)),k.macro_colorByChain||("shapely"===k.nucleics_residueColor?b[p.name]?i.material.setDiffuseColor(b[p.name].shapelyColor):i.material.setDiffuseColor(b["*"].shapelyColor):"rainbow"===k.nucleics_residueColor&&i.material.setDiffuseColor(h.rainbowAt(l,m,k.macro_rainbowColors))),i.setMatrixUniforms(n),i.drawElements(i.TRIANGLES,z.vertexIndexBuffer.numItems,i.UNSIGNED_SHORT,0)}},d.Tube.prototype=new d._Mesh}(ChemDoodle.extensions,ChemDoodle.RESIDUE,ChemDoodle.structures,ChemDoodle.structures.d3,Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3,ChemDoodle.math),function(a){a.UnitCell=function(a){var e,b=[],c=[],d=function(a,d,e,f){for(b.push(a[0],a[1],a[2]),b.push(d[0],d[1],d[2]),b.push(e[0],e[1],e[2]),b.push(f[0],f[1],f[2]),a=0;4>a;a++)c.push(0,0,0)};for(d(a.o,a.x,a.xy,a.y),d(a.o,a.y,a.yz,a.z),d(a.o,a.z,a.xz,a.x),d(a.yz,a.y,a.xy,a.xyz),d(a.xyz,a.xz,a.z,a.yz),d(a.xy,a.x,a.xz,a.xyz),a=[],d=0;6>d;d++)e=4*d,a.push(e,e+1,e+1,e+2,e+2,e+3,e+3,e);this.storeData(b,c,a)},a.UnitCell.prototype=new a._Mesh}(ChemDoodle.structures.d3,ChemDoodle.lib.vec3),function(a,b,c){a.Plate=function(a){for(this.lanes=Array(a),i=0,ii=a;ii>i;i++)this.lanes[i]=[]};var d=a.Plate.prototype;d.sort=function(){for(i=0,ii=this.lanes.length;ii>i;i++)this.lanes[i].sort(function(a,b){return a-b})},d.draw=function(a){var f,d=a.canvas.width,e=a.canvas.height;for(this.origin=9*e/10,this.front=e/10,this.laneLength=this.origin-this.front,a.strokeStyle="#000000",a.beginPath(),a.moveTo(0,this.front),b.contextHashTo(a,0,this.front,d,this.front,3,3),a.closePath(),a.stroke(),a.beginPath(),a.moveTo(0,this.origin),a.lineTo(d,this.origin),a.closePath(),a.stroke(),i=0,ii=this.lanes.length;ii>i;i++)for(e=(i+1)*d/(ii+1),a.beginPath(),a.moveTo(e,this.origin),a.lineTo(e,this.origin+3),a.closePath(),a.stroke(),s=0,ss=this.lanes[i].length;ss>s;s++){switch(f=this.origin-this.laneLength*this.lanes[i][s].rf,this.lanes[i][s].type){case"compact":a.beginPath(),a.arc(e,f,3,0,2*c.PI,!1),a.closePath();break;case"expanded":a.beginPath(),a.arc(e,f,7,0,2*c.PI,!1),a.closePath();break;case"widened":b.contextOval(a,e-18,f-10,36,10);break;case"cresent":a.beginPath(),a.arc(e,f,9,0,c.PI,!0),a.closePath()}switch(this.lanes[i][s].style){case"solid":a.fillStyle="#000000",a.fill();break;case"transparent":a.stroke()}}},a.Plate.Spot=function(a,b,c){this.type=a,this.rf=b,this.style=c?c:"solid"}}(ChemDoodle.structures,ChemDoodle.extensions,Math),function(a,b,c){a.default_backgroundColor="#FFFFFF",a.default_scale=1,a.default_rotateAngle=0,a.default_bondLength_2D=20,a.default_angstromsPerBondLength=1.25,a.default_lightDirection_3D=[-.1,-.1,-1],a.default_lightDiffuseColor_3D="#FFFFFF",a.default_lightSpecularColor_3D="#FFFFFF",a.default_projectionPerspective_3D=!0,a.default_projectionPerspectiveVerticalFieldOfView_3D=45,a.default_projectionOrthoWidth_3D=40,a.default_projectionWidthHeightRatio_3D=void 0,a.default_projectionFrontCulling_3D=.1,a.default_projectionBackCulling_3D=1e4,a.default_cullBackFace_3D=!0,a.default_fog_mode_3D=0,a.default_fog_color_3D="#000000",a.default_fog_start_3D=0,a.default_fog_end_3D=1,a.default_fog_density_3D=1,a.default_atoms_display=!0,a.default_atoms_color="#000000",a.default_atoms_font_size_2D=12,a.default_atoms_font_families_2D=["Helvetica","Arial","Dialog"],a.default_atoms_font_bold_2D=!1,a.default_atoms_font_italic_2D=!1,a.default_atoms_circles_2D=!1,a.default_atoms_circleDiameter_2D=10,a.default_atoms_circleBorderWidth_2D=1,a.default_atoms_lonePairDistance_2D=8,a.default_atoms_lonePairSpread_2D=4,a.default_atoms_lonePairDiameter_2D=1,a.default_atoms_useJMOLColors=!1,a.default_atoms_usePYMOLColors=!1,a.default_atoms_resolution_3D=60,a.default_atoms_sphereDiameter_3D=.8,a.default_atoms_useVDWDiameters_3D=!1,a.default_atoms_vdwMultiplier_3D=1,a.default_atoms_materialAmbientColor_3D="#000000",a.default_atoms_materialSpecularColor_3D="#555555",a.default_atoms_materialShininess_3D=32,a.default_atoms_implicitHydrogens_2D=!0,a.default_atoms_displayTerminalCarbonLabels_2D=!1,a.default_atoms_showHiddenCarbons_2D=!0,a.default_atoms_showAttributedCarbons_2D=!0,a.default_atoms_displayAllCarbonLabels_2D=!1,a.default_atoms_nonBondedAsStars_3D=!1,a.default_atoms_displayLabels_3D=!1,a.default_atoms_HBlack_2D=!0,a.default_bonds_display=!0,a.default_bonds_color="#000000",a.default_bonds_width_2D=1,a.default_bonds_saturationWidth_2D=.2,a.default_bonds_ends_2D="round",a.default_bonds_useJMOLColors=!1,a.default_bonds_usePYMOLColors=!1,a.default_bonds_colorGradient=!1,a.default_bonds_saturationAngle_2D=c.PI/3,a.default_bonds_symmetrical_2D=!1,a.default_bonds_clearOverlaps_2D=!1,a.default_bonds_overlapClearWidth_2D=.5,a.default_bonds_atomLabelBuffer_2D=1,a.default_bonds_wedgeThickness_2D=.22,a.default_bonds_hashWidth_2D=1,a.default_bonds_hashSpacing_2D=2.5,a.default_bonds_dotSize_2D=2,a.default_bonds_lewisStyle_2D=!1,a.default_bonds_showBondOrders_3D=!1,a.default_bonds_resolution_3D=60,a.default_bonds_renderAsLines_3D=!1,a.default_bonds_cylinderDiameter_3D=.3,a.default_bonds_pillLatitudeResolution_3D=10,a.default_bonds_pillLongitudeResolution_3D=20,a.default_bonds_pillHeight_3D=.3,a.default_bonds_pillSpacing_3D=.1,a.default_bonds_pillDiameter_3D=.3,a.default_bonds_materialAmbientColor_3D="#222222",a.default_bonds_materialSpecularColor_3D="#555555",a.default_bonds_materialShininess_3D=32,a.default_proteins_displayRibbon=!0,a.default_proteins_displayBackbone=!1,a.default_proteins_backboneThickness=1.5,a.default_proteins_backboneColor="#CCCCCC",a.default_proteins_ribbonCartoonize=!1,a.default_proteins_residueColor="none",a.default_proteins_primaryColor="#FF0D0D",a.default_proteins_secondaryColor="#FFFF30",a.default_proteins_ribbonCartoonHelixPrimaryColor="#00E740",a.default_proteins_ribbonCartoonHelixSecondaryColor="#9905FF",a.default_proteins_ribbonCartoonSheetColor="#E8BB99",a.default_proteins_ribbonThickness=.2,a.default_proteins_verticalResolution=10,a.default_proteins_horizontalResolution=9,a.default_proteins_materialAmbientColor_3D="#222222",a.default_proteins_materialSpecularColor_3D="#555555",a.default_proteins_materialShininess_3D=32,a.default_nucleics_display=!0,a.default_nucleics_tubeColor="#CCCCCC",a.default_nucleics_baseColor="#C10000",a.default_nucleics_residueColor="none",a.default_nucleics_tubeThickness=1.5,a.default_nucleics_tubeResolution_3D=60,a.default_nucleics_verticalResolution=10,a.default_nucleics_materialAmbientColor_3D="#222222",a.default_nucleics_materialSpecularColor_3D="#555555",a.default_nucleics_materialShininess_3D=32,a.default_macro_displayAtoms=!1,a.default_macro_displayBonds=!1,a.default_macro_atomToLigandDistance=-1,a.default_macro_showWater=!1,a.default_macro_colorByChain=!1,a.default_macro_rainbowColors=["#0000FF","#00FFFF","#00FF00","#FFFF00","#FF0000"],a.default_surfaces_display=!0,a.default_surfaces_style="Dot",a.default_surfaces_color="#E9B862",a.default_surfaces_materialAmbientColor_3D="#000000",a.default_surfaces_materialSpecularColor_3D="#000000",a.default_surfaces_materialShininess_3D=32,a.default_crystals_displayUnitCell=!0,a.default_crystals_unitCellColor="green",a.default_crystals_unitCellLineWidth=1,a.default_plots_color="#000000",a.default_plots_width=1,a.default_plots_showIntegration=!1,a.default_plots_integrationColor="#c10000",a.default_plots_integrationLineWidth=1,a.default_plots_showGrid=!1,a.default_plots_gridColor="gray",a.default_plots_gridLineWidth=.5,a.default_plots_showYAxis=!0,a.default_plots_flipXAxis=!1,a.default_text_font_size=12,a.default_text_font_families=["Helvetica","Arial","Dialog"],a.default_text_font_bold=!0,a.default_text_font_italic=!1,a.default_text_font_stroke_3D=!0,a.default_text_color="#000000",a.default_shapes_color="#000000",a.default_shapes_lineWidth_2D=1,a.default_shapes_arrowLength_2D=8,a.default_compass_display=!1,a.default_compass_axisXColor_3D="#FF0000",a.default_compass_axisYColor_3D="#00FF00",a.default_compass_axisZColor_3D="#0000FF",a.default_compass_size_3D=50,a.default_compass_resolution_3D=10,a.default_compass_displayText_3D=!0,a.default_compass_type_3D=0,a.default_measurement_update_3D=!1,a.default_measurement_angleBands_3D=10,a.default_measurement_displayText_3D=!0,b.VisualSpecifications=function(){this.backgroundColor=a.default_backgroundColor,this.scale=a.default_scale,this.rotateAngle=a.default_rotateAngle,this.bondLength=a.default_bondLength_2D,this.angstromsPerBondLength=a.default_angstromsPerBondLength,this.lightDirection_3D=a.default_lightDirection_3D.slice(0),this.lightDiffuseColor_3D=a.default_lightDiffuseColor_3D,this.lightSpecularColor_3D=a.default_lightSpecularColor_3D,this.projectionPerspective_3D=a.default_projectionPerspective_3D,this.projectionPerspectiveVerticalFieldOfView_3D=a.default_projectionPerspectiveVerticalFieldOfView_3D,this.projectionOrthoWidth_3D=a.default_projectionOrthoWidth_3D,this.projectionWidthHeightRatio_3D=a.default_projectionWidthHeightRatio_3D,this.projectionFrontCulling_3D=a.default_projectionFrontCulling_3D,this.projectionBackCulling_3D=a.default_projectionBackCulling_3D,this.cullBackFace_3D=a.default_cullBackFace_3D,this.fog_mode_3D=a.default_fog_mode_3D,this.fog_color_3D=a.default_fog_color_3D,this.fog_start_3D=a.default_fog_start_3D,this.fog_end_3D=a.default_fog_end_3D,this.fog_density_3D=a.default_fog_density_3D,this.atoms_display=a.default_atoms_display,this.atoms_color=a.default_atoms_color,this.atoms_font_size_2D=a.default_atoms_font_size_2D,this.atoms_font_families_2D=a.default_atoms_font_families_2D.slice(0),this.atoms_font_bold_2D=a.default_atoms_font_bold_2D,this.atoms_font_italic_2D=a.default_atoms_font_italic_2D,this.atoms_circles_2D=a.default_atoms_circles_2D,this.atoms_circleDiameter_2D=a.default_atoms_circleDiameter_2D,this.atoms_circleBorderWidth_2D=a.default_atoms_circleBorderWidth_2D,this.atoms_lonePairDistance_2D=a.default_atoms_lonePairDistance_2D,this.atoms_lonePairSpread_2D=a.default_atoms_lonePairSpread_2D,this.atoms_lonePairDiameter_2D=a.default_atoms_lonePairDiameter_2D,this.atoms_useJMOLColors=a.default_atoms_useJMOLColors,this.atoms_usePYMOLColors=a.default_atoms_usePYMOLColors,this.atoms_resolution_3D=a.default_atoms_resolution_3D,this.atoms_sphereDiameter_3D=a.default_atoms_sphereDiameter_3D,this.atoms_useVDWDiameters_3D=a.default_atoms_useVDWDiameters_3D,this.atoms_vdwMultiplier_3D=a.default_atoms_vdwMultiplier_3D,this.atoms_materialAmbientColor_3D=a.default_atoms_materialAmbientColor_3D,this.atoms_materialSpecularColor_3D=a.default_atoms_materialSpecularColor_3D,this.atoms_materialShininess_3D=a.default_atoms_materialShininess_3D,this.atoms_implicitHydrogens_2D=a.default_atoms_implicitHydrogens_2D,this.atoms_displayTerminalCarbonLabels_2D=a.default_atoms_displayTerminalCarbonLabels_2D,this.atoms_showHiddenCarbons_2D=a.default_atoms_showHiddenCarbons_2D,this.atoms_showAttributedCarbons_2D=a.default_atoms_showAttributedCarbons_2D,this.atoms_displayAllCarbonLabels_2D=a.default_atoms_displayAllCarbonLabels_2D,this.atoms_nonBondedAsStars_3D=a.default_atoms_nonBondedAsStars_3D,this.atoms_displayLabels_3D=a.default_atoms_displayLabels_3D,this.atoms_HBlack_2D=a.default_atoms_HBlack_2D,this.bonds_display=a.default_bonds_display,this.bonds_color=a.default_bonds_color,this.bonds_width_2D=a.default_bonds_width_2D,this.bonds_saturationWidth_2D=a.default_bonds_saturationWidth_2D,this.bonds_ends_2D=a.default_bonds_ends_2D,this.bonds_useJMOLColors=a.default_bonds_useJMOLColors,this.bonds_usePYMOLColors=a.default_bonds_usePYMOLColors,this.bonds_colorGradient=a.default_bonds_colorGradient,this.bonds_saturationAngle_2D=a.default_bonds_saturationAngle_2D,this.bonds_symmetrical_2D=a.default_bonds_symmetrical_2D,this.bonds_clearOverlaps_2D=a.default_bonds_clearOverlaps_2D,this.bonds_overlapClearWidth_2D=a.default_bonds_overlapClearWidth_2D,this.bonds_atomLabelBuffer_2D=a.default_bonds_atomLabelBuffer_2D,this.bonds_wedgeThickness_2D=a.default_bonds_wedgeThickness_2D,this.bonds_hashWidth_2D=a.default_bonds_hashWidth_2D,this.bonds_hashSpacing_2D=a.default_bonds_hashSpacing_2D,this.bonds_dotSize_2D=a.default_bonds_dotSize_2D,this.bonds_lewisStyle_2D=a.default_bonds_lewisStyle_2D,this.bonds_showBondOrders_3D=a.default_bonds_showBondOrders_3D,this.bonds_resolution_3D=a.default_bonds_resolution_3D,this.bonds_renderAsLines_3D=a.default_bonds_renderAsLines_3D,this.bonds_cylinderDiameter_3D=a.default_bonds_cylinderDiameter_3D,this.bonds_pillHeight_3D=a.default_bonds_pillHeight_3D,this.bonds_pillLatitudeResolution_3D=a.default_bonds_pillLatitudeResolution_3D,this.bonds_pillLongitudeResolution_3D=a.default_bonds_pillLongitudeResolution_3D,this.bonds_pillSpacing_3D=a.default_bonds_pillSpacing_3D,this.bonds_pillDiameter_3D=a.default_bonds_pillDiameter_3D,this.bonds_materialAmbientColor_3D=a.default_bonds_materialAmbientColor_3D,this.bonds_materialSpecularColor_3D=a.default_bonds_materialSpecularColor_3D,this.bonds_materialShininess_3D=a.default_bonds_materialShininess_3D,this.proteins_displayRibbon=a.default_proteins_displayRibbon,this.proteins_displayBackbone=a.default_proteins_displayBackbone,this.proteins_backboneThickness=a.default_proteins_backboneThickness,this.proteins_backboneColor=a.default_proteins_backboneColor,this.proteins_ribbonCartoonize=a.default_proteins_ribbonCartoonize,this.proteins_residueColor=a.default_proteins_residueColor,this.proteins_primaryColor=a.default_proteins_primaryColor,this.proteins_secondaryColor=a.default_proteins_secondaryColor,this.proteins_ribbonCartoonHelixPrimaryColor=a.default_proteins_ribbonCartoonHelixPrimaryColor,this.proteins_ribbonCartoonHelixSecondaryColor=a.default_proteins_ribbonCartoonHelixSecondaryColor,this.proteins_ribbonCartoonSheetColor=a.default_proteins_ribbonCartoonSheetColor,this.proteins_ribbonThickness=a.default_proteins_ribbonThickness,this.proteins_verticalResolution=a.default_proteins_verticalResolution,this.proteins_horizontalResolution=a.default_proteins_horizontalResolution,this.proteins_materialAmbientColor_3D=a.default_proteins_materialAmbientColor_3D,this.proteins_materialSpecularColor_3D=a.default_proteins_materialSpecularColor_3D,this.proteins_materialShininess_3D=a.default_proteins_materialShininess_3D,this.macro_displayAtoms=a.default_macro_displayAtoms,this.macro_displayBonds=a.default_macro_displayBonds,this.macro_atomToLigandDistance=a.default_macro_atomToLigandDistance,this.nucleics_display=a.default_nucleics_display,this.nucleics_tubeColor=a.default_nucleics_tubeColor,this.nucleics_baseColor=a.default_nucleics_baseColor,this.nucleics_residueColor=a.default_nucleics_residueColor,this.nucleics_tubeThickness=a.default_nucleics_tubeThickness,this.nucleics_tubeResolution_3D=a.default_nucleics_tubeResolution_3D,this.nucleics_verticalResolution=a.default_nucleics_verticalResolution,this.nucleics_materialAmbientColor_3D=a.default_nucleics_materialAmbientColor_3D,this.nucleics_materialSpecularColor_3D=a.default_nucleics_materialSpecularColor_3D,this.nucleics_materialShininess_3D=a.default_nucleics_materialShininess_3D,this.macro_showWater=a.default_macro_showWater,this.macro_colorByChain=a.default_macro_colorByChain,this.macro_rainbowColors=a.default_macro_rainbowColors.slice(0),this.surfaces_display=a.default_surfaces_display,this.surfaces_style=a.default_surfaces_style,this.surfaces_color=a.default_surfaces_color,this.surfaces_materialAmbientColor_3D=a.default_surfaces_materialAmbientColor_3D,this.surfaces_materialSpecularColor_3D=a.default_surfaces_materialSpecularColor_3D,this.surfaces_materialShininess_3D=a.default_surfaces_materialShininess_3D,this.crystals_displayUnitCell=a.default_crystals_displayUnitCell,this.crystals_unitCellColor=a.default_crystals_unitCellColor,this.crystals_unitCellLineWidth=a.default_crystals_unitCellLineWidth,this.plots_color=a.default_plots_color,this.plots_width=a.default_plots_width,this.plots_showIntegration=a.default_plots_showIntegration,this.plots_integrationColor=a.default_plots_integrationColor,this.plots_integrationLineWidth=a.default_plots_integrationLineWidth,this.plots_showGrid=a.default_plots_showGrid,this.plots_gridColor=a.default_plots_gridColor,this.plots_gridLineWidth=a.default_plots_gridLineWidth,this.plots_showYAxis=a.default_plots_showYAxis,this.plots_flipXAxis=a.default_plots_flipXAxis,this.text_font_size=a.default_text_font_size,this.text_font_families=a.default_text_font_families.slice(0),this.text_font_bold=a.default_text_font_bold,this.text_font_italic=a.default_text_font_italic,this.text_font_stroke_3D=a.default_text_font_stroke_3D,this.text_color=a.default_text_color,this.shapes_color=a.default_shapes_color,this.shapes_lineWidth_2D=a.default_shapes_lineWidth_2D,this.shapes_arrowLength_2D=a.default_shapes_arrowLength_2D,this.compass_display=a.default_compass_display,this.compass_axisXColor_3D=a.default_compass_axisXColor_3D,this.compass_axisYColor_3D=a.default_compass_axisYColor_3D,this.compass_axisZColor_3D=a.default_compass_axisZColor_3D,this.compass_size_3D=a.default_compass_size_3D,this.compass_resolution_3D=a.default_compass_resolution_3D,this.compass_displayText_3D=a.default_compass_displayText_3D,this.compass_type_3D=a.default_compass_type_3D,this.measurement_update_3D=a.default_measurement_update_3D,this.measurement_angleBands_3D=a.default_measurement_angleBands_3D,this.measurement_displayText_3D=a.default_measurement_displayText_3D},b.VisualSpecifications.prototype.set3DRepresentation=function(b){this.bonds_display=this.atoms_display=!0,this.bonds_color="#777777",this.bonds_showBondOrders_3D=this.bonds_useJMOLColors=this.atoms_useJMOLColors=this.atoms_useVDWDiameters_3D=!0,this.bonds_renderAsLines_3D=!1,"Ball and Stick"===b?(this.atoms_vdwMultiplier_3D=.3,this.bonds_useJMOLColors=!1,this.bonds_cylinderDiameter_3D=.3,this.bonds_materialAmbientColor_3D=a.default_atoms_materialAmbientColor_3D,this.bonds_pillDiameter_3D=.15):"van der Waals Spheres"===b?(this.bonds_display=!1,this.atoms_vdwMultiplier_3D=1):"Stick"===b?(this.bonds_showBondOrders_3D=this.atoms_useVDWDiameters_3D=!1,this.bonds_cylinderDiameter_3D=this.atoms_sphereDiameter_3D=.8,this.bonds_materialAmbientColor_3D=this.atoms_materialAmbientColor_3D):"Wireframe"===b?(this.atoms_useVDWDiameters_3D=!1,this.bonds_cylinderDiameter_3D=this.bonds_pillDiameter_3D=.05,this.atoms_sphereDiameter_3D=.15,this.bonds_materialAmbientColor_3D=a.default_atoms_materialAmbientColor_3D):"Line"===b?(this.atoms_display=!1,this.bonds_renderAsLines_3D=!0,this.bonds_width_2D=1,this.bonds_cylinderDiameter_3D=.05):alert('"'+b+'" is not recognized. Use one of the following strings:\n\n1. Ball and Stick\n2. van der Waals Spheres\n3. Stick\n4. Wireframe\n5. Line\n')}}(ChemDoodle,ChemDoodle.structures,Math),function(a,b,c,d){c.getPointsPerAngstrom=function(){return a.default_bondLength_2D/a.default_angstromsPerBondLength},c.BondDeducer=function(){};var e=c.BondDeducer.prototype;e.margin=1.1,e.deduceCovalentBonds=function(a,e){var g,h,i,j,k,f=c.getPointsPerAngstrom();for(e&&(f=e),g=0,h=a.atoms.length;h>g;g++)for(i=g+1;h>i;i++)j=a.atoms[g],k=a.atoms[i],j.distance3D(k)<(b[j.label].covalentRadius+b[k.label].covalentRadius)*f*this.margin&&a.bonds.push(new d.Bond(j,k,1))}}(ChemDoodle,ChemDoodle.ELEMENT,ChemDoodle.informatics,ChemDoodle.structures),function(a){a.HydrogenDeducer=function(){},a.HydrogenDeducer.prototype.removeHydrogens=function(a){for(var b=[],c=[],d=0,e=a.bonds.length;e>d;d++)"H"!==a.bonds[d].a1.label&&"H"!==a.bonds[d].a2.label&&c.push(a.bonds[d]);for(d=0,e=a.atoms.length;e>d;d++)"H"!==a.atoms[d].label&&b.push(a.atoms[d]);a.atoms=b,a.bonds=c}}(ChemDoodle.informatics),function(a,b,c){b.MolecularSurfaceGenerator=function(){},b.MolecularSurfaceGenerator.prototype.generateSurface=function(a,b,d,e,f){return new c.MolecularSurface(a,b,d,e,f)}}(ChemDoodle,ChemDoodle.informatics,ChemDoodle.structures.d3),function(a,b){a.Splitter=function(){},a.Splitter.prototype.split=function(a){var c,d,e,f,g,h,i,j,k;for(c=[],d=0,e=a.atoms.length;e>d;d++)a.atoms[d].visited=!1;for(d=0,e=a.bonds.length;e>d;d++)a.bonds[d].visited=!1;for(d=0,e=a.atoms.length;e>d;d++)if(f=a.atoms[d],!f.visited){for(g=new b.Molecule,g.atoms.push(f),f.visited=!0,h=new b.Queue,h.enqueue(f);!h.isEmpty();)for(f=h.dequeue(),i=0,j=a.bonds.length;j>i;i++)k=a.bonds[i],k.contains(f)&&!k.visited&&(k.visited=!0,g.bonds.push(k),k=k.getNeighbor(f),k.visited||(k.visited=!0,g.atoms.push(k),h.enqueue(k)));c.push(g)}return c}}(ChemDoodle.informatics,ChemDoodle.structures),function(a,b){a.StructureBuilder=function(){},a.StructureBuilder.prototype.copy=function(a){var c=new b.JSONInterpreter;return c.molFrom(c.molTo(a))}}(ChemDoodle.informatics,ChemDoodle.io,ChemDoodle.structures),function(a){a._Counter=function(){},a=a._Counter.prototype,a.value=0,a.molecule=void 0,a.setMolecule=function(a){this.value=0,this.molecule=a,this.innerCalculate&&this.innerCalculate()}}(ChemDoodle.informatics),function(a){a.FrerejacqueNumberCounter=function(a){this.setMolecule(a)
},(a.FrerejacqueNumberCounter.prototype=new a._Counter).innerCalculate=function(){this.value=this.molecule.bonds.length-this.molecule.atoms.length+new a.NumberOfMoleculesCounter(this.molecule).value}}(ChemDoodle.informatics),function(a,b){b.NumberOfMoleculesCounter=function(a){this.setMolecule(a)},(b.NumberOfMoleculesCounter.prototype=new b._Counter).innerCalculate=function(){var b,c,d,e,f,g,h;for(b=0,c=this.molecule.atoms.length;c>b;b++)this.molecule.atoms[b].visited=!1;for(b=0,c=this.molecule.atoms.length;c>b;b++)if(!this.molecule.atoms[b].visited)for(this.value++,d=new a.Queue,this.molecule.atoms[b].visited=!0,d.enqueue(this.molecule.atoms[b]);!d.isEmpty();)for(e=d.dequeue(),f=0,g=this.molecule.bonds.length;g>f;f++)h=this.molecule.bonds[f],h.contains(e)&&(h=h.getNeighbor(e),h.visited||(h.visited=!0,d.enqueue(h)))}}(ChemDoodle.structures,ChemDoodle.informatics),function(a){a._RingFinder=function(){},a=a._RingFinder.prototype,a.atoms=void 0,a.bonds=void 0,a.rings=void 0,a.reduce=function(a){var b,c,d,f,e,g,h;for(b=0,c=a.atoms.length;c>b;b++)a.atoms[b].visited=!1;for(b=0,c=a.bonds.length;c>b;b++)a.bonds[b].visited=!1;for(d=!0;d;)for(d=!1,b=0,c=a.atoms.length;c>b;b++){for(e=0,g=0,h=a.bonds.length;h>g;g++)if(a.bonds[g].contains(a.atoms[b])&&!a.bonds[g].visited){if(e++,2===e)break;f=a.bonds[g]}1===e&&(d=!0,f.visited=!0,a.atoms[b].visited=!0)}for(b=0,c=a.atoms.length;c>b;b++)a.atoms[b].visited||this.atoms.push(a.atoms[b]);for(b=0,c=a.bonds.length;c>b;b++)a.bonds[b].visited||this.bonds.push(a.bonds[b]);0===this.bonds.length&&0!==this.atoms.length&&(this.atoms=[])},a.setMolecule=function(a){this.atoms=[],this.bonds=[],this.rings=[],this.reduce(a),2<this.atoms.length&&this.innerGetRings&&this.innerGetRings()},a.fuse=function(){var a,b,c,d;for(a=0,b=this.rings.length;b>a;a++)for(c=0,d=this.bonds.length;d>c;c++)-1!==this.rings[a].atoms.indexOf(this.bonds[c].a1)&&-1!==this.rings[a].atoms.indexOf(this.bonds[c].a2)&&this.rings[a].bonds.push(this.bonds[c])}}(ChemDoodle.informatics),function(a,b){function c(a,b){if(this.atoms=[],b)for(var c=0,d=b.atoms.length;d>c;c++)this.atoms[c]=b.atoms[c];this.atoms.push(a)}var d=c.prototype;d.grow=function(a,b){var d,e,f,g,h;for(d=this.atoms[this.atoms.length-1],e=[],f=0,g=a.length;g>f;f++)a[f].contains(d)&&(h=a[f].getNeighbor(d),-1===b.indexOf(h)&&e.push(h));for(d=[],f=0,g=e.length;g>f;f++)d.push(new c(e[f],this));return d},d.check=function(a,c,d){var e,f,g,h;for(e=0,f=c.atoms.length-1;f>e;e++)if(-1!==this.atoms.indexOf(c.atoms[e]))return;if(c.atoms[c.atoms.length-1]===this.atoms[this.atoms.length-1]){for(g=new b.Ring,g.atoms[0]=d,e=0,f=this.atoms.length;f>e;e++)g.atoms.push(this.atoms[e]);for(e=c.atoms.length-2;e>=0;e--)g.atoms.push(c.atoms[e])}else{for(h=[],e=0,f=a.length;f>e;e++)a[e].contains(c.atoms[c.atoms.length-1])&&h.push(a[e]);for(e=0,f=h.length;f>e;e++)if((1===c.atoms.length||!h[e].contains(c.atoms[c.atoms.length-2]))&&h[e].contains(this.atoms[this.atoms.length-1])){for(g=new b.Ring,g.atoms[0]=d,a=0,d=this.atoms.length;d>a;a++)g.atoms.push(this.atoms[a]);for(a=c.atoms.length-1;a>=0;a--)g.atoms.push(c.atoms[a]);break}}return g},a.EulerFacetRingFinder=function(a){this.setMolecule(a)},d=a.EulerFacetRingFinder.prototype=new a._RingFinder,d.fingerBreak=5,d.innerGetRings=function(){var a,b,d,e,f,g,h,i,j,k,l,m,n,o,p;for(a=0,b=this.atoms.length;b>a;a++){for(d=[],e=0,f=this.bonds.length;f>e;e++)this.bonds[e].contains(this.atoms[a])&&d.push(this.bonds[e].getNeighbor(this.atoms[a]));for(e=0,f=d.length;f>e;e++)for(g=e+1;g<d.length;g++){for(h=[],h[0]=new c(d[e]),h[1]=new c(d[g]),i=[],i[0]=this.atoms[a],j=0,k=d.length;k>j;j++)j!==e&&j!==g&&i.push(d[j]);for(l=[],(j=h[0].check(this.bonds,h[1],this.atoms[a]))&&(l[0]=j);0===l.length&&0<h.length&&h[0].atoms.length<this.fingerBreak;){for(m=[],j=0,k=h.length;k>j;j++)for(n=h[j].grow(this.bonds,i),o=0,p=n.length;p>o;o++)m.push(n[o]);for(h=m,j=0,k=h.length;k>j;j++)for(o=j+1;k>o;o++)(p=h[j].check(this.bonds,h[o],this.atoms[a]))&&l.push(p);if(0===l.length){for(m=[],j=0,k=i.length;k>j;j++)for(o=0,p=this.bonds.length;p>o;o++)this.bonds[o].contains(i[j])&&(d=this.bonds[o].getNeighbor(i[j]),-1===i.indexOf(d)&&-1===m.indexOf(d)&&m.push(d));for(j=0,k=m.length;k>j;j++)i.push(m[j])}}if(0<l.length){for(h=void 0,j=0,k=l.length;k>j;j++)(!h||h.atoms.length>l[j].atoms.length)&&(h=l[j]);for(l=!1,j=0,k=this.rings.length;k>j;j++){for(i=!0,o=0,p=h.atoms.length;p>o;o++)if(-1===this.rings[j].atoms.indexOf(h.atoms[o])){i=!1;break}if(i){l=!0;break}}l||this.rings.push(h)}}}this.fuse()}}(ChemDoodle.informatics,ChemDoodle.structures),function(a){a.SSSRFinder=function(b){var c,d,e,f,g,h;if(this.rings=[],0<b.atoms.length){for(c=new a.FrerejacqueNumberCounter(b).value,d=new a.EulerFacetRingFinder(b).rings,d.sort(function(a,b){return a.atoms.length-b.atoms.length}),e=0,f=b.bonds.length;f>e;e++)b.bonds[e].visited=!1;for(e=0,f=d.length;f>e;e++){for(b=!1,g=0,h=d[e].bonds.length;h>g;g++)if(!d[e].bonds[g].visited){b=!0;break}if(b){for(g=0,h=d[e].bonds.length;h>g;g++)d[e].bonds[g].visited=!0;this.rings.push(d[e])}if(this.rings.length===c)break}}}}(ChemDoodle.informatics),function(a){a._Interpreter=function(){},a._Interpreter.prototype.fit=function(a,b,c){for(var d=a.length,e=[],f=0;b-d>f;f++)e.push(" ");return c?a+e.join(""):e.join("")+a}}(ChemDoodle.io),function(a,b,c,d,e,f){var q,g=/\s+/g,h=/\(|\)|\s+/g,i=/\'|\s+/g,j=/,|\'|\s+/g,k=/^\s+/,l=/[0-9]/g,m=/[0-9]|\+|\-/g,n=function(a){return 0!==a.length},o={P:[],A:[[0,.5,.5]],B:[[.5,0,.5]],C:[[.5,.5,0]],I:[[.5,.5,.5]],R:[[2/3,1/3,1/3],[1/3,2/3,2/3]],S:[[1/3,1/3,2/3],[2/3,2/3,1/3]],T:[[1/3,2/3,1/3],[2/3,1/3,2/3]],F:[[0,.5,.5],[.5,0,.5],[.5,.5,0]]},p=function(a){var i,b=0,c=0,d=0,e=0,f=a.indexOf("x"),g=a.indexOf("y"),h=a.indexOf("z");if(-1!==f&&(c++,f>0&&"+"!==a.charAt(f-1)&&(c*=-1)),-1!==g&&(d++,g>0&&"+"!==a.charAt(g-1)&&(d*=-1)),-1!==h&&(e++,h>0&&"+"!==a.charAt(h-1)&&(e*=-1)),2<a.length)for(f="+",g=0,h=a.length;h>g;g++)i=a.charAt(g),"-"!==i&&"/"!==i||g!==a.length-1&&!a.charAt(g+1).match(l)||(f=i),i.match(l)&&("+"===f?b+=parseInt(i):"-"===f?b-=parseInt(i):"/"===f&&(b/=parseInt(i)));return[b,c,d,e]};c.CIFInterpreter=function(){},(c.CIFInterpreter.prototype=new c._Interpreter).read=function(c,l,q,r){var s,A,B,C,D,t,u,v,w,x,y,z,E,F,G,H,I,J,K,L;if(l=l?l:1,q=q?q:1,r=r?r:1,s=new d.Molecule,!c)return s;for(t=c.split("\n"),u=0,v=0,w=0,x=c=0,y=0,z="P",E=!0;0<t.length;)if(E?D=t.shift():E=!0,0<D.length)if(b.stringStartsWith(D,"_cell_length_a"))u=parseFloat(D.split(h)[1]);else if(b.stringStartsWith(D,"_cell_length_b"))v=parseFloat(D.split(h)[1]);else if(b.stringStartsWith(D,"_cell_length_c"))w=parseFloat(D.split(h)[1]);else if(b.stringStartsWith(D,"_cell_angle_alpha"))c=e.PI*parseFloat(D.split(h)[1])/180;else if(b.stringStartsWith(D,"_cell_angle_beta"))x=e.PI*parseFloat(D.split(h)[1])/180;else if(b.stringStartsWith(D,"_cell_angle_gamma"))y=e.PI*parseFloat(D.split(h)[1])/180;else if(b.stringStartsWith(D,"_symmetry_space_group_name_H-M"))z=D.split(i)[1];else if(b.stringStartsWith(D,"loop_")){for(F={fields:[],lines:[]},G=!1;void 0!==(D=t.shift())&&!b.stringStartsWith(D=D.replace(k,""),"loop_")&&0<D.length;)if(b.stringStartsWith(D,"_")){if(G)break;F.fields=F.fields.concat(D.split(g).filter(n))}else G=!0,F.lines.push(D);0!==t.length&&(b.stringStartsWith(D,"loop_")||b.stringStartsWith(D,"_"))&&(E=!1),-1!==F.fields.indexOf("_symmetry_equiv_pos_as_xyz")||-1!==F.fields.indexOf("_space_group_symop_operation_xyz")?A=F:-1!==F.fields.indexOf("_atom_site_label")?B=F:-1!==F.fields.indexOf("_geom_bond_atom_site_label_1")&&(C=F)}if(D=u,c=(e.cos(c)-e.cos(y)*e.cos(x))/e.sin(y),c=[D,0,0,0,v*e.cos(y),v*e.sin(y),0,0,w*e.cos(x),w*c,w*e.sqrt(1-e.pow(e.cos(x),2)-c*c),0,0,0,0,1],B){for(F=E=u=t=w=-1,y=0,x=B.fields.length;x>y;y++)D=B.fields[y],"_atom_site_type_symbol"===D?w=y:"_atom_site_label"===D?t=y:"_atom_site_fract_x"===D?u=y:"_atom_site_fract_y"===D?E=y:"_atom_site_fract_z"===D&&(F=y);for(y=0,x=B.lines.length;x>y;y++)D=B.lines[y],v=D.split(g).filter(n),D=new d.Atom(v[-1===w?t:w].split(m)[0],parseFloat(v[u]),parseFloat(v[E]),parseFloat(v[F])),s.atoms.push(D),-1!==t&&(D.cifId=v[t],D.cifPart=0)}if(A&&!C){for(y=v=0,x=A.fields.length;x>y;y++)D=A.fields[y],("_symmetry_equiv_pos_as_xyz"===D||"_space_group_symop_operation_xyz"===D)&&(v=y);for(E=o[z],t=[],y=0,x=A.lines.length;x>y;y++)for(D=A.lines[y].split(j).filter(n),F=p(D[v]),G=p(D[v+1]),H=p(D[v+2]),z=0,u=s.atoms.length;u>z;z++)if(D=s.atoms[z],I=D.x*F[1]+D.y*F[2]+D.z*F[3]+F[0],J=D.x*G[1]+D.y*G[2]+D.z*G[3]+G[0],K=D.x*H[1]+D.y*H[2]+D.z*H[3]+H[0],B=new d.Atom(D.label,I,J,K),t.push(B),void 0!==D.cifId&&(B.cifId=D.cifId,B.cifPart=y+1),E)for(B=0,w=E.length;w>B;B++)L=E[B],L=new d.Atom(D.label,I+L[0],J+L[1],K+L[2]),t.push(L),void 0!==D.cifId&&(L.cifId=D.cifId,L.cifPart=y+1);for(y=0,x=t.length;x>y;y++){for(D=t[y];1<=D.x;)D.x--;for(;0>D.x;)D.x++;for(;1<=D.y;)D.y--;for(;0>D.y;)D.y++;for(;1<=D.z;)D.z--;for(;0>D.z;)D.z++}for(B=[],y=0,x=t.length;x>y;y++){for(w=!1,D=t[y],z=0,u=s.atoms.length;u>z;z++)if(1e-4>s.atoms[z].distance3D(D)){w=!0;break}if(!w){for(z=0,u=B.length;u>z;z++)if(1e-4>B[z].distance3D(D)){w=!0;break}w||B.push(D)}}s.atoms=s.atoms.concat(B)}for(x=[],y=0;l>y;y++)for(z=0;q>z;z++)for(B=0;r>B;B++)if(0!==y||0!==z||0!==B)for(w=0,v=s.atoms.length;v>w;w++)D=s.atoms[w],t=new d.Atom(D.label,D.x+y,D.y+z,D.z+B),x.push(t),void 0!==D.cifId&&(t.cifId=D.cifId,t.cifPart=D.cifPart+(A?A.lines.length:0)+y+10*z+100*B);for(s.atoms=s.atoms.concat(x),y=0,x=s.atoms.length;x>y;y++)D=s.atoms[y],A=f.multiplyVec3(c,[D.x,D.y,D.z]),D.x=A[0],D.y=A[1],D.z=A[2];if(C){for(t=A=-1,y=0,x=C.fields.length;x>y;y++)D=C.fields[y],"_geom_bond_atom_site_label_1"===D?A=y:"_geom_bond_atom_site_label_2"===D&&(t=y);for(B=0,w=C.lines.length;w>B;B++)for(v=C.lines[B].split(g).filter(n),D=v[A],v=v[t],y=0,x=s.atoms.length;x>y;y++)for(z=y+1;x>z&&(u=s.atoms[y],E=s.atoms[z],u.cifPart===E.cifPart);z++)(u.cifId===D&&E.cifId===v||u.cifId===v&&E.cifId===D)&&s.bonds.push(new d.Bond(u,E))}else(new a.informatics.BondDeducer).deduceCovalentBonds(s,1);return l=[-l/2,-q/2,-r/2],s.unitCellVectors={o:f.multiplyVec3(c,l,[]),x:f.multiplyVec3(c,[l[0]+1,l[1],l[2]]),y:f.multiplyVec3(c,[l[0],l[1]+1,l[2]]),z:f.multiplyVec3(c,[l[0],l[1],l[2]+1]),xy:f.multiplyVec3(c,[l[0]+1,l[1]+1,l[2]]),xz:f.multiplyVec3(c,[l[0]+1,l[1],l[2]+1]),yz:f.multiplyVec3(c,[l[0],l[1]+1,l[2]+1]),xyz:f.multiplyVec3(c,[l[0]+1,l[1]+1,l[2]+1])},s},q=new c.CIFInterpreter,a.readCIF=function(a,b,c,d){return q.read(a,b,c,d)}}(ChemDoodle,ChemDoodle.extensions,ChemDoodle.io,ChemDoodle.structures,Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3),function(a,b,c,d){var e,f;b.CMLInterpreter=function(){},e=b.CMLInterpreter.prototype=new b._Interpreter,e.read=function(a){var e,f,g,h,i,j,k,l,m,n,q,r,s,o,p,b=[];for(a=d.parseXML(a),a=d(a).find("cml"),e=0,f=a.length;f>e;e++)for(g=d(a[e]).find("molecule"),h=0,i=g.length;i>h;h++){for(j=b[h]=new c.Molecule,k=[],l=d(g[h]).find("atom"),m=0,n=l.length;n>m;m++)o=d(l[m]),p=o.attr("elementType"),void 0==o.attr("x2")?(q=o.attr("x3"),r=o.attr("y3"),s=o.attr("z3")):(q=o.attr("x2"),r=o.attr("y2"),s=0),p=b[h].atoms[m]=new c.Atom(p,q,r,s),k[m]=o.attr("id"),void 0!=o.attr("formalCharge")&&(p.charge=o.attr("formalCharge"));for(l=d(g[h]).find("bond"),m=0,n=l.length;n>m;m++){switch(o=d(l[m]),q=o.attr("atomRefs2").split(" "),p=j.atoms[d.inArray(q[0],k)],q=j.atoms[d.inArray(q[1],k)],o.attr("order")){case"2":case"D":r=2;break;case"3":case"T":r=3;break;case"A":r=1.5;break;default:r=1}switch(p=b[h].bonds[m]=new c.Bond(p,q,r),o.find("bondStereo").text()){case"W":p.stereo=c.Bond.STEREO_PROTRUDING;break;case"H":p.stereo=c.Bond.STEREO_RECESSED}}}return b},e.write=function(a){var c,d,e,f,g,b=[];for(b.push('<?xml version="1.0" encoding="UTF-8"?>\n'),b.push('<cml convention="conventions:molecular" xmlns="http://www.xml-cml.org/schema" xmlns:conventions="http://www.xml-cml.org/convention/" xmlns:dc="http://purl.org/dc/elements/1.1/">\n'),c=0,d=a.length;d>c;c++){for(b.push('<molecule id="m'),b.push(c),b.push('">'),b.push("<atomArray>"),e=0,f=a[c].atoms.length;f>e;e++)g=a[c].atoms[e],b.push('<atom elementType="'),b.push(g.label),b.push('" id="a'),b.push(e),b.push('" '),b.push('x3="'),b.push(g.x),b.push('" y3="'),b.push(g.y),b.push('" z3="'),b.push(g.z),b.push('" '),0!=g.charge&&(b.push('formalCharge="'),b.push(g.charge),b.push('" ')),b.push("/>");for(b.push("</atomArray>"),b.push("<bondArray>"),e=0,f=a[c].bonds.length;f>e;e++){switch(g=a[c].bonds[e],b.push('<bond atomRefs2="a'),b.push(a[c].atoms.indexOf(g.a1)),b.push(" a"),b.push(a[c].atoms.indexOf(g.a2)),b.push('" order="'),g.bondOrder){case 1.5:b.push("A");break;case 1:case 2:case 3:b.push(g.bondOrder);break;default:b.push("S")}b.push('"/>')}b.push("</bondArray>"),b.push("</molecule>")}return b.push("</cml>"),b.join("")},f=new b.CMLInterpreter,a.readCML=function(a){return f.read(a)},a.writeCML=function(a){return f.write(a)}}(ChemDoodle,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.lib.jQuery),function(a,b,c,d){var e,f;c.MOLInterpreter=function(){},e=c.MOLInterpreter.prototype=new c._Interpreter,e.read=function(c,e){var f,g,h,i,j,k,l,m;if(e||(e=a.default_bondLength_2D),f=new d.Molecule,!c)return f;for(g=c.split("\n"),h=g[3],i=parseInt(h.substring(0,3)),h=parseInt(h.substring(3,6)),j=0;i>j;j++)switch(k=g[4+j],f.atoms[j]=new d.Atom(k.substring(31,34),parseFloat(k.substring(0,10))*e,(1===e?1:-1)*parseFloat(k.substring(10,20))*e,parseFloat(k.substring(20,30))*e),l=parseInt(k.substring(34,36)),0!==l&&b[f.atoms[j].label]&&(f.atoms[j].mass=b[f.atoms[j].label].mass+l),parseInt(k.substring(36,39))){case 1:f.atoms[j].charge=3;break;case 2:f.atoms[j].charge=2;break;case 3:f.atoms[j].charge=1;break;case 5:f.atoms[j].charge=-1;break;case 6:f.atoms[j].charge=-2;break;case 7:f.atoms[j].charge=-3}for(j=0;h>j;j++){if(k=g[4+i+j],m=parseInt(k.substring(6,9)),l=parseInt(k.substring(9,12)),m>3)switch(m){case 4:m=1.5;break;default:m=1}switch(k=new d.Bond(f.atoms[parseInt(k.substring(0,3))-1],f.atoms[parseInt(k.substring(3,6))-1],m),l){case 3:k.stereo=d.Bond.STEREO_AMBIGUOUS;break;case 1:k.stereo=d.Bond.STEREO_PROTRUDING;break;case 6:k.stereo=d.Bond.STEREO_RECESSED}f.bonds[j]=k}return f},e.write=function(c){var f,g,h,i,j,k,e=[];for(e.push("Molecule from ChemDoodle Web Components\n\nhttp://www.ichemlabs.com\n"),e.push(this.fit(c.atoms.length.toString(),3)),e.push(this.fit(c.bonds.length.toString(),3)),e.push("  0  0  0  0            999 V2000\n"),f=c.getCenter(),g=0,h=c.atoms.length;h>g;g++){if(i=c.atoms[g],j=" 0",-1!==i.mass&&b[i.label]&&(k=i.mass-b[i.label].mass,5>k&&k>-4&&(j=(k>-1?" ":"")+k)),k="  0",0!==i.charge)switch(i.charge){case 3:k="  1";break;case 2:k="  2";break;case 1:k="  3";break;case-1:k="  5";break;case-2:k="  6";break;case-3:k="  7"}e.push(this.fit(((i.x-f.x)/a.default_bondLength_2D).toFixed(4),10)),e.push(this.fit((-(i.y-f.y)/a.default_bondLength_2D).toFixed(4),10)),e.push(this.fit((i.z/a.default_bondLength_2D).toFixed(4),10)),e.push(" "),e.push(this.fit(i.label,3,!0)),e.push(j),e.push(k),e.push("  0  0  0  0\n")}for(g=0,h=c.bonds.length;h>g;g++)i=c.bonds[g],f=0,i.stereo===d.Bond.STEREO_AMBIGUOUS?f=3:i.stereo===d.Bond.STEREO_PROTRUDING?f=1:i.stereo===d.Bond.STEREO_RECESSED&&(f=6),e.push(this.fit((c.atoms.indexOf(i.a1)+1).toString(),3)),e.push(this.fit((c.atoms.indexOf(i.a2)+1).toString(),3)),i=i.bondOrder,1.5==i?i=4:(i>3||0!=i%1)&&(i=1),e.push(this.fit(i,3)),e.push("  "),e.push(f),e.push("     0  0\n");return e.push("M  END"),e.join("")},f=new c.MOLInterpreter,a.readMOL=function(a,b){return f.read(a,b)},a.writeMOL=function(a){return f.write(a)}}(ChemDoodle,ChemDoodle.ELEMENT,ChemDoodle.io,ChemDoodle.structures),function(a,b,c,d,e,f,g){function h(a,b,c,d,e){var f,g,h;for(f=0,g=b.length;g>f;f++)if(h=b[f],h.id===c&&d>=h.start&&d<=h.end){e?a.helix=!0:a.sheet=!0,d+1===h.end&&(a.arrow=!0);break}}var i,j;c.PDBInterpreter=function(){},i=c.PDBInterpreter.prototype=new c._Interpreter,i.calculateRibbonDistances=!1,i.deduceResidueBonds=!1,i.read=function(c,i){var k,n,l,m,o,p,q,r,s,t,u,v,w,x,y,z,A,j=new d.Molecule;if(j.chains=[],!c)return j;for(k=c.split("\n"),i||(i=1),l=[],m=[],o=[],p=[],q=[],r=0,s=k.length;s>r;r++)if(t=k[r],b.stringStartsWith(t,"HELIX"))l.push({id:t.substring(19,20),start:parseInt(t.substring(21,25)),end:parseInt(t.substring(33,37))});else if(b.stringStartsWith(t,"SHEET"))m.push({id:t.substring(21,22),start:parseInt(t.substring(22,26)),end:parseInt(t.substring(33,37))});else if(b.stringStartsWith(t,"ATOM")){if(u=t.substring(16,17)," "===u||"A"===u){if(u=f(t.substring(76,78)),0===u.length&&(v=f(t.substring(12,14)),"HD"===v?u="H":0<v.length&&(u=1<v.length?v.charAt(0)+v.substring(1).toLowerCase():v)),v=new d.Atom(u,parseFloat(t.substring(30,38))*i,parseFloat(t.substring(38,46))*i,parseFloat(t.substring(46,54))*i),v.hetatm=!1,p.push(v),w=parseInt(t.substring(22,26)),0===o.length)for(u=0;2>u;u++)x=new d.Residue(-1),x.cp1=v,x.cp2=v,o.push(x);w!==Number.NaN&&o[o.length-1].resSeq!==w&&(u=new d.Residue(w),u.name=f(t.substring(17,20)),3===u.name.length?u.name=u.name.substring(0,1)+u.name.substring(1).toLowerCase():2===u.name.length&&"D"===u.name.charAt(0)&&(u.name=u.name.substring(1)),o.push(u),x=t.substring(21,22),h(u,l,x,w,!0),h(u,m,x,w,!1)),t=f(t.substring(12,16)),u=o[o.length-1],"CA"===t||"P"===t||"O5'"===t?u.cp1||(u.cp1=v):"N3"===t&&("C"===u.name||"U"===u.name||"T"===u.name)||"N1"===t&&("A"===u.name||"G"===u.name)?u.cp3=v:"C2"===t?u.cp4=v:"C4"===t&&("C"===u.name||"U"===u.name||"T"===u.name)||"C6"===t&&("A"===u.name||"G"===u.name)?u.cp5=v:"O"===t||"C6"===t&&("C"===u.name||"U"===u.name||"T"===u.name)||"N9"===t?o[o.length-1].cp2||(("C6"===t||"N9"===t)&&(n=v),u.cp2=v):"C"===t&&(n=v)}}else if(b.stringStartsWith(t,"HETATM"))u=f(t.substring(76,78)),0===u.length&&(u=f(t.substring(12,16))),1<u.length&&(u=u.substring(0,1)+u.substring(1).toLowerCase()),u=new d.Atom(u,parseFloat(t.substring(30,38))*i,parseFloat(t.substring(38,46))*i,parseFloat(t.substring(46,54))*i),u.hetatm=!0,"HOH"===f(t.substring(17,20))&&(u.isWater=!0),j.atoms.push(u),q[parseInt(f(t.substring(6,11)))]=u;else if(b.stringStartsWith(t,"CONECT")){if(u=parseInt(f(t.substring(6,11))),q[u])for(v=q[u],w=0;4>w;w++)if(u=f(t.substring(11+5*w,16+5*w)),0!==u.length&&(u=parseInt(u),q[u])){for(x=q[u],y=!1,u=0,z=j.bonds.length;z>u;u++)if(A=j.bonds[u],A.a1===v&&A.a2===x||A.a1===x&&A.a2===v){y=!0;break}y||j.bonds.push(new d.Bond(v,x))}}else if(b.stringStartsWith(t,"TER"))this.endChain(j,o,n,p),o=[];else if(b.stringStartsWith(t,"ENDMDL"))break;if(this.endChain(j,o,n,p),0===j.bonds.size&&(new a.informatics.BondDeducer).deduceCovalentBonds(j,i),this.deduceResidueBonds)for(r=0,s=p.length;s>r;r++)for(k=g.min(s,r+20),u=r+1;k>u;u++)l=p[r],m=p[u],l.distance3D(m)<1.1*(e[l.label].covalentRadius+e[m.label].covalentRadius)&&j.bonds.push(new d.Bond(l,m,1));return j.atoms=j.atoms.concat(p),this.calculateRibbonDistances&&this.calculateDistances(j,p),j},i.endChain=function(a,b,c,e){if(0<b.length){var f=b[b.length-1];for(f.cp1||(f.cp1=e[e.length-2]),f.cp2||(f.cp2=e[e.length-1]),e=0;4>e;e++)f=new d.Residue(-1),f.cp1=c,f.cp2=b[b.length-1].cp2,b.push(f);a.chains.push(b)}},i.calculateDistances=function(a,b){var c,d,e,f,g,h;for(c=[],d=0,e=a.atoms.length;e>d;d++)f=a.atoms[d],f.hetatm&&(f.isWater||c.push(f));for(d=0,e=b.length;e>d;d++)if(f=b[d],f.closestDistance=Number.POSITIVE_INFINITY,0===c.length)f.closestDistance=0;else for(g=0,h=c.length;h>g;g++)f.closestDistance=Math.min(f.closestDistance,f.distance3D(c[g]))},j=new c.PDBInterpreter,a.readPDB=function(a,b){return j.read(a,b)}}(ChemDoodle,ChemDoodle.extensions,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.ELEMENT,ChemDoodle.lib.jQuery.trim,Math),function(a,b,c,d,e,f){var j,g={"@":0,A:1,B:2,C:3,D:4,E:5,F:6,G:7,H:8,I:9,a:-1,b:-2,c:-3,d:-4,e:-5,f:-6,g:-7,h:-8,i:-9},h={"%":0,J:1,K:2,L:3,M:4,N:5,O:6,P:7,Q:8,R:9,j:-1,k:-2,l:-3,m:-4,n:-5,o:-6,p:-7,q:-8,r:-9},i={S:1,T:2,U:3,V:4,W:5,X:6,Y:7,Z:8,s:9};c.JCAMPInterpreter=function(){},e=c.JCAMPInterpreter.prototype=new c._Interpreter,e.convertHZ2PPM=!1,e.read=function(a){var c,j,k,l,m,e,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,F,C,D,E,G,H,I,J,K,L,M;if(this.isBreak=function(a){return void 0!==g[a]||void 0!==h[a]||void 0!==i[a]||" "===a||"-"===a||"+"===a},this.getValue=function(a,b){var c=a.charAt(0),d=a.substring(1);return void 0!==g[c]?parseFloat(g[c]+d):void 0!==h[c]?parseFloat(h[c]+d)+b:parseFloat(d)},c=new d.Spectrum,void 0===a||0===a.length)return c;for(a=a.split("\n"),e=[],n=1,o=1,p=1,q=-1,r=-1,s=-1,t=!0,u=!1,v=0,w=a.length;w>v;v++)if(x=f(a[v]),y=x.indexOf("$$"),-1!==y&&(x=x.substring(0,y)),0!==e.length&&b.stringStartsWith(a[v],"##")){if(y=e.join(""),t&&100>y.length&&c.metadata.push(y),e=[x],b.stringStartsWith(y,"##TITLE="))c.title=f(y.substring(8));else if(b.stringStartsWith(y,"##XUNITS="))c.xUnit=f(y.substring(9)),this.convertHZ2PPM&&"HZ"===c.xUnit.toUpperCase()&&(c.xUnit="PPM",u=!0);else if(b.stringStartsWith(y,"##YUNITS="))c.yUnit=f(y.substring(9));else if(!b.stringStartsWith(y,"##XYPAIRS="))if(b.stringStartsWith(y,"##FIRSTX="))k=parseFloat(f(y.substring(9)));else if(b.stringStartsWith(y,"##LASTX="))j=parseFloat(f(y.substring(8)));else if(b.stringStartsWith(y,"##FIRSTY="))l=parseFloat(f(y.substring(9)));else if(b.stringStartsWith(y,"##NPOINTS="))m=parseFloat(f(y.substring(10)));else if(b.stringStartsWith(y,"##XFACTOR="))n=parseFloat(f(y.substring(10)));else if(b.stringStartsWith(y,"##YFACTOR="))o=parseFloat(f(y.substring(10)));else if(b.stringStartsWith(y,"##DELTAX="))q=parseFloat(f(y.substring(9)));else if(b.stringStartsWith(y,"##.OBSERVE FREQUENCY="))this.convertHZ2PPM&&(p=parseFloat(f(y.substring(21))));else if(b.stringStartsWith(y,"##.SHIFT REFERENCE="))this.convertHZ2PPM&&(s=y.substring(19).split(","),r=parseInt(f(s[2])),s=parseFloat(f(s[3])));else if(b.stringStartsWith(y,"##XYDATA=")){if(u||(p=1),x=t=!1,y=y.split("\n"),z=(j-k)/(m-1),-1!==q)for(A=1,B=y.length;B>A;A++)if("|"===y[A].charAt(0)){z=q;break}for(C=k-z,D=l,E=0,A=1,B=y.length;B>A;A++){for(G=[],C=f(y[A]),e=[],H=!1,I=0,J=C.length;J>I;I++)this.isBreak(C.charAt(I))?(0<e.length&&!(1===e.length&&" "===e[0])&&G.push(e.join("")),e=[C.charAt(I)]):"|"===C.charAt(I)?H=!0:e.push(C.charAt(I));for(G.push(e.join("")),C=parseFloat(G[0])*n-z,I=1,J=G.length;J>I;I++)if(D=G[I],void 0!==i[D.charAt(0)])for(K=parseInt(i[D.charAt(0)]+D.substring(1))-1,L=0;K>L;L++)C+=z,E=this.getValue(F,E),D=E*o,M++,c.data[c.data.length-1]=new d.Point(C/p,D);else void 0!==g[D.charAt(0)]&&x?(D=this.getValue(D,E)*o,H&&(C+=z,c.data.push(new d.Point(C/p,D)))):(x=void 0!==h[D.charAt(0)],F=D,C+=z,E=this.getValue(D,E),D=E*o,M++,c.data.push(new d.Point(C/p,D)))}if(-1!==r)for(x=s-c.data[r-1].x,v=0,w=c.data.length;w>v;v++)c.data[v].x+=x}else if(b.stringStartsWith(y,"##PEAK TABLE="))for(t=!1,c.continuous=!1,y=y.split("\n"),M=0,A=1,B=y.length;B>A;A++)for(x=y[A].split(/[\s,]+/),M+=x.length/2,I=0,J=x.length;J>I+1;I+=2)c.data.push(new d.Point(parseFloat(f(x[I])),parseFloat(f(x[I+1]))))}else 0!==e.length&&e.push("\n"),e.push(f(x));return c.setup(),c},j=new c.JCAMPInterpreter,j.convertHZ2PPM=!0,a.readJCAMP=function(a){return j.read(a)}}(ChemDoodle,ChemDoodle.extensions,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.lib.jQuery,ChemDoodle.lib.jQuery.trim),function(a,b,c,d,e,f){var g,h;b.JSONInterpreter=function(){},g=b.JSONInterpreter.prototype,g.contentTo=function(a,b){var c,d,e,f,g,h,i;for(c=0,d=0,e=0,f=a.length;f>e;e++){for(g=a[e],h=0,i=g.atoms.length;i>h;h++)g.atoms[h].tmpid="a"+c++;for(h=0,i=g.bonds.length;i>h;h++)g.bonds[h].tmpid="b"+d++}for(e=c=0,f=b.length;f>e;e++)b[e].tmpid="s"+c++;if(c={},a&&0<a.length)for(c.m=[],e=0,f=a.length;f>e;e++)c.m.push(this.molTo(a[e]));if(b&&0<b.length)for(c.s=[],e=0,f=b.length;f>e;e++)c.s.push(this.shapeTo(b[e]));for(e=0,f=a.length;f>e;e++){for(g=a[e],h=0,i=g.atoms.length;i>h;h++)g.atoms[h].tmpid=void 0;for(h=0,i=g.bonds.length;i>h;h++)g.bonds[h].tmpid=void 0}for(e=0,f=b.length;f>e;e++)b[e].tmpid=void 0;return c},g.contentFrom=function(a){var c,d,e,f,b={molecules:[],shapes:[]};if(a.m)for(c=0,d=a.m.length;d>c;c++)b.molecules.push(this.molFrom(a.m[c]));if(a.s)for(c=0,d=a.s.length;d>c;c++)b.shapes.push(this.shapeFrom(a.s[c],b.molecules));for(c=0,d=b.molecules.length;d>c;c++){for(a=b.molecules[c],e=0,f=a.atoms.length;f>e;e++)a.atoms[e].tmpid=void 0;for(e=0,f=a.bonds.length;f>e;e++)a.bonds[e].tmpid=void 0}for(c=0,d=b.shapes.length;d>c;c++)b.shapes[c].tmpid=void 0;return b},g.molTo=function(a){var b,d,e,f,g;for(b={a:[]},d=0,e=a.atoms.length;e>d;d++)f=a.atoms[d],g={x:f.x,y:f.y},f.tmpid&&(g.i=f.tmpid),"C"!==f.label&&(g.l=f.label),0!==f.z&&(g.z=f.z),0!==f.charge&&(g.c=f.charge),-1!==f.mass&&(g.m=f.mass),0!==f.numRadical&&(g.r=f.numRadical),0!==f.numLonePair&&(g.p=f.numLonePair),f.any&&(g.q=!0),-1!==f.rgroup&&(g.rg=f.rgroup),b.a.push(g);if(0<a.bonds.length)for(b.b=[],d=0,e=a.bonds.length;e>d;d++)f=a.bonds[d],g={b:a.atoms.indexOf(f.a1),e:a.atoms.indexOf(f.a2)},f.tmpid&&(g.i=f.tmpid),1!==f.bondOrder&&(g.o=f.bondOrder),f.stereo!==c.Bond.STEREO_NONE&&(g.s=f.stereo),b.b.push(g);return b},g.molFrom=function(a){var b,d,e,f,g;for(b=new c.Molecule,d=0,e=a.a.length;e>d;d++)f=a.a[d],g=new c.Atom(f.l?f.l:"C",f.x,f.y),f.i&&(g.tmpid=f.i),f.z&&(g.z=f.z),f.c&&(g.charge=f.c),f.m&&(g.mass=f.m),f.r&&(g.numRadical=f.r),f.p&&(g.numLonePair=f.p),f.q&&(g.any=!0),f.rg&&(g.rgroup=f.rg),void 0!==f.p_h&&(g.hetatm=f.p_h),void 0!==f.p_w&&(g.isWater=f.p_w),void 0!==f.p_d&&(g.closestDistance=f.p_d),b.atoms.push(g);if(a.b)for(d=0,e=a.b.length;e>d;d++)f=a.b[d],g=new c.Bond(b.atoms[f.b],b.atoms[f.e],void 0===f.o?1:f.o),f.i&&(g.tmpid=f.i),f.s&&(g.stereo=f.s),b.bonds.push(g);return b},g.shapeTo=function(a){var b={};return a.tmpid&&(b.i=a.tmpid),a instanceof d.Line?(b.t="Line",b.x1=a.p1.x,b.y1=a.p1.y,b.x2=a.p2.x,b.y2=a.p2.y,b.a=a.arrowType):a instanceof d.Pusher?(b.t="Pusher",b.o1=a.o1.tmpid,b.o2=a.o2.tmpid,1!==a.numElectron&&(b.e=a.numElectron)):a instanceof d.Bracket?(b.t="Bracket",b.x1=a.p1.x,b.y1=a.p1.y,b.x2=a.p2.x,b.y2=a.p2.y,0!==a.charge&&(b.c=a.charge),0!==a.mult&&(b.m=a.mult),0!==a.repeat&&(b.r=a.repeat)):a instanceof e.Distance?(b.t="Distance",b.a1=a.a1.tmpid,b.a2=a.a2.tmpid,a.node&&(b.n=a.node,b.o=a.offset)):a instanceof e.Angle?(b.t="Angle",b.a1=a.a1.tmpid,b.a2=a.a2.tmpid,b.a3=a.a3.tmpid):a instanceof e.Torsion&&(b.t="Torsion",b.a1=a.a1.tmpid,b.a2=a.a2.tmpid,b.a3=a.a3.tmpid,b.a4=a.a4.tmpid),b},g.shapeFrom=function(a,b){var f,g,h,i,j,k,l,m,n,o,p,q;if("Line"===a.t)f=new d.Line(new c.Point(a.x1,a.y1),new c.Point(a.x2,a.y2)),f.arrowType=a.a;else if("Pusher"===a.t){for(f=0,i=b.length;i>f;f++){for(j=b[f],k=0,l=j.atoms.length;l>k;k++)m=j.atoms[k],m.tmpid===a.o1?g=m:m.tmpid===a.o2&&(h=m);for(k=0,l=j.bonds.length;l>k;k++)n=j.bonds[k],n.tmpid===a.o1?g=n:n.tmpid===a.o2&&(h=n)}f=new d.Pusher(g,h),a.e&&(f.numElectron=a.e)}else if("Bracket"===a.t)f=new d.Bracket(new c.Point(a.x1,a.y1),new c.Point(a.x2,a.y2)),void 0!==a.c&&(f.charge=a.c),void 0!==a.m&&(f.mult=a.m),void 0!==a.r&&(f.repeat=a.r);else if("Distance"===a.t){for(f=0,i=b.length;i>f;f++)for(j=b[f],k=0,l=j.atoms.length;l>k;k++)m=j.atoms[k],m.tmpid===a.a1?n=m:m.tmpid===a.a2&&(o=m);f=new e.Distance(n,o,a.n,a.o)}else if("Angle"===a.t){for(f=0,i=b.length;i>f;f++)for(j=b[f],k=0,l=j.atoms.length;l>k;k++)m=j.atoms[k],m.tmpid===a.a1?n=m:m.tmpid===a.a2?o=m:m.tmpid===a.a3&&(p=m);f=new e.Angle(n,o,p)}else if("Torsion"===a.t){for(f=0,i=b.length;i>f;f++)for(j=b[f],k=0,l=j.atoms.length;l>k;k++)m=j.atoms[k],m.tmpid===a.a1?n=m:m.tmpid===a.a2?o=m:m.tmpid===a.a3?p=m:m.tmpid===a.a4&&(q=m);f=new e.Torsion(n,o,p,q)}return f},g.pdbFrom=function(a){var b=this.molFrom(a.mol);return b.findRings=!1,b.fromJSON=!0,b.chains=this.chainsFrom(a.ribbons),b},g.chainsFrom=function(a){var b,d,e,f,g,h,i,j,k;for(b=[],d=0,e=a.cs.length;e>d;d++){for(f=a.cs[d],g=[],h=0,i=f.length;i>h;h++)j=f[h],k=new c.Residue,k.name=j.n,k.cp1=new c.Atom("",j.x1,j.y1,j.z1),k.cp2=new c.Atom("",j.x2,j.y2,j.z2),j.x3&&(k.cp3=new c.Atom("",j.x3,j.y3,j.z3),k.cp4=new c.Atom("",j.x4,j.y4,j.z4),k.cp5=new c.Atom("",j.x5,j.y5,j.z5)),k.helix=j.h,k.sheet=j.s,k.arrow=j.a,g.push(k);b.push(g)}return b},h=new b.JSONInterpreter,a.readJSON=function(a){var b;try{b=f.parse(a)}catch(c){return}return b?b.m||b.s?h.contentFrom(b):b.a?{molecules:[h.molFrom(b)],shapes:[]}:{molecules:[],shapes:[]}:void 0},a.writeJSON=function(a,b){return f.stringify(h.contentTo(a,b))}}(ChemDoodle,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.structures.d2,ChemDoodle.structures.d3,JSON),function(a,b,c){var d,e;b.RXNInterpreter=function(){},d=b.RXNInterpreter.prototype=new b._Interpreter,d.read=function(b,d){var f,e,g,h,i,j,k,l,m,n,o;if(d||(d=a.default_bondLength_2D),e=[],b){for(f=b.split("$MOL\n"),g=f[0].split("\n")[4],h=parseInt(g.substring(0,3)),g=parseInt(g.substring(3,6)),i=1,j=0,k=0,l=h+g;l>k;k++)e[k]=a.readMOL(f[i],d),m=e[k].getBounds(),m=m.maxX-m.minX,j-=m+40,i++;for(k=0,l=h;l>k;k++){for(m=e[k].getBounds(),m=m.maxX-m.minX,i=e[k].getCenter(),n=0,f=e[k].atoms.length;f>n;n++)o=e[k].atoms[n],o.x+=j+m/2-i.x,o.y-=i.y;j+=m+40}for(f=new c.d2.Line(new c.Point(j,0),new c.Point(j+40,0)),j+=80,k=h,l=h+g;l>k;k++){for(m=e[k].getBounds(),m=m.maxX-m.minX,i=e[k].getCenter(),n=0;n<e[k].atoms.length;n++)o=e[k].atoms[n],o.x+=j+m/2-i.x,o.y-=i.y;j+=m+40}}else e.push(new c.Molecule),f=new c.d2.Line(new c.Point(-20,0),new c.Point(20,0));return f.arrowType=c.d2.Line.ARROW_SYNTHETIC,{molecules:e,shapes:[f]}},d.write=function(b,d){var g,h,i,e=[[],[]],f=void 0;if(b&&d){for(g=0,h=d.length;h>g;g++)if(d[g]instanceof c.d2.Line){f=d[g].getPoints();break}if(!f)return"";for(g=0,h=b.length;h>g;g++)b[g].getCenter().x<f[1].x?e[0].push(b[g]):e[1].push(b[g]);for(f=[],f.push("$RXN\nReaction from ChemDoodle Web Components\n\nhttp://www.ichemlabs.com\n"),f.push(this.fit(e[0].length.toString(),3)),f.push(this.fit(e[1].length.toString(),3)),f.push("\n"),g=0;2>g;g++)for(h=0,i=e[g].length;i>h;h++)f.push("$MOL\n"),f.push(a.writeMOL(e[g][h])),f.push("\n");return f.join("")}},e=new b.RXNInterpreter,a.readRXN=function(a,b){return e.read(a,b)},a.writeRXN=function(a,b){return e.write(a,b)}}(ChemDoodle,ChemDoodle.io,ChemDoodle.structures),function(a,b,c,d,e,f){d.XYZInterpreter=function(){},b=d.XYZInterpreter.prototype=new d._Interpreter,b.deduceCovalentBonds=!0,b.read=function(b){var g,h,i,d=new e.Molecule;if(!b)return d;for(b=b.split("\n"),g=parseInt(f(b[0])),h=0;g>h;h++)i=b[h+2].split(/\s+/g),d.atoms[h]=new e.Atom(isNaN(i[0])?i[0]:c[parseInt(i[0])-1],parseFloat(i[1]),parseFloat(i[2]),parseFloat(i[3]));return this.deduceCovalentBonds&&(new a.informatics.BondDeducer).deduceCovalentBonds(d,1),d};var g=new d.XYZInterpreter;a.readXYZ=function(a){return g.read(a)}}(ChemDoodle,ChemDoodle.ELEMENT,ChemDoodle.SYMBOLS,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.lib.jQuery.trim),ChemDoodle.monitor=function(a,b,c){var d={CANVAS_DRAGGING:void 0,CANVAS_OVER:void 0,ALT:!1,SHIFT:!1,META:!1};return a.supports_touch()||b(c).ready(function(){b(c).mousemove(function(a){d.CANVAS_DRAGGING&&d.CANVAS_DRAGGING.drag&&(d.CANVAS_DRAGGING.prehandleEvent(a),d.CANVAS_DRAGGING.drag(a))}),b(c).mouseup(function(a){d.CANVAS_DRAGGING&&d.CANVAS_DRAGGING!==d.CANVAS_OVER&&d.CANVAS_DRAGGING.mouseup&&(d.CANVAS_DRAGGING.prehandleEvent(a),d.CANVAS_DRAGGING.mouseup(a)),d.CANVAS_DRAGGING=void 0}),b(c).keydown(function(a){d.SHIFT=a.shiftKey,d.ALT=a.altKey,d.META=a.metaKey||a.ctrlKey;var b=d.CANVAS_OVER;d.CANVAS_DRAGGING&&(b=d.CANVAS_DRAGGING),b&&b.keydown&&(b.prehandleEvent(a),b.keydown(a))}),b(c).keypress(function(a){var b=d.CANVAS_OVER;d.CANVAS_DRAGGING&&(b=d.CANVAS_DRAGGING),b&&b.keypress&&(b.prehandleEvent(a),b.keypress(a))}),b(c).keyup(function(a){d.SHIFT=a.shiftKey,d.ALT=a.altKey,d.META=a.metaKey||a.ctrlKey;var b=d.CANVAS_OVER;d.CANVAS_DRAGGING&&(b=d.CANVAS_DRAGGING),b&&b.keyup&&(b.prehandleEvent(a),b.keyup(a))})}),d}(ChemDoodle.featureDetection,ChemDoodle.lib.jQuery,document),function(a,b,c,d,e,f,g,h,i,j){a._Canvas=function(){};var k=a._Canvas.prototype;k.molecules=void 0,k.shapes=void 0,k.emptyMessage=void 0,k.image=void 0,k.repaint=function(){var a,b,c;if(!this.test&&(a=h.getElementById(this.id),a.getContext)){if(b=a.getContext("2d"),1!==this.pixelRatio&&a.width===this.width&&(a.width=this.width*this.pixelRatio,a.height=this.height*this.pixelRatio,b.scale(this.pixelRatio,this.pixelRatio)),this.image?b.drawImage(this.image,0,0):(this.specs.backgroundColor&&this.bgCache!==a.style.backgroundColor&&(a.style.backgroundColor=this.specs.backgroundColor,this.bgCache=a.style.backgroundColor),b.fillStyle=this.specs.backgroundColor,b.fillRect(0,0,this.width,this.height)),this.innerRepaint)this.innerRepaint(b);
else if(0!==this.molecules.length||0!==this.shapes.length){for(b.save(),b.translate(this.width/2,this.height/2),b.rotate(this.specs.rotateAngle),b.scale(this.specs.scale,this.specs.scale),b.translate(-this.width/2,-this.height/2),a=0,c=this.molecules.length;c>a;a++)this.molecules[a].check(!0),this.molecules[a].draw(b,this.specs);for(a=0,c=this.shapes.length;c>a;a++)this.shapes[a].draw(b,this.specs);b.restore()}else this.emptyMessage&&(b.fillStyle="#737683",b.textAlign="center",b.textBaseline="middle",b.font="18px Helvetica, Verdana, Arial, Sans-serif",b.fillText(this.emptyMessage,this.width/2,this.height/2));this.drawChildExtras&&this.drawChildExtras(b)}},k.resize=function(b,c){var e,d=f("#"+this.id);if(d.attr({width:b,height:c}),d.css("width",b),d.css("height",c),this.width=b,this.height=c,a._Canvas3D&&this instanceof a._Canvas3D)this.gl.viewport(0,0,b,c),this.setupScene();else if(0<this.molecules.length)for(this.center(),d=0,e=this.molecules.length;e>d;d++)this.molecules[d].check();this.repaint()},k.setBackgroundImage=function(a){this.image=new Image;var b=this;this.image.onload=function(){b.repaint()},this.image.src=a},k.loadMolecule=function(b){this.clear(),this.molecules.push(b),this.center(),a._Canvas3D&&this instanceof a._Canvas3D||b.check(),this.afterLoadContent&&this.afterLoadContent(),this.repaint()},k.loadContent=function(b,c){if(this.molecules=b?b:[],this.shapes=c?c:[],this.center(),!(a._Canvas3D&&this instanceof a._Canvas3D))for(var d=0,e=this.molecules.length;e>d;d++)this.molecules[d].check();this.afterLoadContent&&this.afterLoadContent(),this.repaint()},k.addMolecule=function(b){this.molecules.push(b),a._Canvas3D&&this instanceof a._Canvas3D||b.check(),this.repaint()},k.removeMolecule=function(a){this.molecules=f.grep(this.molecules,function(b){return b!==a}),this.repaint()},k.getMolecule=function(){return 0<this.molecules.length?this.molecules[0]:void 0},k.getMolecules=function(){return this.molecules},k.addShape=function(a){this.shapes.push(a),this.repaint()},k.removeShape=function(a){this.shapes=f.grep(this.shapes,function(b){return b!==a}),this.repaint()},k.getShapes=function(){return this.shapes},k.clear=function(){this.molecules=[],this.shapes=[],this.specs.scale=1,this.repaint()},k.center=function(){var a,b,c,d,f,h,i;for(a=this.getContentBounds(),b=new e.Point((this.width-a.minX-a.maxX)/2,(this.height-a.minY-a.maxY)/2),c=0,d=this.molecules.length;d>c;c++)for(f=this.molecules[c],h=0,i=f.atoms.length;i>h;h++)f.atoms[h].add(b);for(c=0,d=this.shapes.length;d>c;c++)for(f=this.shapes[c].getPoints(),h=0,i=f.length;i>h;h++)f[h].add(b);this.specs.scale=1,b=a.maxX-a.minX,a=a.maxY-a.minY,(b>this.width||a>this.height)&&(this.specs.scale=.85*g.min(this.width/b,this.height/a))},k.bondExists=function(a,b){var c,d,e,f,g,h;for(c=0,d=this.molecules.length;d>c;c++)for(e=this.molecules[c],f=0,g=e.bonds.length;g>f;f++)if(h=e.bonds[f],h.contains(a)&&h.contains(b))return!0;return!1},k.getBond=function(a,b){var c,d,e,f,g,h;for(c=0,d=this.molecules.length;d>c;c++)for(e=this.molecules[c],f=0,g=e.bonds.length;g>f;f++)if(h=e.bonds[f],h.contains(a)&&h.contains(b))return h},k.getMoleculeByAtom=function(a){var b,c,d;for(b=0,c=this.molecules.length;c>b;b++)if(d=this.molecules[b],-1!==d.atoms.indexOf(a))return d},k.getAllAtoms=function(){for(var a=[],b=0,c=this.molecules.length;c>b;b++)a=a.concat(this.molecules[b].atoms);return a},k.getAllPoints=function(){for(var a=[],b=0,c=this.molecules.length;c>b;b++)a=a.concat(this.molecules[b].atoms);for(b=0,c=this.shapes.length;c>b;b++)a=a.concat(this.shapes[b].getPoints());return a},k.getContentBounds=function(){for(var a=new c.Bounds,b=0,d=this.molecules.length;d>b;b++)a.expand(this.molecules[b].getBounds());for(b=0,d=this.shapes.length;d>b;b++)a.expand(this.shapes[b].getBounds());return a},k.create=function(c,k,l){var m,n;if(this.id=c,this.width=k,this.height=l,this.molecules=[],this.shapes=[],h.getElementById(c))m=f("#"+c),k?m.attr("width",k):this.width=m.attr("width"),l?m.attr("height",l):this.height=m.attr("height"),m.attr("class","ChemDoodleWebComponent");else{if(!a.featureDetection.supports_canvas_text()&&-1!=j.indexOf("MSIE"))return h.writeln('<div style="border: 1px solid black;" width="'+k+'" height="'+l+'">Please install <a href="http://code.google.com/chrome/chromeframe/">Google Chrome Frame</a>, then restart Internet Explorer.</div>'),void 0;h.writeln('<canvas class="ChemDoodleWebComponent" id="'+c+'" width="'+k+'" height="'+l+'" alt="ChemDoodle Web Component">This browser does not support HTML5/Canvas.</canvas>')}c=f("#"+c),c.css("width",this.width),c.css("height",this.height),this.pixelRatio=i.devicePixelRatio?i.devicePixelRatio:1,this.specs=new e.VisualSpecifications,n=this,b.supports_touch()?(c.bind("touchstart",function(a){var d,f,c=(new Date).getTime();b.supports_gesture()||2!==a.originalEvent.touches.length||(d=a.originalEvent.touches,f=new e.Point(d[0].pageX,d[0].pageY),d=new e.Point(d[1].pageX,d[1].pageY),n.implementedGestureDist=f.distance(d),n.implementedGestureAngle=f.angle(d),n.gesturestart&&(n.prehandleEvent(a),n.gesturestart(a))),n.lastTouch&&1===a.originalEvent.touches.length&&500>c-n.lastTouch?n.dbltap?(n.prehandleEvent(a),n.dbltap(a)):n.dblclick?(n.prehandleEvent(a),n.dblclick(a)):n.touchstart?(n.prehandleEvent(a),n.touchstart(a)):n.mousedown&&(n.prehandleEvent(a),n.mousedown(a)):n.touchstart?(n.prehandleEvent(a),n.touchstart(a),this.hold&&clearTimeout(this.hold),this.touchhold&&(this.hold=setTimeout(function(){n.touchhold(a)},1e3))):n.mousedown&&(n.prehandleEvent(a),n.mousedown(a)),n.lastTouch=c}),c.bind("touchmove",function(a){if(this.hold&&(clearTimeout(this.hold),this.hold=void 0),!b.supports_gesture()&&2===a.originalEvent.touches.length&&n.gesturechange){var c=a.originalEvent.touches,d=new e.Point(c[0].pageX,c[0].pageY),f=new e.Point(c[1].pageX,c[1].pageY),c=d.distance(f),d=d.angle(f);a.originalEvent.scale=c/n.implementedGestureDist,a.originalEvent.rotation=180*(n.implementedGestureAngle-d)/g.PI,n.prehandleEvent(a),n.gesturechange(a)}if(1<a.originalEvent.touches.length&&n.multitouchmove){for(d=a.originalEvent.touches.length,n.prehandleEvent(a),c=new e.Point(-a.offset.left*d,-a.offset.top*d),f=0;d>f;f++)c.x+=a.originalEvent.changedTouches[f].pageX,c.y+=a.originalEvent.changedTouches[f].pageY;c.x/=d,c.y/=d,a.p=c,n.multitouchmove(a,d)}else n.touchmove?(n.prehandleEvent(a),n.touchmove(a)):n.drag&&(n.prehandleEvent(a),n.drag(a))}),c.bind("touchend",function(a){this.hold&&(clearTimeout(this.hold),this.hold=void 0),!b.supports_gesture()&&n.implementedGestureDist&&(n.implementedGestureDist=void 0,n.implementedGestureAngle=void 0,n.gestureend&&(n.prehandleEvent(a),n.gestureend(a))),n.touchend?(n.prehandleEvent(a),n.touchend(a)):n.mouseup&&(n.prehandleEvent(a),n.mouseup(a)),250>(new Date).getTime()-n.lastTouch&&(n.tap?(n.prehandleEvent(a),n.tap(a)):n.click&&(n.prehandleEvent(a),n.click(a)))}),c.bind("gesturestart",function(a){n.gesturestart&&(n.prehandleEvent(a),n.gesturestart(a))}),c.bind("gesturechange",function(a){n.gesturechange&&(n.prehandleEvent(a),n.gesturechange(a))}),c.bind("gestureend",function(a){n.gestureend&&(n.prehandleEvent(a),n.gestureend(a))})):(c.click(function(a){switch(a.which){case 1:n.click&&(n.prehandleEvent(a),n.click(a));break;case 2:n.middleclick&&(n.prehandleEvent(a),n.middleclick(a));break;case 3:n.rightclick&&(n.prehandleEvent(a),n.rightclick(a))}}),c.dblclick(function(a){n.dblclick&&(n.prehandleEvent(a),n.dblclick(a))}),c.mousedown(function(a){switch(a.which){case 1:d.CANVAS_DRAGGING=n,n.mousedown&&(n.prehandleEvent(a),n.mousedown(a));break;case 2:n.middlemousedown&&(n.prehandleEvent(a),n.middlemousedown(a));break;case 3:n.rightmousedown&&(n.prehandleEvent(a),n.rightmousedown(a))}}),c.mousemove(function(a){!d.CANVAS_DRAGGING&&n.mousemove&&(n.prehandleEvent(a),n.mousemove(a))}),c.mouseout(function(a){d.CANVAS_OVER=void 0,n.mouseout&&(n.prehandleEvent(a),n.mouseout(a))}),c.mouseover(function(a){d.CANVAS_OVER=n,n.mouseover&&(n.prehandleEvent(a),n.mouseover(a))}),c.mouseup(function(a){switch(a.which){case 1:n.mouseup&&(n.prehandleEvent(a),n.mouseup(a));break;case 2:n.middlemouseup&&(n.prehandleEvent(a),n.middlemouseup(a));break;case 3:n.rightmouseup&&(n.prehandleEvent(a),n.rightmouseup(a))}}),c.mousewheel(function(a,b){n.mousewheel&&(n.prehandleEvent(a),n.mousewheel(a,b))})),this.subCreate&&this.subCreate()},k.prehandleEvent=function(a){a.originalEvent.changedTouches&&(a.pageX=a.originalEvent.changedTouches[0].pageX,a.pageY=a.originalEvent.changedTouches[0].pageY),a.preventDefault(),a.offset=f("#"+this.id).offset(),a.p=new e.Point(a.pageX-a.offset.left,a.pageY-a.offset.top)}}(ChemDoodle,ChemDoodle.featureDetection,ChemDoodle.math,ChemDoodle.monitor,ChemDoodle.structures,ChemDoodle.lib.jQuery,Math,document,window,navigator.userAgent),function(a,b){a._AnimatorCanvas=function(a,b,c){a&&this.create(a,b,c)};var c=a._AnimatorCanvas.prototype=new a._Canvas;c.timeout=33,c.startAnimation=function(){this.stopAnimation(),this.lastTime=(new Date).getTime();var a=this;this.nextFrame&&(this.handle=b.requestInterval(function(){var b=(new Date).getTime();a.nextFrame(b-a.lastTime),a.repaint(),a.lastTime=b},this.timeout))},c.stopAnimation=function(){this.handle&&(b.clearRequestInterval(this.handle),this.handle=void 0)},c.isRunning=function(){return void 0!==this.handle}}(ChemDoodle,ChemDoodle.animations),function(a,b){a.FileCanvas=function(a,c,d,e){a&&this.create(a,c,d),b.writeln('<br><form name="FileForm" enctype="multipart/form-data" method="POST" action="'+e+'" target="HiddenFileFrame"><input type="file" name="f" /><input type="submit" name="submitbutton" value="Show File" /></form><iframe id="HFF-'+a+'" name="HiddenFileFrame" height="0" width="0" style="display:none;" onLoad="GetMolFromFrame(\'HFF-'+a+"', "+a+')"></iframe>'),this.emptyMessage="Click below to load file",this.repaint()},a.FileCanvas.prototype=new a._Canvas}(ChemDoodle,document),function(a){a.HyperlinkCanvas=function(a,b,c,d,e,f){a&&this.create(a,b,c),this.urlOrFunction=d,this.color=e?e:"blue",this.size=f?f:2},a=a.HyperlinkCanvas.prototype=new a._Canvas,a.openInNewWindow=!0,a.hoverImage=void 0,a.drawChildExtras=function(a){this.e&&(this.hoverImage?a.drawImage(this.hoverImage,0,0):(a.strokeStyle=this.color,a.lineWidth=2*this.size,a.strokeRect(0,0,this.width,this.height)))},a.setHoverImage=function(a){this.hoverImage=new Image,this.hoverImage.src=a},a.click=function(){this.e=void 0,this.repaint(),this.urlOrFunction instanceof Function?this.urlOrFunction():this.openInNewWindow?window.open(this.urlOrFunction):location.href=this.urlOrFunction},a.mouseout=function(){this.e=void 0,this.repaint()},a.mouseover=function(a){this.e=a,this.repaint()}}(ChemDoodle),function(a,b,c,d){a.MolGrabberCanvas=function(a,b,e){a&&this.create(a,b,e),b=[],b.push('<br><input type="text" id="'),b.push(a),b.push('_query" size="32" value="" />'),b.push("<br><nobr>"),b.push('<select id="'),b.push(a),b.push('_select">'),b.push('<option value="chemexper">ChemExper'),b.push('<option value="chemspider">ChemSpider'),b.push('<option value="pubchem" selected>PubChem'),b.push("</select>"),b.push('<button id="'),b.push(a),b.push('_submit">Show Molecule</button>'),b.push("</nobr>"),d.getElementById(a),c("#"+a).after(b.join(""));var f=this;c("#"+a+"_submit").click(function(){f.search()}),c("#"+a+"_query").keypress(function(a){13===a.which&&f.search()}),this.emptyMessage="Enter search term below",this.repaint()},a=a.MolGrabberCanvas.prototype=new a._Canvas,a.setSearchTerm=function(a){c("#"+this.id+"_query").val(a),this.search()},a.search=function(){this.emptyMessage="Searching...",this.clear();var a=this;b.getMoleculeFromDatabase(c("#"+this.id+"_query").val(),{database:c("#"+this.id+"_select").val()},function(b){a.loadMolecule(b)})}}(ChemDoodle,ChemDoodle.iChemLabs,ChemDoodle.lib.jQuery,document),function(a,b,c){var d=[],e=[1,0,0],f=[0,1,0],g=[0,0,1];a.RotatorCanvas=function(a,b,c,d){a&&this.create(a,b,c),this.rotate3D=d},a=a.RotatorCanvas.prototype=new a._AnimatorCanvas,b=b.PI/15,a.xIncrement=b,a.yIncrement=b,a.zIncrement=b,a.nextFrame=function(a){var b,h,i,j,k,l;if(0===this.molecules.length&&0===this.shapes.length)this.stopAnimation();else if(a/=1e3,this.rotate3D){for(c.identity(d),c.rotate(d,this.xIncrement*a,e),c.rotate(d,this.yIncrement*a,f),c.rotate(d,this.zIncrement*a,g),a=0,b=this.molecules.length;b>a;a++){for(h=this.molecules[a],i=0,j=h.atoms.length;j>i;i++)k=h.atoms[i],l=[k.x-this.width/2,k.y-this.height/2,k.z],c.multiplyVec3(d,l),k.x=l[0]+this.width/2,k.y=l[1]+this.height/2,k.z=l[2];for(i=0,j=h.rings.length;j>i;i++)h.rings[i].center=h.rings[i].getCenter();this.specs.atoms_display&&this.specs.atoms_circles_2D&&h.sortAtomsByZ(),this.specs.bonds_display&&this.specs.bonds_clearOverlaps_2D&&h.sortBondsByZ()}for(a=0,b=this.shapes.length;b>a;a++)for(h=this.shapes[a].getPoints(),i=0,j=h.length;j>i;i++)k=h[i],l=[k.x-this.width/2,k.y-this.height/2,0],c.multiplyVec3(d,l),k.x=l[0]+this.width/2,k.y=l[1]+this.height/2}else this.specs.rotateAngle+=this.zIncrement*a},a.dblclick=function(){this.isRunning()?this.stopAnimation():this.startAnimation()}}(ChemDoodle,Math,ChemDoodle.lib.mat4),function(a,b,c){a.SlideshowCanvas=function(a,b,c){a&&this.create(a,b,c)},a=a.SlideshowCanvas.prototype=new a._AnimatorCanvas,a.frames=[],a.curIndex=0,a.timeout=5e3,a.alpha=0,a.innerHandle=void 0,a.phase=0,a.drawChildExtras=function(a){var b=c.getRGB(this.specs.backgroundColor,255);a.fillStyle="rgba("+b[0]+", "+b[1]+", "+b[2]+", "+this.alpha+")",a.fillRect(0,0,this.width,this.height)},a.nextFrame=function(){if(0===this.frames.length)this.stopAnimation();else{this.phase=0;var a=this,b=1;this.innerHandle=setInterval(function(){a.alpha=b/15,a.repaint(),15===b&&a.breakInnerHandle(),b++},33)}},a.breakInnerHandle=function(){var a,b,c;this.innerHandle&&(clearInterval(this.innerHandle),this.innerHandle=void 0),0===this.phase?(this.curIndex++,this.curIndex>this.frames.length-1&&(this.curIndex=0),this.alpha=1,a=this.frames[this.curIndex],this.loadContent(a.mols,a.shapes),this.phase=1,b=this,c=1,this.innerHandle=setInterval(function(){b.alpha=(15-c)/15,b.repaint(),15===c&&b.breakInnerHandle(),c++},33)):1===this.phase&&(this.alpha=0,this.repaint())},a.addFrame=function(a,b){0===this.frames.length&&this.loadContent(a,b),this.frames.push({mols:a,shapes:b})}}(ChemDoodle,ChemDoodle.animations,ChemDoodle.math),function(a,b,c,d,e){a.TransformCanvas=function(a,b,c,d){a&&this.create(a,b,c),this.rotate3D=d},a=a.TransformCanvas.prototype=new a._Canvas,a.lastPoint=void 0,a.rotationMultMod=1.3,a.lastPinchScale=1,a.lastGestureRotate=0,a.mousedown=function(a){this.lastPoint=a.p},a.dblclick=function(){this.center(),this.repaint()},a.drag=function(a){var f,g,h,i,j,k;if(!this.lastPoint.multi){if(b.ALT){for(f=new c.Point(a.p.x,a.p.y),f.sub(this.lastPoint),g=0,h=this.molecules.length;h>g;g++){for(i=this.molecules[g],j=0,k=i.atoms.length;k>j;j++)i.atoms[j].add(f);i.check()}for(g=0,h=this.shapes.length;h>g;g++)for(i=this.shapes[g].getPoints(),j=0,k=i.length;k>j;j++)i[j].add(f);this.lastPoint=a.p}else if(!0===this.rotate3D)for(k=d.max(this.width/4,this.height/4),j=(a.p.x-this.lastPoint.x)/k*this.rotationMultMod,k=-(a.p.y-this.lastPoint.y)/k*this.rotationMultMod,f=[],e.identity(f),e.rotate(f,k,[1,0,0]),e.rotate(f,j,[0,1,0]),g=0,h=this.molecules.length;h>g;g++){for(i=this.molecules[g],j=0,k=i.atoms.length;k>j;j++)g=i.atoms[j],h=[g.x-this.width/2,g.y-this.height/2,g.z],e.multiplyVec3(f,h),g.x=h[0]+this.width/2,g.y=h[1]+this.height/2,g.z=h[2];for(g=0,h=i.rings.length;h>g;g++)i.rings[g].center=i.rings[g].getCenter();this.lastPoint=a.p,this.specs.atoms_display&&this.specs.atoms_circles_2D&&i.sortAtomsByZ(),this.specs.bonds_display&&this.specs.bonds_clearOverlaps_2D&&i.sortBondsByZ()}else k=new c.Point(this.width/2,this.height/2),j=k.angle(this.lastPoint),k=k.angle(a.p),this.specs.rotateAngle-=k-j,this.lastPoint=a.p;this.repaint()}},a.mousewheel=function(a,b){this.specs.scale+=b/50,.01>this.specs.scale&&(this.specs.scale=.01),this.repaint()},a.multitouchmove=function(a,b){var d,e,f,g,h,i;if(2===b)if(this.lastPoint.multi){for(d=new c.Point(a.p.x,a.p.y),d.sub(this.lastPoint),e=0,f=this.molecules.length;f>e;e++){for(g=this.molecules[e],h=0,i=g.atoms.length;i>h;h++)g.atoms[h].add(d);g.check()}for(e=0,f=this.shapes.length;f>e;e++)for(g=this.shapes[e].getPoints(),h=0,i=g.length;i>h;h++)g[h].add(d);this.lastPoint=a.p,this.lastPoint.multi=!0,this.repaint()}else this.lastPoint=a.p,this.lastPoint.multi=!0},a.gesturechange=function(a){var b,d,e,f,g,h,i,j,k,l;if(0!==a.originalEvent.scale-this.lastPinchScale&&(this.specs.scale*=a.originalEvent.scale/this.lastPinchScale,.01>this.specs.scale&&(this.specs.scale=.01),this.lastPinchScale=a.originalEvent.scale),0!==this.lastGestureRotate-a.originalEvent.rotation){for(b=(this.lastGestureRotate-a.originalEvent.rotation)/180*g.PI,d=new c.Point(this.width/2,this.height/2),e=0,f=this.molecules.length;f>e;e++){for(g=this.molecules[e],h=0,i=g.atoms.length;i>h;h++)j=g.atoms[h],k=d.distance(j),l=d.angle(j)+b,j.x=d.x+k*g.cos(l),j.y=d.y-k*g.sin(l);g.check()}this.lastGestureRotate=a.originalEvent.rotation}this.repaint()},a.gestureend=function(){this.lastPinchScale=1,this.lastGestureRotate=0}}(ChemDoodle,ChemDoodle.monitor,ChemDoodle.structures,Math,ChemDoodle.lib.mat4),function(a){a.ViewerCanvas=function(a,b,c){a&&this.create(a,b,c)},a.ViewerCanvas.prototype=new a._Canvas}(ChemDoodle),function(a){a._SpectrumCanvas=function(a,b,c){a&&this.create(a,b,c)},a=a._SpectrumCanvas.prototype=new a._Canvas,a.spectrum=void 0,a.emptyMessage="No Spectrum Loaded or Recognized",a.loadMolecule=void 0,a.getMolecule=void 0,a.innerRepaint=function(a){this.spectrum&&0<this.spectrum.data.length?this.spectrum.draw(a,this.specs,this.width,this.height):this.emptyMessage&&(a.fillStyle="#737683",a.textAlign="center",a.textBaseline="middle",a.font="18px Helvetica, Verdana, Arial, Sans-serif",a.fillText(this.emptyMessage,this.width/2,this.height/2))},a.loadSpectrum=function(a){this.spectrum=a,this.repaint()},a.getSpectrum=function(){return this.spectrum},a.getSpectrumCoordinates=function(a,b){return spectrum.getInternalCoordinates(a,b,this.width,this.height)}}(ChemDoodle,document),function(a){a.ObserverCanvas=function(a,b,c){a&&this.create(a,b,c)},a.ObserverCanvas.prototype=new a._SpectrumCanvas}(ChemDoodle),function(a){a.OverlayCanvas=function(a,b,c){a&&this.create(a,b,c)},a=a.OverlayCanvas.prototype=new a._SpectrumCanvas,a.overlaySpectra=[],a.superRepaint=a.innerRepaint,a.innerRepaint=function(a){var b,c,d;if(this.superRepaint(a),this.spectrum&&0<this.spectrum.data.length)for(b=0,c=this.overlaySpectra.length;c>b;b++)d=this.overlaySpectra[b],d&&0<d.data.length&&(d.minX=this.spectrum.minX,d.maxX=this.spectrum.maxX,d.drawPlot(a,this.specs,this.width,this.height,this.spectrum.memory.offsetTop,this.spectrum.memory.offsetLeft,this.spectrum.memory.offsetBottom))},a.addSpectrum=function(a){this.spectrum?this.overlaySpectra.push(a):this.spectrum=a}}(ChemDoodle),function(a,b,c){a.PerspectiveCanvas=function(a,b,c){a&&this.create(a,b,c)};var d=a.PerspectiveCanvas.prototype=new a._SpectrumCanvas;d.dragRange=void 0,d.rescaleYAxisOnZoom=!0,d.lastPinchScale=1,d.mousedown=function(b){this.dragRange=new a.structures.Point(b.p.x,b.p.x)},d.mouseup=function(a){this.dragRange&&this.dragRange.x!==this.dragRange.y&&(this.dragRange.multi||(a=this.spectrum.zoom(this.dragRange.x,a.p.x,this.width,this.rescaleYAxisOnZoom),this.rescaleYAxisOnZoom&&(this.specs.scale=a)),this.dragRange=void 0,this.repaint())},d.drag=function(a){this.dragRange&&(this.dragRange.multi?this.dragRange=void 0:(b.SHIFT&&(this.spectrum.translate(a.p.x-this.dragRange.x,this.width),this.dragRange.x=a.p.x),this.dragRange.y=a.p.x),this.repaint())},d.drawChildExtras=function(a){if(this.dragRange){var b=c.min(this.dragRange.x,this.dragRange.y),d=c.max(this.dragRange.x,this.dragRange.y);for(a.strokeStyle="gray",a.lineStyle=1,a.beginPath(),a.moveTo(b,this.height/2);d>=b;b++)5>b%10?a.lineTo(b,c.round(this.height/2)):a.moveTo(b,c.round(this.height/2));a.stroke()}},d.mousewheel=function(a,b){this.specs.scale+=b/10,.01>this.specs.scale&&(this.specs.scale=.01),this.repaint()},d.dblclick=function(){this.spectrum.setup(),this.specs.scale=1,this.repaint()},d.multitouchmove=function(b,c){2===c&&(this.dragRange&&this.dragRange.multi?(this.spectrum.translate(b.p.x-this.dragRange.x,this.width),this.dragRange.x=b.p.x,this.dragRange.y=b.p.x,this.repaint()):(this.dragRange=new a.structures.Point(b.p.x,b.p.x),this.dragRange.multi=!0))},d.gesturechange=function(a){this.specs.scale*=a.originalEvent.scale/this.lastPinchScale,.01>this.specs.scale&&(this.specs.scale=.01),this.lastPinchScale=a.originalEvent.scale,this.repaint()},d.gestureend=function(){this.lastPinchScale=1}}(ChemDoodle,ChemDoodle.monitor,Math),function(a,b,c){a.SeekerCanvas=function(a,b,c,d){a&&this.create(a,b,c),this.seekType=d};var d=a.SeekerCanvas.prototype=new a._SpectrumCanvas;d.superRepaint=d.innerRepaint,d.innerRepaint=function(d){var e,f,g,h;if(this.superRepaint(d),this.spectrum&&0<this.spectrum.data.length&&this.p){if(this.seekType===a.SeekerCanvas.SEEK_POINTER)e=this.p,f=this.spectrum.getInternalCoordinates(e.x,e.y);else if(this.seekType===a.SeekerCanvas.SEEK_PLOT||this.seekType===a.SeekerCanvas.SEEK_PEAK){if(f=this.seekType===a.SeekerCanvas.SEEK_PLOT?this.spectrum.getClosestPlotInternalCoordinates(this.p.x):this.spectrum.getClosestPeakInternalCoordinates(this.p.x),!f)return;e={x:this.spectrum.getTransformedX(f.x,this.specs,this.width,this.spectrum.memory.offsetLeft),y:this.spectrum.getTransformedY(f.y/100,this.specs,this.height,this.spectrum.memory.offsetBottom,this.spectrum.memory.offsetTop)}}d.fillStyle="white",d.strokeStyle=this.specs.plots_color,d.lineWidth=this.specs.plots_width,d.beginPath(),d.arc(e.x,e.y,3,0,2*c.PI,!1),d.fill(),d.stroke(),d.font=b.getFontString(this.specs.text_font_size,this.specs.text_font_families),d.textAlign="left",d.textBaseline="bottom",f="x:"+f.x.toFixed(3)+", y:"+f.y.toFixed(3),g=e.x+3,h=d.measureText(f).width,g+h>this.width-2&&(g-=6+h),e=e.y,0>e-this.specs.text_font_size-2&&(e+=this.specs.text_font_size),d.fillRect(g,e-this.specs.text_font_size,h,this.specs.text_font_size),d.fillStyle="black",d.fillText(f,g,e)}},d.mouseout=function(){this.p=void 0,this.repaint()},d.mousemove=function(a){this.p={x:a.p.x-2,y:a.p.y-3},this.repaint()},d.touchstart=function(a){this.mousemove(a)},d.touchmove=function(a){this.mousemove(a)},d.touchend=function(a){this.mouseout(a)},a.SeekerCanvas.SEEK_POINTER="pointer",a.SeekerCanvas.SEEK_PLOT="plot",a.SeekerCanvas.SEEK_PEAK="peak"}(ChemDoodle,ChemDoodle.extensions,Math),function(a,b,c,d,e,f,g,h,i,j,k,l){a._Canvas3D=function(a,b,c){a&&this.create(a,b,c)};var m=a._Canvas3D.prototype=new a._Canvas;m.rotationMatrix=void 0,m.translationMatrix=void 0,m.lastPoint=void 0,m.emptyMessage="WebGL is Unavailable!",m.lastPinchScale=1,m.lastGestureRotate=0,m.afterLoadContent=function(){var a,b,d,e,f;for(a=new c.Bounds,b=0,d=this.molecules.length;d>b;b++)a.expand(this.molecules[b].getBounds3D());e=k.dist([a.maxX,a.maxY,a.maxZ],[a.minX,a.minY,a.minZ])/2+1.5,b=45,d=Math.tan(b/360*Math.PI)/.8,this.depth=e/d,d=g.max(this.depth-e,.1),e=this.depth+e,f=this.gl.canvas.clientWidth/this.gl.canvas.clientHeight,1>f&&(b/=f),this.specs.projectionOrthoWidth_3D=2*Math.tan(b/360*Math.PI)*this.depth*f,this.specs.projectionPerspectiveVerticalFieldOfView_3D=b,this.specs.projectionFrontCulling_3D=d,this.specs.projectionBackCulling_3D=e,this.specs.projectionWidthHeightRatio_3D=f,this.translationMatrix=i.translate(i.identity([]),[0,0,-this.depth]),this.maxDimension=g.max(a.maxX-a.minX,a.maxY-a.minY),this.setupScene()},m.setViewDistance=function(a){this.specs.projectionPerspectiveVerticalFieldOfView_3D=c.clamp(this.specs.projectionPerspectiveVerticalFieldOfView_3D/a,.1,179.9),this.specs.projectionOrthoWidth_3D=2*g.tan(this.specs.projectionPerspectiveVerticalFieldOfView_3D/360*Math.PI)*this.depth*this.specs.projectionWidthHeightRatio_3D,this.updateScene()},m.repaint=function(){var a,b,c;if(this.gl){for(this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.gl.modelViewMatrix=i.multiply(this.translationMatrix,this.rotationMatrix,[]),this.gl.rotationMatrix=this.rotationMatrix,a=this.gl.getUniformLocation(this.gl.program,"u_projection_matrix"),this.gl.uniformMatrix4fv(a,!1,this.gl.projectionMatrix),this.gl.fogging.setMode(this.specs.fog_mode_3D),b=0,c=this.molecules.length;c>b;b++)this.molecules[b].render(this.gl,this.specs);for(b=0,c=this.shapes.length;c>b;b++)this.shapes[b].render(this.gl,this.specs);this.specs.compass_display&&(this.gl.uniformMatrix4fv(a,!1,this.compass.projectionMatrix),this.compass.render(this.gl,this.specs),this.gl.setMatrixUniforms(this.gl.modelViewMatrix),this.gl.uniformMatrix4fv(a,!1,this.gl.projectionMatrix)),this.gl.enable(this.gl.BLEND),this.gl.depthMask(!1),this.gl.enableVertexAttribArray(this.gl.shader.vertexTexCoordAttribute),this.specs.atoms_displayLabels_3D&&this.label3D.render(this.gl,this.specs,this.getMolecules()),this.specs.compass_display&&this.specs.compass_displayText_3D&&(this.gl.uniformMatrix4fv(a,!1,this.compass.projectionMatrix),this.compass.renderAxis(this.gl),this.gl.setMatrixUniforms(this.gl.modelViewMatrix),this.gl.uniformMatrix4fv(a,!1,this.gl.projectionMatrix)),this.gl.disableVertexAttribArray(this.gl.shader.vertexTexCoordAttribute),this.gl.disable(this.gl.BLEND),this.gl.depthMask(!0),this.gl.disable(this.gl.DEPTH_TEST),this.drawChildExtras&&this.drawChildExtras(this.gl),this.gl.enable(this.gl.DEPTH_TEST),this.gl.flush()}},m.pick=function(a,b,c,d){if(this.gl){i.multiply(this.translationMatrix,this.rotationMatrix,this.gl.modelViewMatrix),this.gl.rotationMatrix=this.rotationMatrix;var e=this.gl.getUniformLocation(this.gl.program,"u_projection_matrix");return this.gl.uniformMatrix4fv(e,!1,this.gl.projectionMatrix),this.picker.pick(this.gl,this.molecules,this.specs,a,this.height-b,c,d)}},m.center=function(){var a,b,c,e,f,g,h,i,j,k;for(a=new d.Atom,b=0,c=this.molecules.length;c>b;b++)e=this.molecules[b],a.add3D(e.getCenter3D());for(a.x/=this.molecules.length,a.y/=this.molecules.length,b=0,c=this.molecules.length;c>b;b++){for(e=this.molecules[b],f=0,g=e.atoms.length;g>f;f++)e.atoms[f].sub3D(a);if(e.chains&&e.fromJSON)for(f=0,g=e.chains.length;g>f;f++)for(h=e.chains[f],i=0,j=h.length;j>i;i++)k=h[i],k.cp1.sub3D(a),k.cp2.sub3D(a),k.cp3&&(k.cp3.sub3D(a),k.cp4.sub3D(a),k.cp5.sub3D(a))}},m.subCreate=function(){try{var a=h.getElementById(this.id);this.gl=a.getContext("webgl"),this.gl||(this.gl=a.getContext("experimental-webgl"))}catch(b){}this.gl?(this.rotationMatrix=i.identity([]),this.translationMatrix=i.identity([]),this.gl.viewport(0,0,this.width,this.height),this.gl.program=this.gl.createProgram(),this.gl.shader=new e.Shader,this.gl.shader.init(this.gl),this.gl.programLabel=this.gl.createProgram(),this.setupScene()):this.displayMessage()},a._Canvas.prototype.displayMessage=function(){var a=h.getElementById(this.id);a.getContext&&(a=a.getContext("2d"),this.specs.backgroundColor&&(a.fillStyle=this.specs.backgroundColor,a.fillRect(0,0,this.width,this.height)),this.emptyMessage&&(a.fillStyle="#737683",a.textAlign="center",a.textBaseline="middle",a.font="18px Helvetica, Verdana, Arial, Sans-serif",a.fillText(this.emptyMessage,this.width/2,this.height/2)))},m.renderText=function(a,b){if(this.gl){var c={position:[],texCoord:[],translation:[]};this.gl.textImage.pushVertexData(a,b,0,c),this.gl.textMesh.storeData(this.gl,c.position,c.texCoord,c.translation),this.gl.enable(this.gl.BLEND),this.gl.depthMask(!1),this.gl.enableVertexAttribArray(this.gl.shader.vertexTexCoordAttribute),this.gl.textImage.useTexture(this.gl),this.gl.textMesh.render(this.gl),this.gl.disableVertexAttribArray(this.gl.shader.vertexTexCoordAttribute),this.gl.disable(this.gl.BLEND),this.gl.depthMask(!0)}},m.setupScene=function(){var h,m,n,o,p,q,r,s,t,u,v,w;if(this.gl){for(l("#"+this.id).css("background-color",this.specs.backgroundColor),h=c.getRGB(this.specs.backgroundColor,1),this.gl.clearColor(h[0],h[1],h[2],1),this.gl.clearDepth(1),this.gl.enable(this.gl.DEPTH_TEST),this.gl.depthFunc(this.gl.LEQUAL),this.gl.blendFuncSeparate(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA),this.specs.cullBackFace_3D&&this.gl.enable(this.gl.CULL_FACE),this.gl.sphereBuffer=new e.Sphere(1,this.specs.atoms_resolution_3D,this.specs.atoms_resolution_3D),this.gl.starBuffer=new e.Star,this.gl.cylinderBuffer=new e.Cylinder(1,1,this.specs.bonds_resolution_3D),this.gl.pillBuffer=new e.Pill(this.specs.bonds_pillDiameter_3D/2,this.specs.bonds_pillHeight_3D,this.specs.bonds_pillLatitudeResolution_3D,this.specs.bonds_pillLongitudeResolution_3D),this.gl.lineBuffer=new e.Line,this.gl.lineArrowBuffer=new e.LineArrow,this.gl.arrowBuffer=new e.Arrow(.3,this.specs.compass_resolution_3D),this.gl.textMesh=new e.TextMesh,this.gl.textMesh.init(this.gl),this.gl.textImage=new e.TextImage,this.gl.textImage.init(this.gl),this.gl.textImage.updateFont(this.gl,this.specs.text_font_size,this.specs.text_font_families,this.specs.text_font_bold,this.specs.text_font_italic,this.specs.text_font_stroke_3D),this.label3D=new e.Label,this.label3D.init(this.gl,this.specs),m=0,n=this.molecules.length;n>m;m++)if(h=this.molecules[m],h.labelMesh instanceof e.TextMesh||(h.labelMesh=new e.TextMesh,h.labelMesh.init(this.gl)),h.unitCellVectors&&(h.unitCell=new e.UnitCell(h.unitCellVectors)),h.chains)for(h.ribbons=[],h.cartoons=[],h.tubes=[],o=0,p=h.chains.length;p>o;o++){if(q=h.chains[o],r=2<q.length&&f[q[2].name]&&"#BEA06E"===f[q[2].name].aminoColor,0<q.length&&!q[0].lineSegments){for(s=0,t=q.length-1;t>s;s++)q[s].setup(q[s+1].cp1,r?1:this.specs.proteins_horizontalResolution);if(!r)for(s=1,t=q.length-1;t>s;s++)b.vec3AngleFrom(q[s-1].D,q[s].D)>g.PI/2&&(q[s].guidePointsSmall.reverse(),q[s].guidePointsLarge.reverse(),k.scale(q[s].D,-1));for(s=1,t=q.length-3;t>s;s++)q[s].computeLineSegments(q[s-1],q[s+1],q[s+2],!r,r?this.specs.nucleics_verticalResolution:this.specs.proteins_verticalResolution);q.pop(),q.pop(),q.pop(),q.shift()}if(s=c.hsl2rgb(1===p?.5:o/p,1,.5),u="rgb("+s[0]+","+s[1]+","+s[2]+")",q.chainColor=u,r)s=new e.Tube(q,this.specs.nucleics_tubeThickness,this.specs.nucleics_tubeResolution_3D),s.chainColor=u,h.tubes.push(s);else{for(r={front:new e.Ribbon(q,this.specs.proteins_ribbonThickness,!1),back:new e.Ribbon(q,-this.specs.proteins_ribbonThickness,!1)},r.front.chainColor=u,r.back.chainColor=u,s=0,t=r.front.segments.length;t>s;s++)r.front.segments[s].chainColor=u;for(s=0,t=r.back.segments.length;t>s;s++)r.back.segments[s].chainColor=u;for(h.ribbons.push(r),q={front:new e.Ribbon(q,this.specs.proteins_ribbonThickness,!0),back:new e.Ribbon(q,-this.specs.proteins_ribbonThickness,!0)},q.front.chainColor=u,q.back.chainColor=u,s=0,t=q.front.segments.length;t>s;s++)q.front.segments[s].chainColor=u;for(s=0,t=q.back.segments.length;t>s;s++)q.back.segments[s].chainColor=u;for(s=0,t=q.front.cartoonSegments.length;t>s;s++)q.front.cartoonSegments[s].chainColor=u;for(s=0,t=q.back.cartoonSegments.length;t>s;s++)q.back.cartoonSegments[s].chainColor=u;h.cartoons.push(q)}}if(this.label3D.updateVerticesBuffer(this.gl,this.getMolecules(),this.specs),this instanceof a.MovieCanvas3D&&this.frames)for(s=0,t=this.frames.length;t>s;s++){for(m=this.frames[s],o=0,p=m.mols.length;p>o;o++)h=m.mols[o],h.labelMesh instanceof d.d3.TextMesh||(h.labelMesh=new d.d3.TextMesh,h.labelMesh.init(this.gl));this.label3D.updateVerticesBuffer(this.gl,m.mols,this.specs)}this.gl.lighting=new e.Light(this.specs.lightDiffuseColor_3D,this.specs.lightSpecularColor_3D,this.specs.lightDirection_3D),this.gl.lighting.lightScene(this.gl),this.gl.material=new e.Material(this.gl),this.gl.fogging=new e.Fog(this.gl),this.gl.fogging.setTempParameter(this.specs.fog_color_3D||this.specs.backgroundColor,this.specs.fog_start_3D,this.specs.fog_end_3D,this.specs.fog_density_3D),this.compass=new e.Compass(this.gl,this.specs),h=this.width/this.height,this.specs.projectionWidthHeightRatio_3D&&(h=this.specs.projectionWidthHeightRatio_3D),this.gl.projectionMatrix=this.specs.projectionPerspective_3D?i.perspective(this.specs.projectionPerspectiveVerticalFieldOfView_3D,h,this.specs.projectionFrontCulling_3D,this.specs.projectionBackCulling_3D):i.ortho(-this.specs.projectionOrthoWidth_3D/2,this.specs.projectionOrthoWidth_3D/2,-this.specs.projectionOrthoWidth_3D/2/h,this.specs.projectionOrthoWidth_3D/2/h,this.specs.projectionFrontCulling_3D,this.specs.projectionBackCulling_3D),h=this.gl.getUniformLocation(this.gl.program,"u_projection_matrix"),this.gl.uniformMatrix4fv(h,!1,this.gl.projectionMatrix),v=this.gl.getUniformLocation(this.gl.program,"u_model_view_matrix"),w=this.gl.getUniformLocation(this.gl.program,"u_normal_matrix"),this.gl.setMatrixUniforms=function(a){this.uniformMatrix4fv(v,!1,a),a=j.transpose(i.toInverseMat3(a,[])),this.uniformMatrix3fv(w,!1,a)
},o=this.gl.getUniformLocation(this.gl.program,"u_dimension"),this.gl.uniformMatrix4fv(h,!1,this.gl.projectionMatrix),this.gl.uniform2f(o,this.gl.canvas.clientWidth,this.gl.canvas.clientHeight),this.picker=new e.Picker,this.picker.init(this.gl),this.picker.setDimension(this.gl,this.width,this.height)}},m.updateScene=function(){this.gl.fogging.setTempParameter(this.specs.fog_color_3D||this.specs.backgroundColor,this.specs.fog_start_3D,this.specs.fog_end_3D,this.specs.fog_density_3D);var a=this.width/this.height;this.specs.projectionWidthHeightRatio_3D&&(a=this.specs.projectionWidthHeightRatio_3D),this.gl.projectionMatrix=this.specs.projectionPerspective_3D?i.perspective(this.specs.projectionPerspectiveVerticalFieldOfView_3D,a,this.specs.projectionFrontCulling_3D,this.specs.projectionBackCulling_3D):i.ortho(-this.specs.projectionOrthoWidth_3D/2,this.specs.projectionOrthoWidth_3D/2,-this.specs.projectionOrthoWidth_3D/2/a,this.specs.projectionOrthoWidth_3D/2/a,this.specs.projectionFrontCulling_3D,this.specs.projectionBackCulling_3D),this.repaint()},m.mousedown=function(a){this.lastPoint=a.p},m.mouseup=function(){this.lastPoint=void 0},m.rightmousedown=function(a){this.lastPoint=a.p},m.drag=function(b){var c,e;this.lastPoint&&(a.monitor.ALT?(c=new d.Point(b.p.x,b.p.y),c.sub(this.lastPoint),e=g.tan(this.specs.projectionPerspectiveVerticalFieldOfView_3D/360*g.PI),e=this.depth/(this.height/2/e),i.translate(this.translationMatrix,[c.x*e,-c.y*e,0])):(e=b.p.x-this.lastPoint.x,c=b.p.y-this.lastPoint.y,e=i.rotate(i.identity([]),e*g.PI/180,[0,1,0]),i.rotate(e,c*g.PI/180,[1,0,0]),this.rotationMatrix=i.multiply(e,this.rotationMatrix)),this.lastPoint=b.p,this.repaint())},m.mousewheel=function(a,b){var c=this.specs.projectionPerspectiveVerticalFieldOfView_3D+b;this.specs.projectionPerspectiveVerticalFieldOfView_3D=.1>c?.1:c>179.9?179.9:c,this.specs.projectionOrthoWidth_3D=2*Math.tan(this.specs.projectionPerspectiveVerticalFieldOfView_3D/360*Math.PI)*this.depth*this.specs.projectionWidthHeightRatio_3D,this.updateScene()},m.multitouchmove=function(a,b){var c,e;2===b&&(this.lastPoint.multi?(c=new d.Point(a.p.x,a.p.y),c.sub(this.lastPoint),e=g.tan(this.specs.projectionPerspectiveVerticalFieldOfView_3D/360*g.PI),e=this.depth/(this.height/2/e),i.translate(this.translationMatrix,[c.x*e,-c.y*e,0]),this.lastPoint=a.p,this.repaint()):(this.lastPoint=a.p,this.lastPoint.multi=!0))},m.gesturechange=function(a){if(0!==a.originalEvent.scale-this.lastPinchScale){var b=this.specs.projectionPerspectiveVerticalFieldOfView_3D+30*-(a.originalEvent.scale/this.lastPinchScale-1);this.specs.projectionPerspectiveVerticalFieldOfView_3D=.1>b?.1:b>179.9?179.9:b,this.specs.projectionOrthoWidth_3D=2*Math.tan(this.specs.projectionPerspectiveVerticalFieldOfView_3D/360*Math.PI)*this.depth*this.specs.projectionWidthHeightRatio_3D,this.updateScene(),this.lastPinchScale=a.originalEvent.scale}this.repaint()},m.gestureend=function(){this.lastPinchScale=1,this.lastGestureRotate=0}}(ChemDoodle,ChemDoodle.extensions,ChemDoodle.math,ChemDoodle.structures,ChemDoodle.structures.d3,ChemDoodle.RESIDUE,Math,document,ChemDoodle.lib.mat4,ChemDoodle.lib.mat3,ChemDoodle.lib.vec3,ChemDoodle.lib.jQuery,window),function(a,b,c,d){a.MolGrabberCanvas3D=function(a,b,e){a&&this.create(a,b,e),b=[],b.push('<br><input type="text" id="'),b.push(a),b.push('_query" size="32" value="" />'),b.push("<br><nobr>"),b.push('<select id="'),b.push(a),b.push('_select">'),b.push('<option value="pubchem" selected>PubChem'),b.push("</select>"),b.push('<button id="'),b.push(a),b.push('_submit">Show Molecule</button>'),b.push("</nobr>"),d.writeln(b.join(""));var f=this;c("#"+a+"_submit").click(function(){f.search()}),c("#"+a+"_query").keypress(function(a){13===a.which&&f.search()})},a=a.MolGrabberCanvas3D.prototype=new a._Canvas3D,a.setSearchTerm=function(a){c("#"+this.id+"_query").val(a),this.search()},a.search=function(){var a=this;b.getMoleculeFromDatabase(c("#"+this.id+"_query").val(),{database:c("#"+this.id+"_select").val(),dimension:3},function(b){a.loadMolecule(b)})}}(ChemDoodle,ChemDoodle.iChemLabs,ChemDoodle.lib.jQuery,document),function(a,b){a.MovieCanvas3D=function(a,b,c){a&&this.create(a,b,c),this.frames=[]},a.MovieCanvas3D.PLAY_ONCE=0,a.MovieCanvas3D.PLAY_LOOP=1,a.MovieCanvas3D.PLAY_SPRING=2;var c=a.MovieCanvas3D.prototype=new a._Canvas3D;c.timeout=50,c.frameNumber=0,c.playMode=2,c.reverse=!1,c.startAnimation=a._AnimatorCanvas.prototype.startAnimation,c.stopAnimation=a._AnimatorCanvas.prototype.stopAnimation,c.isRunning=a._AnimatorCanvas.prototype.isRunning,c.dblclick=a.RotatorCanvas.prototype.dblclick,c.nextFrame=function(){var a=this.frames[this.frameNumber];this.molecules=a.mols,this.shapes=a.shapes,2===this.playMode&&this.reverse?(this.frameNumber--,0>this.frameNumber&&(this.frameNumber=1,this.reverse=!1)):(this.frameNumber++,this.frameNumber>=this.frames.length&&(2===this.playMode?(this.frameNumber-=2,this.reverse=!0):(this.frameNumber=0,0===this.playMode&&this.stopAnimation())))},c.center=function(){var a,c,d,e,f,g,h,i,j;for(a=new b.Atom,c=this.frames[0],d=0,e=c.mols.length;e>d;d++)a.add3D(c.mols[d].getCenter3D());for(a.x/=c.mols.length,a.y/=c.mols.length,c=new b.Atom,c.sub3D(a),a=0,f=this.frames.length;f>a;a++)for(g=this.frames[a],d=0,e=g.mols.length;e>d;d++)for(h=g.mols[d],i=0,j=h.atoms.length;j>i;i++)h.atoms[i].add3D(c)},c.addFrame=function(a,b){this.frames.push({mols:a,shapes:b})}}(ChemDoodle,ChemDoodle.structures),function(a,b,c){var h,d=[],e=[1,0,0],f=[0,1,0],g=[0,0,1];a.RotatorCanvas3D=function(a,b,c){a&&this.create(a,b,c)},h=a.RotatorCanvas3D.prototype=new a._Canvas3D,h.timeout=33,b=b.PI/15,h.xIncrement=b,h.yIncrement=b,h.zIncrement=b,h.startAnimation=a._AnimatorCanvas.prototype.startAnimation,h.stopAnimation=a._AnimatorCanvas.prototype.stopAnimation,h.isRunning=a._AnimatorCanvas.prototype.isRunning,h.dblclick=a.RotatorCanvas.prototype.dblclick,h.mousedown=void 0,h.rightmousedown=void 0,h.drag=void 0,h.mousewheel=void 0,h.nextFrame=function(a){0===this.molecules.length&&0===this.shapes.length?this.stopAnimation():(c.identity(d),a/=1e3,c.rotate(d,this.xIncrement*a,e),c.rotate(d,this.yIncrement*a,f),c.rotate(d,this.zIncrement*a,g),c.multiply(this.rotationMatrix,d))}}(ChemDoodle,Math,ChemDoodle.lib.mat4),function(a){a.TransformCanvas3D=function(a,b,c){a&&this.create(a,b,c)},a.TransformCanvas3D.prototype=new a._Canvas3D}(ChemDoodle),function(a){a.ViewerCanvas3D=function(a,b,c){a&&this.create(a,b,c)},a=a.ViewerCanvas3D.prototype=new a._Canvas3D,a.mousedown=void 0,a.rightmousedown=void 0,a.drag=void 0,a.mousewheel=void 0}(ChemDoodle),function(a,b,c){function d(a,b,c,d){this.element=a,this.x=b,this.y=c,this.dimension=d}a.PeriodicTableCanvas=function(a,b){this.padding=5,a&&this.create(a,18*b+2*this.padding,10*b+2*this.padding),this.cellDimension=b?b:20,this.setupTable(),this.repaint()};var e=a.PeriodicTableCanvas.prototype=new a._Canvas;e.loadMolecule=void 0,e.getMolecule=void 0,e.getHoveredElement=function(){return this.hovered?this.hovered.element:void 0},e.innerRepaint=function(a){for(var b=0,c=this.cells.length;c>b;b++)this.drawCell(a,this.specs,this.cells[b]);this.hovered&&this.drawCell(a,this.specs,this.hovered),this.selected&&this.drawCell(a,this.specs,this.selected)},e.setupTable=function(){var b,c,e,f,g,h;for(this.cells=[],b=this.padding,c=this.padding,e=0,f=0,g=a.SYMBOLS.length;g>f;f++)18===e&&(e=0,c+=this.cellDimension,b=this.padding),h=a.ELEMENT[a.SYMBOLS[f]],2===h.atomicNumber?(b+=16*this.cellDimension,e+=16):(5===h.atomicNumber||13===h.atomicNumber)&&(b+=10*this.cellDimension,e+=10),(58>h.atomicNumber||71<h.atomicNumber&&90>h.atomicNumber||103<h.atomicNumber)&&113>h.atomicNumber&&(this.cells.push(new d(h,b,c,this.cellDimension)),b+=this.cellDimension,e++);for(c+=2*this.cellDimension,b=3*this.cellDimension+this.padding,f=57;104>f;f++)h=a.ELEMENT[a.SYMBOLS[f]],90===h.atomicNumber&&(c+=this.cellDimension,b=3*this.cellDimension+this.padding),(58<=h.atomicNumber&&71>=h.atomicNumber||90<=h.atomicNumber&&103>=h.atomicNumber)&&(this.cells.push(new d(h,b,c,this.cellDimension)),b+=this.cellDimension)},e.drawCell=function(a,c,d){var e=a.createRadialGradient(d.x+d.dimension/3,d.y+d.dimension/3,1.5*d.dimension,d.x+d.dimension/3,d.y+d.dimension/3,d.dimension/10);e.addColorStop(0,"#000000"),e.addColorStop(.7,d.element.jmolColor),e.addColorStop(1,"#FFFFFF"),a.fillStyle=e,b.contextRoundRect(a,d.x,d.y,d.dimension,d.dimension,d.dimension/8),(d===this.hovered||d===this.selected)&&(a.lineWidth=2,a.strokeStyle="#c10000",a.stroke(),a.fillStyle="white"),a.fill(),a.font=b.getFontString(c.text_font_size,c.text_font_families),a.fillStyle=c.text_color,a.textAlign="center",a.textBaseline="middle",a.fillText(d.element.symbol,d.x+d.dimension/2,d.y+d.dimension/2)},e.click=function(){this.hovered&&(this.selected=this.hovered,this.repaint())},e.touchstart=function(a){this.mousemove(a)},e.mousemove=function(a){var d,e,f,b=a.p.x;for(a=a.p.y,this.hovered=void 0,d=0,e=this.cells.length;e>d;d++)if(f=this.cells[d],c.isBetween(b,f.x,f.x+f.dimension)&&c.isBetween(a,f.y,f.y+f.dimension)){this.hovered=f;break}this.repaint()},e.mouseout=function(){this.hovered=void 0,this.repaint()}}(ChemDoodle,ChemDoodle.extensions,ChemDoodle.math,document),function(a,b,c){a.png={},a.png.create=function(a){c.open(b.getElementById(a.id).toDataURL("image/png"))}}(ChemDoodle.io,document,window),function(a,b){a.file={},a.file.content=function(a,c){b.get(a,"",c)}}(ChemDoodle.io,ChemDoodle.lib.jQuery),function(a,b,c,d,e,f){b.SERVER_URL="http://ichemlabs.cloud.chemdoodle.com/icl_cdc_v060001/WebHQ",b.inRelay=!1,b.asynchronous=!0,b.INFO={userAgent:navigator.userAgent,v_cwc:a.getVersion(),v_jQuery:e.version,v_jQuery_ui:e.ui?e.ui.version:"N/A"};var g=new c.JSONInterpreter,h=new d.Queue;b.useHTTPS=function(){b.SERVER_URL="https"+b.SERVER_URL.substr(4)},b._contactServer=function(a,c,d,f,g){this.inRelay?h.enqueue({call:a,content:c,options:d,callback:f,errorback:g}):(b.inRelay=!0,e.ajax({dataType:"text",type:"POST",data:JSON.stringify({call:a,content:c,options:d,info:b.INFO}),url:this.SERVER_URL,success:function(a){a=JSON.parse(a),a.message&&alert(a.message),b.inRelay=!1,f&&a.content&&!a.stop&&f(a.content),a.stop&&g&&g(),h.isEmpty()||(a=h.dequeue(),b.contactServer(a.call,a.content,a.options,a.callback,a.errorback))},error:function(){if("checkForUpdates"!=a&&alert("Call failed. Please try again. If you continue to see this message, please contact iChemLabs customer support."),b.inRelay=!1,g&&g(),!h.isEmpty()){var c=h.dequeue();b.contactServer(c.call,c.content,c.options,c.callback,c.errorback)}},xhrFields:{withCredentials:!0},async:b.asynchronous}))},b.authenticate=function(a,b,c,d){this._contactServer("authenticate",{credential:a},b,function(a){c(a)},d)},b.calculate=function(a,b,c,d){this._contactServer("calculate",{mol:g.molTo(a)},b,function(a){c(a)},d)},b.createLewisDotStructure=function(a,b,c,d){this._contactServer("createLewisDot",{mol:g.molTo(a)},b,function(a){c(g.molFrom(a.mol))},d)},b.generateImage=function(a,b,c,d){this._contactServer("generateImage",{mol:g.molTo(a)},b,function(a){c(a.link)},d)},b.generateIUPACName=function(a,b,c,d){this._contactServer("generateIUPACName",{mol:g.molTo(a)},b,function(a){c(a.iupac)},d)},b.getAd=function(a,b){this._contactServer("getAd",{},{},function(b){a(b.image_url,b.target_url)},b)},b.getMoleculeFromContent=function(a,b,c,d){this._contactServer("getMoleculeFromContent",{content:a},b,function(a){for(var b=!1,d=0,e=a.mol.a.length;e>d;d++)if(0!==a.mol.a[d].z){b=!0;break}if(b)for(d=0,e=a.mol.a.length;e>d;d++)a.mol.a[d].x/=20,a.mol.a[d].y/=20,a.mol.a[d].z/=20;c(g.molFrom(a.mol))},d)},b.getMoleculeFromDatabase=function(a,b,c,d){this._contactServer("getMoleculeFromDatabase",{query:a},b,function(a){if(3===b.dimension)for(var d=0,e=a.mol.a.length;e>d;d++)a.mol.a[d].x/=20,a.mol.a[d].y/=-20,a.mol.a[d].z/=20;c(g.molFrom(a.mol))},d)},b.getOptimizedPDBStructure=function(a,b,c,e){this._contactServer("getOptimizedPDBStructure",{id:a},b,function(a){var b;b=a.mol?g.molFrom(a.mol):new d.Molecule,b.chains=g.chainsFrom(a.ribbons),b.fromJSON=!0,c(b)},e)},b.getZeoliteFromIZA=function(a,b,c,d){this._contactServer("getZeoliteFromIZA",{query:a},b,function(a){c(ChemDoodle.readCIF(a.cif,b.xSuper,b.ySuper,b.zSuper))},d)},b.isGraphIsomorphism=function(a,b,c,d,e){this._contactServer("isGraphIsomorphism",{arrow:g.molTo(a),target:g.molTo(b)},c,function(a){d(a.value)},e)},b.isSubgraphIsomorphism=function(a,b,c,d,e){this._contactServer("isSubgraphIsomorphism",{arrow:g.molTo(a),target:g.molTo(b)},c,function(a){d(a.value)},e)},b.kekulize=function(a,b,c,d){this._contactServer("kekulize",{mol:g.molTo(a)},b,function(a){c(g.molFrom(a.mol))},d)},b.optimize=function(a,b,c,d){this._contactServer("optimize",{mol:g.molTo(a)},b,function(d){if(d=g.molFrom(d.mol),2===b.dimension){for(var e=0,f=d.atoms.length;f>e;e++)a.atoms[e].x=d.atoms[e].x,a.atoms[e].y=d.atoms[e].y;c()}else if(3===b.dimension){for(e=0,f=d.atoms.length;f>e;e++)d.atoms[e].x/=20,d.atoms[e].y/=-20,d.atoms[e].z/=20;c(d)}},d)},b.readIUPACName=function(a,b,c,d){this._contactServer("readIUPACName",{iupac:a},b,function(a){c(g.molFrom(a.mol))},d)},b.readSMILES=function(a,b,c,d){this._contactServer("readSMILES",{smiles:a},b,function(a){c(g.molFrom(a.mol))},d)},b.saveFile=function(a,b,c,d){this._contactServer("saveFile",{mol:g.molTo(a)},b,function(a){c(a.link)},d)},b.simulate13CNMR=function(b,c,d,e){c.nucleus="C",c.isotope=13,this._contactServer("simulateNMR",{mol:g.molTo(b)},c,function(b){d(a.readJCAMP(b.jcamp))},e)},b.simulate1HNMR=function(b,c,d,e){c.nucleus="H",c.isotope=1,this._contactServer("simulateNMR",{mol:g.molTo(b)},c,function(b){d(a.readJCAMP(b.jcamp))},e)},b.simulateMassParentPeak=function(b,c,d,e){this._contactServer("simulateMassParentPeak",{mol:g.molTo(b)},c,function(b){d(a.readJCAMP(b.jcamp))},e)},b.writeSMILES=function(a,b,c,d){this._contactServer("writeSMILES",{mol:g.molTo(a)},b,function(a){c(a.smiles)},d)},b.version=function(a,b,c){this._contactServer("version",{},a,function(a){b(a.value)},c)},b.checkForUpdates=function(a){this._contactServer("checkForUpdates",{value:f.href},a,function(){},function(){})}}(ChemDoodle,ChemDoodle.iChemLabs,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.lib.jQuery,location);