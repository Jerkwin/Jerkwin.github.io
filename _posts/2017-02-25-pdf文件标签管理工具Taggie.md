---
 layout: post
 title: pdf文件标签管理工具Taggie
 categories:
 - 科
 tags:
 - 编程
 - ahk
---

- 2017年02月25日 20:02:23 整理: 文博; 补充: 李继存

以前的时候开发过一个[基于标签的桌面搜索工具 Taggie](http://jerkwin.github.io/2014/10/07/Taggie-%E5%9F%BA%E4%BA%8E%E6%A0%87%E7%AD%BE%E7%9A%84%E6%A1%8C%E9%9D%A2%E6%90%9C%E7%B4%A2%E5%B7%A5%E5%85%B7/), 虽然可用, 但性能不够好, 所以就没有发布. 现在基于Everything将这个工具重新改写了一下, 性能没问题了, 但只能用于pdf文件, 尤其适用于科学论文pdf文件的整理和搜索. 毕竟, 对做科研的人来说, 阅读这种文件最多, 有时候在成千上百的pdf中找到需要的那一篇, 还真不容易.

## 初始设置

Taggie暂时只支持pdf文件, 且需配合Everything, Chrome, PDF-XChangeViewer使用.

- 默认浏览器: 谷歌Chrome, 暂不支持其他浏览器(IE, 火狐之类). Chrome虽然有点大, 但性能好, 且自带了pdf查看功能, 方便直接查看pdf文件.

- 默认pdf查看器: PDF-XChangeViewer 2.5, 暂不支持其他pdf软件. 除编辑功能外, PDF-XChangeViewer基本能满足所有需要, 且程序小巧, 启动速度快.

点击[这里](/prog/PDF-XChangeViewer.zip)下载PDF-XChangeViewer. 解压后, 需要将其菜单项`复制完整文件名称`对应的快捷键设为`Alt+n`. 因为Taggie需要借助于此快捷键获取已打开pdf文件的完整路径, 否则无法定位打开的pdf文件. 具体方法如下:

在工具栏点击鼠标右键打开`自定义`.

__注意__ 若在工具栏右键时只出现`锁定/解锁所有命令栏`

![](https://jerkwin.github.io/pic/taggie_1.png)

请先点击`锁定/解锁所有命令栏`, 将工具栏解锁. 这样再次在工具栏右键就会出现需要的菜单项了.

![](https://jerkwin.github.io/pic/taggie_2.png)

选中`自定义`, 在其`命令`选项卡下, 依次点击`文件 | 复制完整文件名称 | 属性`, 将其`快捷键`设为`Alt+n`.

![](https://jerkwin.github.io/pic/taggie_3.png)

![](https://jerkwin.github.io/pic/taggie_4.png)

## 使用方法

下载 [Windows7 64位 Taggie](/prog/Taggie.zip) 或 [Windows7 32位 Taggie](/prog/Taggie.win32.zip). 压缩包中包含了Taggie程序及其运行所需的Everything和其他程序. 如果你还不了解Everything程序, 请先了解下[Everything: 速度最快的文件名搜索工具](http://xbeta.info/everything-search-tool.htm).

解压后,

1. 双击运行`everything.exe`, 搜索全盘文件, 并建立索引, 为后面搜索做准备
2. 双击运行`taggie.exe`. 程序会在后台运行.
3. 打开`taggie.html`(默认应使用Chrome浏览器). 初始显示内容为最后一次的搜索结果.

![](https://jerkwin.github.io/pic/taggie_5.png)

建议将Everything和Taggie设置为开机启动, 这样就不用每次手动运行它们了.

### 搜索文件

要进行新的搜索, 可在搜索框中输入关键词, 直接回车或点击右边的搜索按钮即可.

第一次启动搜索时, Chrome可能会提示`外部协议请求`,

![](https://jerkwin.github.io/pic/taggie_6.png)

请勾选`记住我对所有此类链接的选择`, 然后`启动应用`即可.

搜索完成后, 会自动打开一个新的Taggie页面, 显示所有搜索到的pdf文件.

- 点击每个文件的标题可以直接使用Chrome浏览器查看文件
- 点击`默认程序打开`则使用默认的PDF-XChangeViewer查看文件
- 点击每个文对应的`目录`可调用资源管理器打开文件所在的目录, 并选中该文件
- 如果搜索结果的`文献`项中含有论文的DOI, 点击DOI链接会打开论文的原文网址.

### 编辑标签

使用PDF-XChangeViewer打开pdf文件后, 按下快捷键`Alt+z`会弹出taggie窗口

![](https://jerkwin.github.io/pic/taggie_7.png)

在此窗口中可以设置当前pdf文件的标题, 作者, 杂志, DOI, 标签.

设置好后, 点击`根据以上设置重命名文件`, PDF-XChangeViewer会先关闭此pdf文件, 将其重命名为`【标签】;【作者】;【标题】;【杂志】;【DOI】.pdf`, 然后重新载入.

如果在`标签`文本框中输入待查询的关键词, 点击右面的`搜索已有标签`, taggie会自动搜索文件, 并使用浏览器显示结果. 效果等同于在Chrome的搜索框中输入关键词进行搜索.

如果科研论文对应的pdf文件中含有DOI号, 点击`自动获取`会自动提取文件中的DOI并联网查询标题等信息. 如果获取DOI失败, 你可以自己填写DOI并点击右面的`获取引用数据`. 此功能需要用户电脑已经连接到网络, 且通过网络查询数据需要一点时间, 所以可能不会立即显示结果.

### 设置与使用简单演示

感谢 文博 录制下图.

![](https://jerkwin.github.io/pic/taggie_8.gif)

## 其他功能

### 快捷键

为Chrome和PDF-XChangeViewer添加的快捷键

- `Esc`: 关闭当前网页或pdf文档
- `F3`: 网页后退
- `F4`: 网页前进
- `中键`: 向下翻页
- `Shift+中键`: 向上翻页
- `Shift+空格键`: 向上翻页
- `Ctrl+g`: 使用 谷歌学术 搜索选中文字
- `Ctrl+x`: 使用 词博词典 搜索选中文字

其他

- `F1`: 另存, `Ctrl+s`
- `F2`: 全选, `Ctrl+a`
- `F5`: 复制, `Ctrl+c`
- `F6`: 剪切, `Ctrl+x`
- `F9`: 粘帖, `Ctrl+v`
- `F11`: 打开`开始 | 运行`, `Win+r`
- `Ctrl+E`: 追加复制, 即将选中文字追加到剪切板

## 说明建议

- Windows 10以下版本文件名最多260字符, 所以当论文标题过长时会被截断. 据说Windows 10可以不限制文件名长度, 我没有测试.
- 实际搜索时, 只要文件的整个路径中含有指定关键词即可, 而不是只搜索设定的标签.
- 获取pdf文件的DOI时, 只将文件前两页转换为文本, 然后在其中搜索与DOI模式匹配的字符串. 速度不好, 但鉴于并非所有pdf文件的元数据中都含有DOI信息, 只能采用此法.
- 重命名文件有时会出现错误, 一个可能的原因是标题或作者中含有特殊字符. 若原因不易确定, 重新再试一次即可.
- 程序有时候会假死/崩溃, 可能是调用Everything等待时间过长, 或搜索到的文件过多.

## 评论

- 2017-02-27 23:06:02 `小明的用户` 32位系统的怎么办啊？
- 2017-02-28 09:25:59 `Jerkwin` 升级吧, 或者等我编译一个32位的, 可是我没有32位的机器测试, 不知道成不成.
- 2017-02-28 19:26:44 `小明的用户` 需要的，需要的，应该不只我一个人有需求的。~~试一下，我可以先尝试。
- 2017-02-28 23:20:47 `Jerkwin` 更新了32位的下载链接, 你试试吧. 我没有32位点机器, 没法测试.
- 2017-03-06 21:31:11 `小明` 下载了，说是有病毒。。
- 2017-03-06 22:00:43 `Jerkwin` 没有病毒, 只不过要改注册表, 杀毒软件会认为是病毒.

- 2017-04-30 22:30:27 `花心的洋葱` 真的很不错喔，不知道有没有考虑将这个软件开源。。
	我觉得方向上，可以进一步朝着通用性插件进行。
	比如在TC上，TC上是有ntfs stream插件的，可以很方便的编辑ntfs Stream。文件格式上，也可以不局限于pdf。
	对于有标签需求的人来说，pdf文献是大多数，有了已经很好了！
	只要是文件都可以编辑上标签。

- 2017-03-23 20:49:03 `小红的爸爸` 检索软件里，还有一个locate32也不错。不知道能不能嫁接上taggie.
- 2017-03-30 23:47:11 `Jerkwin` 那个是全文搜索到, 比价慢, 组合起来就没有优势了.
- 2017-05-01 21:06:53 `小红的爸爸` 不是，locate32就文件名的索引，事先索引好的。不像everything，会实时索引新文件，需要的权限比较高
- 2017-05-04 22:23:15 `Jerkwin` 根据我看到的资料, locate32优势不大, 且未必支持外挂, 所以我的程序暂时不会支持
