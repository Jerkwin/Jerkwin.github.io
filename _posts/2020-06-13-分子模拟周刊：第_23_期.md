---
 layout: post
 title: 分子模拟周刊：第 23 期
 categories:
 - 科
 tags:
 - 周刊
---

- 2020-06-12 21:34:10

## 每周杂记: 谢谢记得

![](https://jerkwin.github.io/pic/weekly/23_0.png)

父亲突然联系我, 说, 我初中的班主任让我发一张照片, 同时写一段自我介绍用来给他们现在的学生做榜样. 这让我大感意外. 这些老师都已经近30年未见过面了, 竟还记得我? 再说, 以我现在这样的境况, 用来给人做榜样是不是有点难堪?

其实这个老师并不是我初中时候的班主任, 是我的语文老师. 他人长得很高大, 声音洪亮, 性格粗线条. 不知是谁还给他起了个外号, 大马哈. 那时的我们并不知道大马哈其实是一种鱼的名字, 大约是受马大哈的启发编造出大马哈这个外号的, 不过倒也算是恰当.

我的语文老师那时大约是看重我吧, 觉得我聪明, 语文成绩也不错. 虽然现在想来那时我只是记忆力不赖, 很多东西都能记背下来, 编文凑字数的作文也还可以, 更多是混混沌沌不自觉. 这种状态其实一直跟着我, 到现在也没有太大改变.

我记得更深的是他教了我们一些中文语法的基础知识, 让我知道了中文有所谓的主谓宾定状补. 我不记得这些东西是否是课本上有的, 即便有也只是小字部分, 课外阅读而已. 但他似乎是将这些作为一件重要的事情, 花了很多时间来教我们怎么分析句子成分, 怎么画主谓宾定状补, 还不辞劳苦地刻钢板, 油印一些测试题给我们做. 我到现在还记得那种油印试卷的气味, 记得天热做题时涂抹到胳膊上的黑乎乎的油墨.

回想起来, 这是我上学以来唯一学过的语法知识. 小学不会教, 高中没有教, 大学也没有学. 这大约是因为很多人认为中文根本就没有什么语法, 或者中文是母语, 肯本就没有必要学习语法. 而我的语文老师那时到底是出于什么想法来教我们这些呢? 大约这些是他的专业知识吧, 他只是单纯地想将自己的专业知识教给他的学生, 即便教学大纲上并没有要求他那么做.

说来惭愧, 虽然我还记得很多教过我的老师, 但大部分老师自毕业后就再也没有见过面了, 也极少互通消息. 我也曾不止一次想到要去见见他们, 但事到临头却总是怯退, 因为觉得自己并没有达到满意的高度, 羞于见到他们.

有人问, [是不是去看望老师的，大多不是他们曾经口中的“好学生”？为什么？](https://www.zhihu.com/question/21828135) 我想, 是不是那些所谓的好学生中有好多与我类似呢? 他们其实并不是不想见, 只是觉得自己曾被认为是好学生, 如果没有自己满意的成就, 没有脸面再见自己的老师.

我教过两年书, 做过两年班主任, 实实在在地当过两年老师, 那些人是传统意义上我的学生. 我现在不教书, 却还常被人称为老师, 他们也并不是传统意义上我的学生. 但无论是哪种学生, 无论是"好学生", "差学生", 无论他们是否记得我, 其实我并不在意, 我只有祝福他们, 也希望他们能以平常心看待.

所以, 我大约已经没有心障了, 我期待着与老师们见面的机缘.

## 公益讲座第45期

【黄　铭】伞状采样在GROMACS里的实现和应用

【时　间】2020-06-14 周日 晚 20:00-21:00

【参　与】加入QQ群: `132266540`GROMACS/AMBER中文组), 按时上线加入QQ电话/群视频

## 资源工具

### 1. [神经网络势ANI最新版](https://github.com/aiqm/torchani)

![](https://jerkwin.github.io/pic/weekly/23_ani.png)

前几期中介绍过这个神经网络势, 他们最新的文章出来了, 新的参数也公布了, 其他元素的参数也在推进中.

### 2. OPLS3e参数转换为GROMACS拓扑

![](https://jerkwin.github.io/pic/weekly/23_gmx.png)

薛定谔公司在OPLS-AA力场基础上开发了OPLS3e力场, 据称是目前最好的小分子力场. 这个力场只能在薛定谔软件中使用, 就连参数文件都加密过了. 不过, 加密很难不被攻破. 所以就有人给软件打了补丁, 只有能够得到未加密的参数文件. 有了普通的参数文件, 要将其转换为GROMACS的拓扑难度不大. 我试着用JScript写了段代码来完成转换. 之所以不用很熟悉的bash/awk而换用JScript, 是因为我如果以后想将它做成在线工具, 基本不用怎么重写代码, 能达到最大程度复用代码的目的. 这个思路我觉得可以继续用下去: 一个程序如果有可能做成在线工具, 那就用JScript来写, 方便代码复用; 否则的话, 还是用bash/awk. 这种做法能做到兼顾windows和linux平台.

### 3. 整理GROMACS手册势能函数表格

![](https://jerkwin.github.io/pic/weekly/23_top1.png)

![](https://jerkwin.github.io/pic/weekly/23_top2.png)

![](https://jerkwin.github.io/pic/weekly/23_top3.png)

在完成上个脚本的时候, 涉及各种势能函数格式和参数的转换, 少不了参考GROMACS手册的相关部分, 有些地方还需要查看源代码才可以确定. 这样一通操作下来才发现手册中的相关部分有不少错误, 连带着我翻译整理的中文手册也跟着错了. 所以就修订了一下, 同时将势能函数公式添加到拓扑表格中去了, 这样在根据参数写拓扑的时候方便不少.

### 4. OPLS3e参数转换为AMBER拓扑

将OPLS3e参数转换为GROMACS拓扑我比较熟, 但转换为AMBER拓扑就不那么熟了, 所以暂时没有计划. 我觉得网上肯定已经有这样的脚本了. 有人推荐了几个, 看了一下, 都不是很满意, 暂且留着以备参考吧.

- `amber_prm2cms.py`: [Using the Amber force field in desmond](https://ambermd.org/desmond.html)
- `ffconv_v1.3`: [Automated simulations with Gromacs: MD, BAR, Umbrella, Force Field conversion](https://www.mail-archive.com/gromacs.org_gmx-users@maillist.sys.kth.se/msg04927.html)

## 论文采风

学艺术和建筑的, 经常要外出采风和写生. 做科研的也同样需要, 只不过换成了阅读文献和查看问题. 阅读别人的论文其实就是采风, 而尝试解决别人提出的问题, 就是写生了.

### 1. [OPLS3: A Force Field Providing Broad Coverage of Drug-like Small Molecules and Proteins](http://dx.doi.org/10.1021/acs.jctc.5b00864)

![](https://jerkwin.github.io/pic/weekly/23_opls3.png)

OPLS3的原始论文, 很长, 给出了力场所用势能函数, 电荷模型的信息. 特别要注意其中的虚拟位点模型以及二面角参数.

### 2. [OPLS3e: Extending Force Field Coverage for Drug-Like Small Molecules](http://dx.doi.org/10.1021/acs.jctc.8b01026)

![](https://jerkwin.github.io/pic/weekly/23_opls3e.png)

OPLS3e的原始论文, 也很长, 拟合了很多分子, 做了很多测试. 也只有财大气粗的公司才能这么做, 当然软件也卖得贵.

### 3. [Mineralogical control on the fate of continentally derived organic matter in the ocean](https://doi.org/10.1126/science.aax5345)  (投稿, 微信公众号: `llb9453`)

![](https://jerkwin.github.io/pic/weekly/23_clay.png)

对比海洋环境中蒙脱石—有机质、云母和绿泥石—有机质两类物质，蒙脱石上陆源有机质剥落被海洋成因有机质取代，而云母和绿泥石与有机质联系更为紧密，说明陆源有机质在海洋中的长期保存与层状硅酸盐的类型密切相关。

### 4. [分子动力学模拟不同温度下铀酰离子在叶腊石上吸附和扩散行为](http://www.whxb.pku.edu.cn/CN/10.3866/PKU.WHXB201705113)  (投稿, 微信公众号: `llb9453`)

![](https://jerkwin.github.io/pic/weekly/23_uo2.png)

本文运用分子动力学模拟技术研究4种不同类型的铀酰离子在叶腊石上分布、吸附和扩散行为，设置了3组不同温度，分析铀酰离子与水分子、碳酸离子配位情况，吸附层和扩散层的扩散系数等，得到铀酰离子在粘土矿物上吸附和扩散行为以及温度对其影响。

### 5. TSRC: Many-Body Interactions会议

![](https://jerkwin.github.io/pic/weekly/23_tsrc1.png)

本周参加的TSRC讲座太多了, 没时间一一整理. 这个剑桥的物理学家对力场的统一化描述必须分享一下. 他们发展的方法也值得关注.

![](https://jerkwin.github.io/pic/weekly/23_tsrc2.png)

## 问题写生

#### 蛋白建模工具哪个好?

目前应用最多的由已知的一级结构做三级结构的方法貌似只有modeller最简单，其他还有重头算等方法.

swiss model和modeller没关系，和modeller有关系的网站是modbase，都是sali组的。群文件里有一张建模工具和server的汇总的图，可以参考看看

在线的server还是首选i-tasser吧.

同源建模首选YASARA，同源建模建不了的，选ROSETTA

#### 小分子力场拓扑怎么得到?

对于小分子的力场, 有很多种不同的发展方法, 不存在所谓的标准流程. 但对于固定的力场, 如AMBER, CHARMM, OPLSAA来言, 其确定力场的大致流程是确定的, 虽然其中仍有不少情况各异的作法.

tppmktop只能用来获取小分子的OPLSAA力场, 而且其原子类型也只能是已经存在的. 它所完成的, 只不过是根据输入的分子结构, 确定每个原子的OPLSAA原子类型. 虽然OPLSAA原子类型很多, 但对某些特殊的分子, 仍然会出现无法确定原子类型的情况. 在这种情况下, 有两种解决方法: 1. 自己想方法获得所需原子类型的电荷和VDW参数; 2. 使用OPLSAA中相近/类似的原子类型代替. 一般情况下, 都是采用2, 因为自己获取VDW参数困难很大.

在原子类型都确定的情况下, 再来讨论分子内键长, 键角, 二面角等相互作用参数的问题. tppmktop所给出的这些相互作用项的数目必须和分子结构预示的一样多, 否则就错了. 所谓一样多指的是, 分子中有多少根键, [ bond ] 下面就要列出多少项; 对键角和二面角同理.

如果对某些分子内相互作用, tppmktop无法给出相互作用参数, 那解决方法也是上面的两种, 要么自己去拟合, 要么以相近/类似的代替. 由于这种情况下拟合参数不是 太 困难, 所以你会看到有些人会这么做. 大致作法是使用量化程序扫描相应的项, 获取能量, 然后扣除不需要的能量, 拟合相应的参数. 原理看起来简单, 但具体拟合时还是很有些麻烦的, 所以我一般建议采用相近/类型的参数来代替, 除非这些缺少的参数对分子结构影响很大, 而分子结构对模拟结果的影响也很大, 因为在这种情况下, 必须要求这些参数准确.

至于GMX拓扑文件中分子内的pairs, 其实和分子间的区别不大, 只不过对分子内的相互作用, 有个1-4排除项的概念. pairs只用来处理使用通用的1-4排除无法解决的情况, 一般用不到.

## 往期回顾

见 `图文专辑 分子模拟周刊`

## 订阅投稿

本周刊记录我每周所读所思, 并自觉值得与大家分享的内容.

本周刊同步更新在我的网络日志 [哲·科·文](https://jerkwin.github.io/) 和微信公众号 [分子模拟之道](https://mp.weixin.qq.com/s?__biz=MzI5MzI5NzgyNA==&mid=2247484628&idx=1&sn=a928af5f252a4b1405d4130454f8c971&chksm=ec750f1bdb02860dfd4d50f40950c95d27e71bddff4d14385e5a9d78ba3340d3d170e2ff578a&token=1361388059&lang=zh_CN#rd).

如果你觉得我的分享对你有益, 不妨将它推荐给你认识的人.

如果你也认同分享的理念, 欢迎投稿或推荐自己的内容. 请关注微信公众号后台留言, 或加入QQ群联系.

![](https://jerkwin.github.io/jscss/molsimart.png)
