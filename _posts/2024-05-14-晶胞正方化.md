---
 layout: post
 title: 晶胞正方化
 categories:
 - 科
 tags:
 - 数理
 math: true
---

- 2024-05-14 22:42:26

建模的时候, 出于方便或其他原因, 我们会希望晶胞底面的两个基本矢量$\hat a$, $\hat b$尽可能地相垂直, 且长度相等, 也就是底面尽可能地接近正方形. 这样看起来比较舒服, 在上面放置其他分子也方便设置边界距离. 可以称这种做法为(正)方化, 包含两方面: 正交(垂直)和等长.

## 晶胞的正交化

设晶胞底面矢量的长度为$a$, $b$, 矢量间的夹角为$γ$, 对应的晶胞矢量为

$$╤
\hat a &=a(1, 0) \\
\hat b &= b(\cosγ, \sinγ)
╧$$

正交化是要找到一组新的晶胞矢量$\hat {a'}$, $\hat {b'}$, 它们相互垂直或夹角尽可能接近90°. 为保持对称性, 新的晶胞矢量必须是原晶胞矢量整数倍的线性组合, 且不能为零, 即

$$╤
\hat {a'}&=m \hat a+n \hat b \\
\hat {b'}&=p\hat a+q\hat b \\
&m, n, p, q∈Z\\
&mn≠0, pq≠0
╧$$

现在计算新矢量之间的內积, 也即二者之间夹角$θ$的余弦值

$$╤
\cos θ &= {(m \hat a+n \hat b)·(p\hat a+q\hat b)／|m \hat a+n \hat b| |p\hat a+q\hat b|} \\
&= {mpa²+nqb²+(mq+np)ab\cosγ／√{m²a²+n²b²+2mnab\cosγ} √{p²a²+q²b²+2pqab\cosγ} } \\
&= {mp+nqt²+(mq+np)t\cosγ／√{m²+n²t²+2mnt\cosγ} √{p²+q²t²+2pqt\cosγ}}, t={b／a}
╧$$

当新矢量相互垂直时, $\cos θ=0$, 因而

$$mp+nqt²+(mq+np)t\cosγ=0$$

恕我脑拙, 没看出$m, n, p, q$之间要满足的具体关系. 但考虑到上式为$t$的二次方程, 当$nq≠0$时, 若有大于零的实数解, 则需满足

$$Δ²=(mq+np)²\cos²γ-4mnpq≥0 \\
{(mq+np)\cosγ／2nq}<0 \\
(mq+np)\cosγ <0 \\
(mq+np)²\cos²γ≥4mnpq
$$

利用这两个不等式, 在搜索解的时候或许可以减少些次数.

一般情况下, 我们只能取不同的$(m, n), (p, q)$组合, 计算角度, 查找最接近90度的组合. 这种组合未必唯一.

### 特殊情况

现在考虑两种特殊情况: $m=0$或$n=0$. 也就是新的晶胞矢量中有一个为原来的轴, 这样另一个轴无须再考虑原来的轴, 即$pq≠0$

$$╤
m&=0, &qt²+pt\cosγ&=0, &t²+{p／q}t\cosγ=0 \\
n&=0, &p+qt\cosγ&=0,  &{p／q}+t\cosγ=0
╧$$

这样可求得$p/q$, 取其最接近的有理数即可.

举个例子, 对常见的六方晶胞, $a=b$, $γ=120°$, 则$t=1$, $\cos γ= -½$

$$╤
m&=0, &1+{p／q}\cosγ=0,\;\;□ &{p／q}=2 \\
n&=0, &{p／q}+\cosγ=0, \;\;□ &{p／q}={1／2}
╧$$

## 晶胞的等长化

晶胞的等长化简单得多, 因为不考虑新矢量的方向,

$$╤
\hat {a'}&=u \hat a \\
\hat {b'}&=v \hat b \\
&u, v ∈Z, uv≠0
╧$$

等长时

$${u／v}={b／a}$$

## 晶胞正方化

在进行正方化时, 可以先正交再等长, 也可以先等长再正交. 这两种步骤对最终结果是否有影响, 我一时也说不明白, 有待来者.

如果我们在一个步骤中同时考虑正交等长两方面, 结果很可能异于分步进行的结果. 如果要将其转化为优化问题, 关键在于如何选取一个目标函数, 同时尽量满足垂直和等长的要求. 考虑到等长时$a'-b'=0$, 垂直时$\sinθ=1$, 我猜测一个可行的目标函数为

$$f=(L²-a'²-b'²)\sinθ$$

这里的$L$为两轴长度和的预设值.

可以将前面的式子代入求得$f$的具体表达式, 但有点麻烦, 这里就不给出了.
