---
 layout: post
 title: MSD算扩散系数的几种方法
 categories:
 - 科
 tags:
 - matlab
---

- 2018-07-19 22:10:28

利用均方位移MSD算扩散系数时, 最重要的是确定线性拟合的区间. 这在以前的[博文](https://jerkwin.github.io/2017/05/02/%E6%89%A9%E6%95%A3%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%88%86%E7%B1%BB%E4%BB%A5%E5%8F%8A%E6%89%A9%E6%95%A3%E7%B3%BB%E6%95%B0%E7%9A%84%E8%AE%A1%E7%AE%97/)中有说明. 在这里我总结一下确定拟合区间的几种方法, 并给出matlab代码供参考.

确定拟合区间的方法主要有下面几种:

1. 动态扩散系数(RDC), 也就是查看MSD/6t的变化
2. [稳健拟合](http://jerkwin.github.io/2018/06/14/matlab%E7%A8%B3%E5%81%A5%E5%9B%9E%E5%BD%92%E5%87%BD%E6%95%B0%E6%96%87%E6%A1%A3/)
3. 最小协方差行列式方法(MCD)检测异常点, 然后去除异常点后拟合
4. [随机抽样一致性算法(RANSAC)](https://jerkwin.github.io/2017/05/05/%E9%9A%8F%E6%9C%BA%E6%8A%BD%E6%A0%B7%E4%B8%80%E8%87%B4%E6%80%A7%E7%AE%97%E6%B3%95matlab%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81/)
5. 全局优化

所有以上方法都不是确定性的方法, 所得结果都依赖于一些选择和参数. 其中最后两种方法本质上是随机方法, 无法保证每次所得结果相同.

下图是一个示例, 可以看到各种方法还是有所区别的, 其中MCD方法和RANSAC方法比较接近, 应该是比较好的方法.

![](https://jerkwin.github.io/pic/msdfit.png)
