---
 layout: post
 title: 简单调研多维插值方法
 categories:
 - 科
 tags:
 - 数理
---

- 2020-11-07 11:36:50

以前的时候用过二维的插值, 见[二维三次卷积插值算法及Fortran代码](https://jerkwin.github.io/2012/07/24/%E4%BA%8C%E7%BB%B4%E4%B8%89%E6%AC%A1%E5%8D%B7%E7%A7%AF%E6%8F%92%E5%80%BC%E7%AE%97%E6%B3%95%E5%8F%8AFortran%E4%BB%A3%E7%A0%81/), 也用过matlab自带的插值方法, 见[Matlab插值曲面及其曲率的计算](https://jerkwin.github.io/2016/06/20/Matlab%E6%8F%92%E5%80%BC%E6%9B%B2%E9%9D%A2%E5%8F%8A%E5%85%B6%E6%9B%B2%E7%8E%87%E7%9A%84%E8%AE%A1%E7%AE%97/). 最近因为需要自夸实现多维插值方法, 就进行了简单的调研, 简单地罗列一下所得.

## 中文世界

先简单搜索一下中文的资料, 看看中文世界能找到什么信息, 发现大部分都是地学相关的. 虽然参考意义不大, 但至少熟悉一下相关的名词.

- "自然地理要素空间插值的几个问题", 地理研究, 23(4), 2004
- "多维线性插值方法的构建及应用分析", 南水北调与水利科技, 11(4), 2013
- "复杂地形影响下四川省逐月气温空间插值方法研究", 生态与农村环境学报, 35(6), 2019

常用的空间插值方法可以分为几何插值法、数学插值法以及地学插值方法。

几何插值方法的基本原理是距离越近相似性越高, 常用方法包括泰森多边形法和反距离权重插值法, 适用于下垫面特征较为一致的地区, 而在地形起伏较大的区域其插值误差普遍较大。

数学插值方法是假定插值要素在研究区域呈一定的曲面分布, 通过拟合曲面方程对未知站点进行插值, 常见方法有趋势面法和样条插值法。

地学插值法主要指克里格插值法, 其原理是利用区域化变量数据和半变异函数的结构特点, 对未知点的区域化变量进行最优无偏估计。

数学插值方法和地学插值方法均是根据数学原理通过已知点的信息拟合区域曲面方程或者半变异函数对未知点变量进行无偏估计, 因对区域下垫面差异性较大的区域具有一定的适用性, 且通常已知站点密度越大插值结果精度越高。然而由于区域下垫面的差异性的分布特征, 其空间变量场的分布是复杂多样的, 如何确定合理的曲面方程和半变异函数来准确描述空间变量场的分布特征是十分困难的。实际上, 区域变量场的分布在空间维度的上通常满足一定的递变规律, 因此在空间任一维度上, 均可通过线性插值对未知点变量值进行近似估计。然后, 通过权衡空间未知点变量值在各个维度的权重, 组合多维度线性插值结果, 就能得到该变量值的非线性多维空间插值结果。

常用的插值模型有样条函数法（ SF ）、反距离权重法（ IDW ）、克立格法（ KRGE ）等.

样条函数是自然样条函数在二维空间上的推广，使用函数逼近曲面的方法，在空间插值时准确
地通过实测样点拟合出连续光滑的曲面。

反距离权重法是对采样点进行线性的加权来决定输出的栅格值，加权值与距离成反比，采样点离输出栅格越远，对输出栅格的影响越小。

普通克立格法又称局部最优线性无偏估计法，是建立在变异函数理论结构分析基础之上。所谓线性是指估计值是样本值的线性组合，即加权线性平均；无偏是指理论上估计值的平均值等于实际样本值的平均值，即估计的平均误差为 0 ，最优势指估计的误差平方差最小。

多元规划分析模型是应用数理统计方法，建立气象要素与影响气象要素空间插值因子的多元回归模型。在该研究中是建立基于经度、纬度和海拔高度的多年平均气温多元回归模型，并计算残差.

- [10种插值方法在物探数据处理中的对比](http://www.oilsns.com/article/102486) 这里对多种方法进行了简介, 实际对比. 其中提到了径向基函数方法.

## 英文世界

通过中文粗略了解了一下之后, 再看看英文世界中的说法.

- "A GRID-Based Spatial Interpolation Method as a Tool Supporting Real Estate Market Analyses", Agnieszka Szczepańska, Dariusz Gościewski, Małgorzata Gerus-gościewska; IJGI 9(1):39, 2020; 10.3390/ijgi9010039 一篇比较近的文章, 意义不大.

- [What method of multivariate interpolation is the best for practical use?](https://stackoverflow.com/questions/592026/what-method-of-multivariate-interpolation-is-the-best-for-practical-use) [机器翻译](https://answer-id.com/zh/50864910) 问题很久远了, 其中提到一篇20年前的文章, "scattered data interpolation in three or more variables". 有篇回答提供了一下重要的信息, 很有价值.

## 径向基函数

看了上面这些信息之后, 觉得径向基函数方法可能最好, 接下来就看看相关的信息和实现方法.

- [Radial basis function interpolation](https://en.wikipedia.org/wiki/Radial_basis_function_interpolation) wiki的说明.

- [径向基函数](https://github.com/KeKe-Li/tutorial/blob/master/assets/src/KBO/KBO.0.3.md) 径向基函数的介绍. 放在机器学习中的, 其他的资料也很有价值.

- [径向基函数工作原理](https://pro.arcgis.com/zh-cn/pro-app/help/analysis/geostatistical-analyst/how-radial-basis-functions-work.htm) 地学中也使用这种方法.

- [什么是径向基核函数？什么是径向基核插值？两者什么关系？](https://www.zhihu.com/question/22337522) 知乎的一篇回答

- [径向基函数（Radial Basis Function）插值](https://packyan.github.io/blog/2018/03/28/rbf/) 找到了实现方法和代码. 基本就解决问题了, 因为不需要专门研究这个问题, 就此作罢.
